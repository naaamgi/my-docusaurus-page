"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[4577],{18427:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>o,frontMatter:()=>c,metadata:()=>l,toc:()=>r});const l=JSON.parse('{"id":"sk_rookies/security_monitoring/wazuh-agent","title":"Wazuh Agent \ub4f1\ub85d","description":"Windows/Linux Agent \ubc0f Agentless \uc124\uc815 \uac00\uc774\ub4dc","source":"@site/docs/sk_rookies/security_monitoring/08-wazuh-agent.md","sourceDirName":"sk_rookies/security_monitoring","slug":"/sk_rookies/security_monitoring/wazuh-agent","permalink":"/my-docusaurus-page/sk_rookies/security_monitoring/wazuh-agent","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Wazuh Agent \ub4f1\ub85d","description":"Windows/Linux Agent \ubc0f Agentless \uc124\uc815 \uac00\uc774\ub4dc","keywords":["Wazuh","Agent","Agentless","Windows","Linux","Sysmon"]},"sidebar":"tutorialSidebar","previous":{"title":"Wazuh \uc124\uce58","permalink":"/my-docusaurus-page/sk_rookies/security_monitoring/wazuh-installation"},"next":{"title":"Web Attacks","permalink":"/my-docusaurus-page/category/web-attacks-1"}}');var i=s(74848),d=s(28453);const c={sidebar_position:8,title:"Wazuh Agent \ub4f1\ub85d",description:"Windows/Linux Agent \ubc0f Agentless \uc124\uc815 \uac00\uc774\ub4dc",keywords:["Wazuh","Agent","Agentless","Windows","Linux","Sysmon"]},t="Wazuh Agent \ub4f1\ub85d",a={},r=[{value:"Agent vs Agentless",id:"agent-vs-agentless",level:2},{value:"1. Windows Agent \uc124\uce58",id:"1-windows-agent-\uc124\uce58",level:2},{value:"1.1 \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc124\uce58 \uba85\ub839 \ud655\uc778",id:"11-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uc124\uce58-\uba85\ub839-\ud655\uc778",level:3},{value:"1.2 Windows\uc5d0\uc11c \uc124\uce58",id:"12-windows\uc5d0\uc11c-\uc124\uce58",level:3},{value:"1.3 \uc11c\ube44\uc2a4 \uc2dc\uc791",id:"13-\uc11c\ube44\uc2a4-\uc2dc\uc791",level:3},{value:"1.4 \ub4f1\ub85d \ud655\uc778",id:"14-\ub4f1\ub85d-\ud655\uc778",level:3},{value:"2. Linux Agent \uc124\uce58",id:"2-linux-agent-\uc124\uce58",level:2},{value:"2.1 \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uba85\ub839 \ud655\uc778",id:"21-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uba85\ub839-\ud655\uc778",level:3},{value:"2.2 Ubuntu\uc5d0\uc11c \uc124\uce58",id:"22-ubuntu\uc5d0\uc11c-\uc124\uce58",level:3},{value:"2.3 \uc11c\ubc84 \uc124\uc815",id:"23-\uc11c\ubc84-\uc124\uc815",level:3},{value:"2.4 \uc11c\ube44\uc2a4 \uc2dc\uc791",id:"24-\uc11c\ube44\uc2a4-\uc2dc\uc791",level:3},{value:"3. Agentless \uc124\uc815",id:"3-agentless-\uc124\uc815",level:2},{value:"3.1 SSH \ud0a4 \uc124\uc815 (\uc11c\ubc84\uc5d0\uc11c)",id:"31-ssh-\ud0a4-\uc124\uc815-\uc11c\ubc84\uc5d0\uc11c",level:3},{value:"3.2 Agentless \ud638\uc2a4\ud2b8 \ub4f1\ub85d",id:"32-agentless-\ud638\uc2a4\ud2b8-\ub4f1\ub85d",level:3},{value:"3.3 ossec.conf\uc5d0 \uc124\uc815 \ucd94\uac00",id:"33-ossecconf\uc5d0-\uc124\uc815-\ucd94\uac00",level:3},{value:"3.4 \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791",id:"34-\uc11c\ube44\uc2a4-\uc7ac\uc2dc\uc791",level:3},{value:"4. Windows Sysmon \uc5f0\ub3d9",id:"4-windows-sysmon-\uc5f0\ub3d9",level:2},{value:"4.1 Sysmon \uac1c\uc694",id:"41-sysmon-\uac1c\uc694",level:3},{value:"4.2 Sysmon \uc124\uce58",id:"42-sysmon-\uc124\uce58",level:3},{value:"4.3 Wazuh\uc5d0\uc11c Sysmon \ub85c\uadf8 \uc218\uc9d1",id:"43-wazuh\uc5d0\uc11c-sysmon-\ub85c\uadf8-\uc218\uc9d1",level:3},{value:"4.4 Sysmon \uc774\ubca4\ud2b8 \ud655\uc778",id:"44-sysmon-\uc774\ubca4\ud2b8-\ud655\uc778",level:3},{value:"5. \uc5d0\uc774\uc804\ud2b8 \uad00\ub9ac",id:"5-\uc5d0\uc774\uc804\ud2b8-\uad00\ub9ac",level:2},{value:"5.1 \uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d \ud655\uc778",id:"51-\uc5d0\uc774\uc804\ud2b8-\ubaa9\ub85d-\ud655\uc778",level:3},{value:"5.2 \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc \ud655\uc778",id:"52-\uc5d0\uc774\uc804\ud2b8-\uc0c1\ud0dc-\ud655\uc778",level:3},{value:"5.3 \uc5d0\uc774\uc804\ud2b8 \uc0ad\uc81c",id:"53-\uc5d0\uc774\uc804\ud2b8-\uc0ad\uc81c",level:3},{value:"6. \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc774\ubca4\ud2b8 \ubd84\uc11d",id:"6-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uc774\ubca4\ud2b8-\ubd84\uc11d",level:2},{value:"6.1 \ubcf4\uc548 \uc774\ubca4\ud2b8 \ud655\uc778",id:"61-\ubcf4\uc548-\uc774\ubca4\ud2b8-\ud655\uc778",level:3},{value:"6.2 \ud544\ud130 \uc0ac\uc6a9",id:"62-\ud544\ud130-\uc0ac\uc6a9",level:3},{value:"6.3 \uc8fc\uc694 \ud544\ub4dc",id:"63-\uc8fc\uc694-\ud544\ub4dc",level:3},{value:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870",id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",level:2},{value:"Windows Agent",id:"windows-agent",level:3},{value:"Linux Agent",id:"linux-agent",level:3},{value:"Wazuh Server",id:"wazuh-server",level:3},{value:"\ud2b8\ub7ec\ube14\uc288\ud305 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"\ud2b8\ub7ec\ube14\uc288\ud305-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:2},{value:"Agent\uac00 \ub4f1\ub85d \uc548 \ub420 \ub54c",id:"agent\uac00-\ub4f1\ub85d-\uc548-\ub420-\ub54c",level:3},{value:"Agent\uac00 Disconnected\uc77c \ub54c",id:"agent\uac00-disconnected\uc77c-\ub54c",level:3},{value:"Sysmon \ub85c\uadf8 \uc548 \uc62c \ub54c",id:"sysmon-\ub85c\uadf8-\uc548-\uc62c-\ub54c",level:3},{value:"Agentless \uc5f0\uacb0 \uc548 \ub420 \ub54c",id:"agentless-\uc5f0\uacb0-\uc548-\ub420-\ub54c",level:3},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function h(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"wazuh-agent-\ub4f1\ub85d",children:"Wazuh Agent \ub4f1\ub85d"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Windows\uc640 Linux\uc5d0 Wazuh Agent\ub97c \uc124\uce58\ud558\uace0 \uc11c\ubc84\uc5d0 \ub4f1\ub85d\ud558\ub294 \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"agent-vs-agentless",children:"Agent vs Agentless"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TB\n    subgraph Agent["Agent \ubc29\uc2dd"]\n        A1["\ub300\uc0c1 \uc2dc\uc2a4\ud15c\uc5d0 \ud504\ub85c\uadf8\ub7a8 \uc124\uce58"]\n        A2["\uc2e4\uc2dc\uac04 \ubaa8\ub2c8\ud130\ub9c1"]\n        A3["\ub2e4\uc591\ud55c \uae30\ub2a5 \uc9c0\uc6d0"]\n    end\n\n    subgraph Agentless["Agentless \ubc29\uc2dd"]\n        B1["SSH\ub85c \uc6d0\uaca9 \uc811\uc18d"]\n        B2["\uc8fc\uae30\uc801 \uc810\uac80"]\n        B3["\uc124\uce58 \ubd88\uac00 \ud658\uacbd\uc6a9"]\n    end'}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\ubc29\uc2dd"}),(0,i.jsx)(n.th,{children:"Agent"}),(0,i.jsx)(n.th,{children:"Agentless"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\uc124\uce58"}),(0,i.jsx)(n.td,{children:"\ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \ud504\ub85c\uadf8\ub7a8 \uc124\uce58"}),(0,i.jsx)(n.td,{children:"\uc124\uce58 \uc5c6\uc74c (SSH)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\ubaa8\ub2c8\ud130\ub9c1"}),(0,i.jsx)(n.td,{children:"\uc2e4\uc2dc\uac04"}),(0,i.jsx)(n.td,{children:"\uc8fc\uae30\uc801 (\uc2a4\ucf00\uc904)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\uae30\ub2a5"}),(0,i.jsx)(n.td,{children:"\uc804\uccb4 \uae30\ub2a5"}),(0,i.jsx)(n.td,{children:"\uc81c\ud55c\uc801 (\ubb34\uacb0\uc131 \uac80\uc0ac \ub4f1)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\uc6a9\ub3c4"}),(0,i.jsx)(n.td,{children:"\uc77c\ubc18 \uc11c\ubc84/\uc6cc\ud06c\uc2a4\ud14c\uc774\uc158"}),(0,i.jsx)(n.td,{children:"\ub124\ud2b8\uc6cc\ud06c \uc7a5\ube44, \uc81c\ud55c \ud658\uacbd"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"1-windows-agent-\uc124\uce58",children:"1. Windows Agent \uc124\uce58"}),"\n",(0,i.jsx)(n.h3,{id:"11-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uc124\uce58-\uba85\ub839-\ud655\uc778",children:"1.1 \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc124\uce58 \uba85\ub839 \ud655\uc778"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Wazuh \ub300\uc2dc\ubcf4\ub4dc \uc811\uc18d: ",(0,i.jsx)(n.code,{children:"https://192.168.2.10"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agents"})," \uba54\ub274 \ud074\ub9ad"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deploy new agent"})," \ud074\ub9ad"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Windows"})," \uc120\ud0dd"]}),"\n",(0,i.jsxs)(n.li,{children:["Server address \uc785\ub825: ",(0,i.jsx)(n.code,{children:"192.168.2.10"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc0dd\uc131\ub41c PowerShell \uba85\ub839\uc5b4:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"Invoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.7.0-1.msi -OutFile ${env:tmp}\\wazuh-agent.msi; msiexec.exe /i ${env:tmp}\\wazuh-agent.msi /q WAZUH_MANAGER='192.168.2.10' WAZUH_AGENT_GROUP='default'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"12-windows\uc5d0\uc11c-\uc124\uce58",children:"1.2 Windows\uc5d0\uc11c \uc124\uce58"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uad00\ub9ac\uc790 \uad8c\ud55c PowerShell:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"# \ub2e4\uc6b4\ub85c\ub4dc \ubc0f \uc124\uce58\nInvoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.7.0-1.msi -OutFile ${env:tmp}\\wazuh-agent.msi\n\nmsiexec.exe /i ${env:tmp}\\wazuh-agent.msi /q WAZUH_MANAGER='192.168.2.10' WAZUH_AGENT_GROUP='default'\n"})}),"\n",(0,i.jsxs)(n.admonition,{title:"\uc124\uce58 \uc2e4\ud328 \uc2dc",type:"tip",children:[(0,i.jsx)(n.p,{children:"\uba85\ub839\uc5b4 \uc124\uce58\uac00 \uc548 \ub418\uba74 MSI \ud30c\uc77c\uc744 \uc9c1\uc811 \ub354\ube14\ud074\ub9ad\ud574\uc11c GUI\ub85c \uc124\uce58\ud569\ub2c8\ub2e4:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'C\ub4dc\ub77c\uc774\ube0c\uc5d0\uc11c "wazuh-agent" \uac80\uc0c9'}),"\n",(0,i.jsx)(n.li,{children:"MSI \ud30c\uc77c \ub354\ube14\ud074\ub9ad"}),"\n",(0,i.jsx)(n.li,{children:"\uc124\uce58 \uc9c4\ud589"}),"\n"]})]}),"\n",(0,i.jsx)(n.h3,{id:"13-\uc11c\ube44\uc2a4-\uc2dc\uc791",children:"1.3 \uc11c\ube44\uc2a4 \uc2dc\uc791"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"# \uc11c\ube44\uc2a4 \uc2dc\uc791\nNET START WazuhSvc\n\n# \ub610\ub294 \uc11c\ube44\uc2a4 \uad00\ub9ac\uc790\uc5d0\uc11c\n# services.msc \u2192 Wazuh \u2192 \uc2dc\uc791\n"})}),"\n",(0,i.jsx)(n.h3,{id:"14-\ub4f1\ub85d-\ud655\uc778",children:"1.4 \ub4f1\ub85d \ud655\uc778"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Wazuh \ub300\uc2dc\ubcf4\ub4dc:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agents \u2192 \uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d\uc5d0\uc11c Windows \ud655\uc778\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Windows\uc5d0\uc11c:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'# \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc \ud655\uc778\n& "C:\\Program Files (x86)\\ossec-agent\\agent-control.exe" -s\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-linux-agent-\uc124\uce58",children:"2. Linux Agent \uc124\uce58"}),"\n",(0,i.jsx)(n.h3,{id:"21-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uba85\ub839-\ud655\uc778",children:"2.1 \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uba85\ub839 \ud655\uc778"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deploy new agent"})," \ud074\ub9ad"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DEB amd64"})," \uc120\ud0dd (Ubuntu)"]}),"\n",(0,i.jsxs)(n.li,{children:["Server address: ",(0,i.jsx)(n.code,{children:"192.168.2.10"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"22-ubuntu\uc5d0\uc11c-\uc124\uce58",children:"2.2 Ubuntu\uc5d0\uc11c \uc124\uce58"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# GPG \ud0a4 \ucd94\uac00\ncurl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | sudo apt-key add -\n\n# \uc800\uc7a5\uc18c \ucd94\uac00\necho "deb https://packages.wazuh.com/4.x/apt/ stable main" | sudo tee /etc/apt/sources.list.d/wazuh.list\n\n# \ud328\ud0a4\uc9c0 \uc5c5\ub370\uc774\ud2b8 \ubc0f \uc124\uce58\nsudo apt update\nsudo apt install -y wazuh-agent\n\n# \ub610\ub294 \uc9c1\uc811 \ub2e4\uc6b4\ub85c\ub4dc\ncurl -so wazuh-agent.deb https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.7.0-1_amd64.deb\nsudo dpkg -i wazuh-agent.deb\n'})}),"\n",(0,i.jsx)(n.h3,{id:"23-\uc11c\ubc84-\uc124\uc815",children:"2.3 \uc11c\ubc84 \uc124\uc815"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# ossec.conf\uc5d0\uc11c \uc11c\ubc84 \uc8fc\uc18c \uc124\uc815\nsudo nano /var/ossec/etc/ossec.conf\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<ossec_config>\n  <client>\n    <server>\n      <address>192.168.2.10</address>\n    </server>\n  </client>\n</ossec_config>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"24-\uc11c\ube44\uc2a4-\uc2dc\uc791",children:"2.4 \uc11c\ube44\uc2a4 \uc2dc\uc791"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc11c\ube44\uc2a4 \uc2dc\uc791\nsudo systemctl daemon-reload\nsudo systemctl enable wazuh-agent\nsudo systemctl start wazuh-agent\n\n# \uc0c1\ud0dc \ud655\uc778\nsudo systemctl status wazuh-agent\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-agentless-\uc124\uc815",children:"3. Agentless \uc124\uc815"}),"\n",(0,i.jsx)(n.h3,{id:"31-ssh-\ud0a4-\uc124\uc815-\uc11c\ubc84\uc5d0\uc11c",children:"3.1 SSH \ud0a4 \uc124\uc815 (\uc11c\ubc84\uc5d0\uc11c)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Wazuh \uc11c\ubc84\uc5d0\uc11c SSH \ud0a4 \uc0dd\uc131\nsudo -u ossec ssh-keygen -t rsa -N "" -f /var/ossec/.ssh/id_rsa\n\n# \ub300\uc0c1 \uc11c\ubc84\uc5d0 \uacf5\uac1c\ud0a4 \ubcf5\uc0ac\nsudo -u ossec ssh-copy-id admin@192.168.2.100\n'})}),"\n",(0,i.jsx)(n.h3,{id:"32-agentless-\ud638\uc2a4\ud2b8-\ub4f1\ub85d",children:"3.2 Agentless \ud638\uc2a4\ud2b8 \ub4f1\ub85d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# register_host.sh \uc2a4\ud06c\ub9bd\ud2b8 \uc0ac\uc6a9\nsudo /var/ossec/agentless/register_host.sh add admin@192.168.2.100 NOPASS\n"})}),"\n",(0,i.jsx)(n.h3,{id:"33-ossecconf\uc5d0-\uc124\uc815-\ucd94\uac00",children:"3.3 ossec.conf\uc5d0 \uc124\uc815 \ucd94\uac00"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo nano /var/ossec/etc/ossec.conf\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<ossec_config>\n  <agentless>\n    <type>ssh_integrity_check_linux</type>\n    <frequency>36000</frequency>\n    <host>admin@192.168.2.100</host>\n    <state>periodic</state>\n  </agentless>\n</ossec_config>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"34-\uc11c\ube44\uc2a4-\uc7ac\uc2dc\uc791",children:"3.4 \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart wazuh-manager\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-windows-sysmon-\uc5f0\ub3d9",children:"4. Windows Sysmon \uc5f0\ub3d9"}),"\n",(0,i.jsx)(n.h3,{id:"41-sysmon-\uac1c\uc694",children:"4.1 Sysmon \uac1c\uc694"}),"\n",(0,i.jsx)(n.p,{children:"Sysmon\uc740 Windows\uc5d0\uc11c \uc0c1\uc138\ud55c \uc2dc\uc2a4\ud15c \ud65c\ub3d9\uc744 \ub85c\uae45\ud558\ub294 \ub3c4\uad6c\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\ub85c\uae45 \ud56d\ubaa9:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\ud504\ub85c\uc138\uc2a4 \uc0dd\uc131/\uc885\ub8cc"}),"\n",(0,i.jsx)(n.li,{children:"\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0"}),"\n",(0,i.jsx)(n.li,{children:"\ud30c\uc77c \uc0dd\uc131 \uc2dc\uac04 \ubcc0\uacbd"}),"\n",(0,i.jsx)(n.li,{children:"\ub4dc\ub77c\uc774\ubc84/DLL \ub85c\ub4dc"}),"\n",(0,i.jsx)(n.li,{children:"\ub808\uc9c0\uc2a4\ud2b8\ub9ac \ubcc0\uacbd"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"42-sysmon-\uc124\uce58",children:"4.2 Sysmon \uc124\uce58"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\ub2e4\uc6b4\ub85c\ub4dc:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc124\uce58:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"# \ub2e4\uc6b4\ub85c\ub4dc \ud6c4 \uc555\ucd95 \ud574\uc81c\n# \uad00\ub9ac\uc790 PowerShell\uc5d0\uc11c\n\n# \uae30\ubcf8 \uc124\uce58\n.\\Sysmon64.exe -accepteula -i\n\n# \uc124\uc815 \ud30c\uc77c \uc0ac\uc6a9 \uc124\uce58\n.\\Sysmon64.exe -accepteula -i sysmonconfig.xml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"43-wazuh\uc5d0\uc11c-sysmon-\ub85c\uadf8-\uc218\uc9d1",children:"4.3 Wazuh\uc5d0\uc11c Sysmon \ub85c\uadf8 \uc218\uc9d1"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"ossec.conf \uc218\uc815 (Windows Agent):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'notepad "C:\\Program Files (x86)\\ossec-agent\\ossec.conf"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<ossec_config>\n  <localfile>\n    <location>Microsoft-Windows-Sysmon/Operational</location>\n    <log_format>eventchannel</log_format>\n  </localfile>\n</ossec_config>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"NET STOP WazuhSvc\nNET START WazuhSvc\n"})}),"\n",(0,i.jsx)(n.h3,{id:"44-sysmon-\uc774\ubca4\ud2b8-\ud655\uc778",children:"4.4 Sysmon \uc774\ubca4\ud2b8 \ud655\uc778"}),"\n",(0,i.jsx)(n.p,{children:"\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agents \u2192 Windows Agent \u2192 Security Events\n"})}),"\n",(0,i.jsx)(n.p,{children:"\ud544\ud130:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"data.win.system.channel:Microsoft-Windows-Sysmon/Operational\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-\uc5d0\uc774\uc804\ud2b8-\uad00\ub9ac",children:"5. \uc5d0\uc774\uc804\ud2b8 \uad00\ub9ac"}),"\n",(0,i.jsx)(n.h3,{id:"51-\uc5d0\uc774\uc804\ud2b8-\ubaa9\ub85d-\ud655\uc778",children:"5.1 \uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d \ud655\uc778"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"CLI:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Wazuh \uc11c\ubc84\uc5d0\uc11c\nsudo /var/ossec/bin/agent_control -l\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\ub300\uc2dc\ubcf4\ub4dc:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agents \u2192 \uc804\uccb4 \ubaa9\ub85d \ud655\uc778\n"})}),"\n",(0,i.jsx)(n.h3,{id:"52-\uc5d0\uc774\uc804\ud2b8-\uc0c1\ud0dc-\ud655\uc778",children:"5.2 \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc \ud655\uc778"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \ud2b9\uc815 \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc\nsudo /var/ossec/bin/agent_control -i 001\n\n# \ubaa8\ub4e0 \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc\nsudo /var/ossec/bin/agent_control -l\n"})}),"\n",(0,i.jsx)(n.h3,{id:"53-\uc5d0\uc774\uc804\ud2b8-\uc0ad\uc81c",children:"5.3 \uc5d0\uc774\uc804\ud2b8 \uc0ad\uc81c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc5d0\uc774\uc804\ud2b8 \uc0ad\uc81c\nsudo /var/ossec/bin/manage_agents -r 001\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c-\uc774\ubca4\ud2b8-\ubd84\uc11d",children:"6. \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc774\ubca4\ud2b8 \ubd84\uc11d"}),"\n",(0,i.jsx)(n.h3,{id:"61-\ubcf4\uc548-\uc774\ubca4\ud2b8-\ud655\uc778",children:"6.1 \ubcf4\uc548 \uc774\ubca4\ud2b8 \ud655\uc778"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Agents \u2192 (\uc5d0\uc774\uc804\ud2b8 \uc120\ud0dd) \u2192 Security Events\n"})}),"\n",(0,i.jsx)(n.h3,{id:"62-\ud544\ud130-\uc0ac\uc6a9",children:"6.2 \ud544\ud130 \uc0ac\uc6a9"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\ub8f0 \ub808\ubca8\ubcc4:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"rule.level:>=7\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc774\ubca4\ud2b8 \ud0c0\uc785\ubcc4:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"rule.groups:authentication_failed\nrule.groups:sysmon\nrule.groups:windows\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc2dc\uac04\ubcc4:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\uc6b0\uce21 \uc0c1\ub2e8 \uc2dc\uac04 \uc120\ud0dd\uae30 \uc0ac\uc6a9"}),"\n",(0,i.jsx)(n.li,{children:"Today, Last 24 hours \ub4f1"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"63-\uc8fc\uc694-\ud544\ub4dc",children:"6.3 \uc8fc\uc694 \ud544\ub4dc"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\ud544\ub4dc"}),(0,i.jsx)(n.th,{children:"\uc124\uba85"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"rule.id"}),(0,i.jsx)(n.td,{children:"\ub8f0 ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"rule.level"}),(0,i.jsx)(n.td,{children:"\uc2ec\uac01\ub3c4 (0-15)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"rule.description"}),(0,i.jsx)(n.td,{children:"\ub8f0 \uc124\uba85"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"agent.name"}),(0,i.jsx)(n.td,{children:"\uc5d0\uc774\uc804\ud2b8 \uc774\ub984"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data.srcip"}),(0,i.jsx)(n.td,{children:"\ucd9c\ubc1c\uc9c0 IP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data.dstip"}),(0,i.jsx)(n.td,{children:"\ubaa9\uc801\uc9c0 IP"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",children:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870"}),"\n",(0,i.jsx)(n.h3,{id:"windows-agent",children:"Windows Agent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"# \uc124\uce58\nmsiexec.exe /i wazuh-agent.msi /q WAZUH_MANAGER='192.168.2.10'\n\n# \uc11c\ube44\uc2a4 \uc2dc\uc791/\uc911\uc9c0\nNET START WazuhSvc\nNET STOP WazuhSvc\n\n# \uc124\uc815 \ud30c\uc77c\nC:\\Program Files (x86)\\ossec-agent\\ossec.conf\n\n# \ub85c\uadf8 \uc704\uce58\nC:\\Program Files (x86)\\ossec-agent\\ossec.log\n"})}),"\n",(0,i.jsx)(n.h3,{id:"linux-agent",children:"Linux Agent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc124\uce58\nsudo dpkg -i wazuh-agent.deb\n\n# \uc11c\ube44\uc2a4 \uad00\ub9ac\nsudo systemctl start wazuh-agent\nsudo systemctl stop wazuh-agent\nsudo systemctl status wazuh-agent\n\n# \uc124\uc815 \ud30c\uc77c\n/var/ossec/etc/ossec.conf\n\n# \ub85c\uadf8\n/var/ossec/logs/ossec.log\n"})}),"\n",(0,i.jsx)(n.h3,{id:"wazuh-server",children:"Wazuh Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc5d0\uc774\uc804\ud2b8 \ubaa9\ub85d\nsudo /var/ossec/bin/agent_control -l\n\n# \uc5d0\uc774\uc804\ud2b8 \uc0c1\ud0dc\nsudo /var/ossec/bin/agent_control -i 001\n\n# Agentless \ub4f1\ub85d\nsudo /var/ossec/agentless/register_host.sh add user@host NOPASS\n\n# \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791\nsudo systemctl restart wazuh-manager\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ud2b8\ub7ec\ube14\uc288\ud305-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"\ud2b8\ub7ec\ube14\uc288\ud305 \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,i.jsx)(n.h3,{id:"agent\uac00-\ub4f1\ub85d-\uc548-\ub420-\ub54c",children:"Agent\uac00 \ub4f1\ub85d \uc548 \ub420 \ub54c"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Wazuh \uc11c\ubc84 IP \uc62c\ubc14\ub978\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","1514, 1515 \ud3ec\ud2b8 \uc5f4\ub824\uc788\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\ubc29\ud654\ubcbd \uc124\uc815 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Agent \uc11c\ube44\uc2a4 \uc2e4\ud589 \uc911\uc778\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Agent \ub85c\uadf8 \ud655\uc778 (",(0,i.jsx)(n.code,{children:"ossec.log"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"agent\uac00-disconnected\uc77c-\ub54c",children:"Agent\uac00 Disconnected\uc77c \ub54c"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Agent \uc11c\ube44\uc2a4 \uc0c1\ud0dc \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\uc11c\ubc84 \uc5f0\uacb0 \uc124\uc815 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\uc778\uc99d \ud0a4 \ubb38\uc81c \ud655\uc778"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sysmon-\ub85c\uadf8-\uc548-\uc62c-\ub54c",children:"Sysmon \ub85c\uadf8 \uc548 \uc62c \ub54c"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Sysmon \uc11c\ube44\uc2a4 \uc2e4\ud589 \uc911\uc778\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","ossec.conf\uc5d0 Sysmon \uc124\uc815 \uc788\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Agent \uc7ac\uc2dc\uc791 \ud588\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\uc774\ubca4\ud2b8 \ubdf0\uc5b4\uc5d0\uc11c Sysmon \ub85c\uadf8 \uc0dd\uc131\ub418\ub294\uc9c0 \ud655\uc778"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"agentless-\uc5f0\uacb0-\uc548-\ub420-\ub54c",children:"Agentless \uc5f0\uacb0 \uc548 \ub420 \ub54c"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SSH \ud0a4 \ubcf5\uc0ac \uc644\ub8cc\ub410\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SSH \ube44\ubc00\ubc88\ud638 \uc5c6\uc774 \ub85c\uadf8\uc778 \uac00\ub2a5\ud55c\uc9c0 \ud14c\uc2a4\ud2b8"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","ossec \uc0ac\uc6a9\uc790 \uad8c\ud55c \ud655\uc778"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\ub300\uc0c1 \uc11c\ubc84 SSH \uc11c\ube44\uc2a4 \uc2e4\ud589 \ud655\uc778"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,i.jsx)(n.p,{children:"Agent \uc124\uc815\uc774 \uc644\ub8cc\ub418\uba74:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c \uc2e4\uc2dc\uac04 \ubcf4\uc548 \uc774\ubca4\ud2b8 \ubaa8\ub2c8\ud130\ub9c1"}),"\n",(0,i.jsx)(n.li,{children:"\ucee4\uc2a4\ud140 \ub8f0 \uc791\uc131\uc73c\ub85c \ud0d0\uc9c0 \uc815\ud655\ub3c4 \ud5a5\uc0c1"}),"\n",(0,i.jsx)(n.li,{children:"\uc54c\ub9bc \uc124\uc815\uc73c\ub85c \uc911\uc694 \uc774\ubca4\ud2b8 \uc989\uc2dc \ud1b5\ubcf4"}),"\n",(0,i.jsx)(n.li,{children:"\ud504\ub85c\uc81d\ud2b8\uc5d0 \ud65c\uc6a9\ud560 \ubcf4\uc548 \uad00\uc81c \uc2dc\ub098\ub9ac\uc624 \uc124\uacc4"}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var l=s(96540);const i={},d=l.createContext(i);function c(e){const n=l.useContext(d);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);