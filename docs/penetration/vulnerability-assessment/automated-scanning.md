---
sidebar_position: 7
title: Automated Vulnerability Scanning
---

# 자동 취약점 진단

## 개요

자동화 도구를 사용하여 대규모 취약점을 빠르게 식별

**장점**:
- 빠른 스캔
- 일관된 결과
- 알려진 취약점 자동 탐지

**단점**:
- 오탐(False Positive)
- 로직 취약점 미탐지
- 시스템 부하 발생 가능

---

## 도구 분류

### 상용 솔루션

**종합 스캐너**:
- Nessus Professional (Tenable)
- Nexpose (Rapid7)
- Qualys VMDR

**웹 애플리케이션**:
- Burp Suite Professional (PortSwigger)
- Acunetix
- Qualys Web Application Scanning

**Active Directory**:
- BloodHound Enterprise
- Semperis Purple Knight

### 오픈소스/무료 도구

**종합**:
- Nessus Essentials (Community)
- OpenVAS
- Metasploit

**웹**:
- Nikto
- Nuclei
- WPScan
- Burp Suite Community

---

## Nuclei

### 개요

**Nuclei**: 템플릿 기반 취약점 스캐너

**특징**:
- 빠른 속도
- 풍부한 템플릿 (9000+)
- 웹 애플리케이션에 최적화
- 네트워크 서비스, DNS, SSL 등도 지원

### 설치

```bash
# Go 설치 (필요 시)
sudo apt update
sudo apt install golang-go -y

# Nuclei 설치
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# PATH 설정 (.bashrc 또는 .zshrc)
echo 'export PATH=$HOME/go/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# 설치 확인
nuclei -version

# 템플릿 업데이트
nuclei -update-templates
```

### 기본 사용법

```bash
# 단일 URL 스캔
nuclei -u http://<target>

# 포트 포함
nuclei -u http://<target>:8080

# HTTPS
nuclei -u https://<target>

# IP 주소
nuclei -u 192.168.1.10

# 네트워크 서비스 (포트 지정)
nuclei -u 192.168.1.10:445
```

### 자동 스캔 (추천)

```bash
# Automatic Scanning - 기술 스택 자동 감지
nuclei -u http://<target> -as

# 예시
nuclei -u http://192.168.1.10:8080 -as
```

**-as 플래그**:
- 웹 애플리케이션 기술 스택 자동 감지
- 관련 템플릿만 실행 (빠름)
- WordPress, Joomla, Drupal 등 자동 식별

### 템플릿 필터링

```bash
# 심각도별 필터
nuclei -u http://<target> -severity critical,high

# 특정 태그
nuclei -u http://<target> -tags cve,oast,xss

# 특정 템플릿
nuclei -u http://<target> -t nuclei-templates/http/cves/

# HTTP 템플릿 제외 (네트워크 서비스 스캔)
nuclei -u 192.168.1.10:445 -et http/

# 예시
nuclei -u http://192.168.1.10 -severity critical,high -as
```

### 속도 제어 (중요)

**기본 설정**: 초당 150 요청 (대상 시스템에 부하 가능)

```bash
# 속도 제한
nuclei -u http://<target> -as -rl 50 -c 10

# 예시 (안전한 설정)
nuclei -u http://192.168.1.10 -as \
  -rl 50 \    # Rate Limit: 초당 50 요청
  -c 10 \     # Concurrency: 동시 10개 템플릿
  -bs 5       # Bulk Size: 템플릿당 5개 호스트
```

**주요 플래그**:
- `-rl <number>`: Rate Limit (초당 요청 수, 기본 150)
- `-c <number>`: Concurrency (동시 템플릿 수, 기본 25)
- `-bs <number>`: Bulk Size (템플릿당 호스트 수, 기본 25)

### 출력 옵션

```bash
# JSON 출력
nuclei -u http://<target> -as -json -o results.json

# Markdown 출력
nuclei -u http://<target> -as -markdown -o report.md

# 특정 심각도만 출력
nuclei -u http://<target> -as -severity critical,high -o critical.txt

# Silent 모드 (결과만 출력)
nuclei -u http://<target> -as -silent
```

---

## Nikto

### 개요

**Nikto**: 오래된 웹 취약점 스캐너

**특징**:
- 2001년 개발 (마지막 업데이트 2015년)
- 빠른 속도
- 간단한 사용법
- 오래된 웹 기술(PHP, CGI, Perl) 특화

**제한사항**:
- 최신 웹 기술 지원 부족
- 단순한 스캔 방식
- 오탐 많음

### 사용법

```bash
# 기본 스캔
nikto -h http://<target>

# 포트 지정
nikto -h http://<target> -p 8080

# 여러 포트
nikto -h http://<target> -p 80,443,8080

# SSL 사용
nikto -h https://<target> -ssl

# 예시
nikto -h http://192.168.1.10

# 출력 저장
nikto -h http://<target> -o report.html -Format html
```

**주요 옵션**:
- `-h`: 대상 호스트
- `-p`: 포트 지정
- `-ssl`: HTTPS 사용
- `-o`: 출력 파일
- `-Format`: 출력 형식 (html, txt, csv)

---

## Nessus

### 개요

**Nessus**: 업계 표준 종합 취약점 스캐너

**버전**:
- Nessus Professional (유료)
- Nessus Essentials (무료, 16 IP 제한)
- Nessus Expert (클라우드)

### 서비스 관리

```bash
# 서비스 시작
sudo systemctl start nessusd.service

# 서비스 중지
sudo systemctl stop nessusd.service

# 서비스 상태 확인
sudo systemctl status nessusd.service

# 부팅 시 자동 시작
sudo systemctl enable nessusd.service

# 웹 인터페이스 접속
# https://localhost:8834
```

### 기본 스캔 워크플로우

#### 1. New Scan 생성

스캔 템플릿 선택:
- **Basic Network Scan**: 다수 호스트 네트워크 스캔
- **Advanced Scan**: 상세 설정 가능
- **Web Application Tests**: 웹 애플리케이션
- **Credentialed Patch Audit**: 인증 기반 패치 감사

#### 2. 스캔 설정

**General 탭**:
```
Name: 스캔 이름
Description: 설명
Targets: 192.168.1.0/24 또는 192.168.1.1-254
```

**Discovery 탭**:
- 포트 스캔 범위
- 스캔 속도
- 호스트 디스커버리 방법

**Assessment 탭**:
- 스캔 정확도
- Web Application Tests
- Brute Force 설정

**Credentials 탭** (선택 사항):
- SSH 계정
- Windows 계정
- Database 계정
- SNMP Community String

**Plugins 탭**:
- 활성화할 플러그인 선택
- 카테고리별 필터링

#### 3. 스캔 실행

```
1. Save 클릭
2. Play 버튼 (▶) 클릭
3. 스캔 진행 상황 모니터링
4. 완료 후 결과 확인
```

#### 4. 결과 분석

**Vulnerabilities 탭**:
- Critical / High / Medium / Low / Info
- CVE 번호
- 해결 방법
- 참고 자료

**Hosts 탭**:
- 호스트별 취약점 목록
- 운영체제 정보
- 열린 포트

**Remediations 탭**:
- 수정 우선순위
- 패치 정보

### 주요 설정 팁

#### Discovery 설정

```
Port Scan Range:
- Default: 0-65535 (모든 포트)
- Common Ports: 상위 1000개 포트
- Custom: 특정 포트만

Scan Speed:
- Paranoid: 매우 느림 (IDS 회피)
- Sneaky: 느림
- Polite: 보통
- Normal: 빠름
- Aggressive: 매우 빠름 (권장)
- Insane: 최고 속도 (부하 높음)
```

#### Assessment 설정

```
Scan Accuracy:
- Show potential false alarms: 오탐 가능성 포함
- Normal: 균형 (기본)
- Minimize false alarms: 오탐 최소화

Web Application Tests:
- Scan web applications: 활성화 권장
- Maximum testing depth: 깊이 설정
```

#### Credentials 추가

**SSH 예시**:
```
Category: SSH
Authentication Method: Password
Username: root
Password: ********
Elevate privileges with: sudo
```

**Windows 예시**:
```
Category: Windows
Authentication Method: Password
Username: Administrator
Password: ********
```

### 플러그인 관리

불필요한 플러그인 비활성화하여 스캔 시간 단축:

```
예시: Windows 서버가 없다면
- Windows 관련 플러그인 비활성화

예시: 웹 서비스가 없다면
- CGI abuses 비활성화
- Web Servers 비활성화
```

---

## 도구 비교

| 도구 | 대상 | 속도 | 정확도 | 사용 난이도 | 비용 |
|------|------|------|--------|------------|------|
| **Nuclei** | 웹/다목적 | 매우 빠름 | 높음 | 쉬움 | 무료 |
| **Nikto** | 웹 | 빠름 | 보통 | 매우 쉬움 | 무료 |
| **Nessus** | 종합 | 보통 | 매우 높음 | 보통 | 유료 |
| **OpenVAS** | 종합 | 느림 | 높음 | 어려움 | 무료 |
| **Burp Pro** | 웹 | 보통 | 매우 높음 | 어려움 | 유료 |

---

## 실전 워크플로우

### 단계별 자동화 스캔

```bash
# 1. 빠른 웹 스캔 (Nikto)
nikto -h http://<target>

# 2. 심층 웹 스캔 (Nuclei)
nuclei -u http://<target> -as -severity critical,high

# 3. 종합 스캔 (Nessus)
# 웹 인터페이스에서 Advanced Scan 실행

# 4. 결과 비교 및 검증
# 오탐 제거 및 실제 취약점 확인
```

---

## 주요 명령어 요약

```bash
# Nuclei
nuclei -u http://<target> -as
nuclei -u http://<target> -severity critical,high -rl 50

# Nikto
nikto -h http://<target>
nikto -h http://<target> -o report.html -Format html

# Nessus
sudo systemctl start nessusd.service
# 웹: https://localhost:8834

# OpenVAS (추가)
sudo gvm-start
# 웹: https://localhost:9392
```

## 주의사항

1. ⚠️ **승인 필수**: 대상 시스템 소유자의 명시적 승인
2. ⚠️ **속도 제한**: 시스템 과부하 방지
3. ⚠️ **DoS 위험**: 일부 취약점 스캔은 서비스 중단 가능
4. ⚠️ **오탐 검증**: 자동 스캔 결과는 수동 검증 필요
5. ⚠️ **시간대 조정**: 업무 시간 외 스캔 권장
