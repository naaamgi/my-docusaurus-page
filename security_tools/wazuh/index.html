<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-security_tools/wazuh" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Wazuh | 남키 노트</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://naaamgi.github.io/my-docusaurus-page/security_tools/wazuh/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Wazuh | 남키 노트"><meta data-rh="true" name="description" content="Wazuh 오픈소스 XDR 및 SIEM 플랫폼 완벽 가이드"><meta data-rh="true" property="og:description" content="Wazuh 오픈소스 XDR 및 SIEM 플랫폼 완벽 가이드"><meta data-rh="true" name="keywords" content="wazuh,xdr,siem,edr,security monitoring,ossec,threat detection"><link data-rh="true" rel="icon" href="/my-docusaurus-page/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://naaamgi.github.io/my-docusaurus-page/security_tools/wazuh/"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/security_tools/wazuh/" hreflang="en"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/security_tools/wazuh/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://IKHBXIBECM-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Security Tools","item":"https://naaamgi.github.io/my-docusaurus-page/category/security-tools"},{"@type":"ListItem","position":2,"name":"Wazuh","item":"https://naaamgi.github.io/my-docusaurus-page/security_tools/wazuh"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="남키 노트" href="/my-docusaurus-page/opensearch.xml">

<meta name="google-site-verification" content="TkKso4Rp4FBa7WmPeJolw4p7PHEmAgbaEN58vXpDT7s">
<meta name="algolia-site-verification" content="86D382FE0A8B0915"><link rel="stylesheet" href="/my-docusaurus-page/assets/css/styles.493a5fa7.css">
<script src="/my-docusaurus-page/assets/js/runtime~main.50eb08e6.js" defer="defer"></script>
<script src="/my-docusaurus-page/assets/js/main.445f867b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/my-docusaurus-page/img/apple-touch-icon.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-docusaurus-page/"><div class="navbar__logo"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">남키 노트</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-docusaurus-page/">docs</a><a href="https://naaamgi.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Go to Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-docusaurus-page/"><span title="소개 (Intro)" class="linkLabel_WmDU">소개 (Intro)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/cheatsheet/"><span title="Cheatsheet" class="categoryLinkLabel_W154">Cheatsheet</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/penetration-testing/"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Expand sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/my-docusaurus-page/category/security-tools/"><span title="Security Tools" class="categoryLinkLabel_W154">Security Tools</span></a><button aria-label="Collapse sidebar category &#x27;Security Tools&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/security_tools/zap/"><span title="OWASP ZAP" class="linkLabel_WmDU">OWASP ZAP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/security_tools/security-onion/"><span title="Security Onion" class="linkLabel_WmDU">Security Onion</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/security_tools/splunk/"><span title="Splunk" class="linkLabel_WmDU">Splunk</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-docusaurus-page/security_tools/wazuh/"><span title="Wazuh" class="linkLabel_WmDU">Wazuh</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/sk-rookies/"><span title="SK Rookies" class="categoryLinkLabel_W154">SK Rookies</span></a><button aria-label="Expand sidebar category &#x27;SK Rookies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/my-docusaurus-page/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/my-docusaurus-page/category/security-tools/"><span>Security Tools</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Wazuh</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Wazuh</h1></header>
<blockquote>
<p>오픈소스 XDR (Extended Detection and Response) 및 SIEM 플랫폼. 엔드포인트 보안, 위협 탐지, 규정 준수, 클라우드 보안을 통합한 보안 솔루션.</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="개요">개요<a href="#개요" class="hash-link" aria-label="Direct link to 개요" title="Direct link to 개요" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wazuh란">Wazuh란?<a href="#wazuh란" class="hash-link" aria-label="Direct link to Wazuh란?" title="Direct link to Wazuh란?" translate="no">​</a></h3>
<table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>정식 명칭</strong></td><td>Wazuh</td></tr><tr><td><strong>유형</strong></td><td>XDR, SIEM, EDR</td></tr><tr><td><strong>라이선스</strong></td><td>GPLv2 (오픈소스)</td></tr><tr><td><strong>기반</strong></td><td>OSSEC 포크</td></tr><tr><td><strong>주요 용도</strong></td><td>위협 탐지, 무결성 모니터링, 컴플라이언스</td></tr><tr><td><strong>공식 사이트</strong></td><td><a href="https://wazuh.com/" target="_blank" rel="noopener noreferrer">https://wazuh.com/</a></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="핵심-기능">핵심 기능<a href="#핵심-기능" class="hash-link" aria-label="Direct link to 핵심 기능" title="Direct link to 핵심 기능" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="아키텍처">아키텍처<a href="#아키텍처" class="hash-link" aria-label="Direct link to 아키텍처" title="Direct link to 아키텍처" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="구성-요소">구성 요소<a href="#구성-요소" class="hash-link" aria-label="Direct link to 구성 요소" title="Direct link to 구성 요소" translate="no">​</a></h3>
<table><thead><tr><th>구성 요소</th><th>역할</th><th>포트</th></tr></thead><tbody><tr><td><strong>Wazuh Server (Manager)</strong></td><td>에이전트 관리, 룰 처리, 알람 생성</td><td>1514, 1515, 55000</td></tr><tr><td><strong>Wazuh Indexer</strong></td><td>데이터 저장 (OpenSearch 기반)</td><td>9200, 9300</td></tr><tr><td><strong>Wazuh Dashboard</strong></td><td>웹 UI (OpenSearch Dashboards)</td><td>443, 5601</td></tr><tr><td><strong>Wazuh Agent</strong></td><td>엔드포인트 데이터 수집</td><td>-</td></tr><tr><td><strong>Filebeat</strong></td><td>로그 수집 및 전달</td><td>-</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agent-vs-agentless">Agent vs Agentless<a href="#agent-vs-agentless" class="hash-link" aria-label="Direct link to Agent vs Agentless" title="Direct link to Agent vs Agentless" translate="no">​</a></h3>
<table><thead><tr><th>방식</th><th>설명</th><th>장점</th><th>단점</th></tr></thead><tbody><tr><td><strong>Agent 형태</strong></td><td>클라이언트에 프로그램 설치</td><td>상세 모니터링, 실시간 탐지</td><td>설치 필요</td></tr><tr><td><strong>Agentless 형태</strong></td><td>서버에서 SSH로 원격 모니터링</td><td>설치 불필요</td><td>제한적 모니터링</td></tr></tbody></table>
<blockquote>
<p><strong>Agentless 대표 도구</strong>: Ansible, Terraform</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="설치">설치<a href="#설치" class="hash-link" aria-label="Direct link to 설치" title="Direct link to 설치" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시스템-요구사항">시스템 요구사항<a href="#시스템-요구사항" class="hash-link" aria-label="Direct link to 시스템 요구사항" title="Direct link to 시스템 요구사항" translate="no">​</a></h3>
<table><thead><tr><th>구성</th><th>최소 사양</th><th>권장 사양</th></tr></thead><tbody><tr><td><strong>All-in-One</strong></td><td>4 CPU, 8GB RAM</td><td>8 CPU, 16GB RAM</td></tr><tr><td><strong>분산 환경</strong></td><td>각 노드별</td><td>권장 사양 이상</td></tr><tr><td><strong>에이전트</strong></td><td>1 CPU, 512MB RAM</td><td>-</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="사전-준비">사전 준비<a href="#사전-준비" class="hash-link" aria-label="Direct link to 사전 준비" title="Direct link to 사전 준비" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 호스트명 설정 (서버와 Agent 이름 충돌 방지!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo hostnamectl set-hostname wazuh-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># IP 고정 (Netplan 예시)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/netplan/01-netcfg.yaml</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># /etc/netplan/01-netcfg.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">renderer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networkd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ethernets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ens32</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">dhcp4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">addresses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 192.168.2.10/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">gateway4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.168.2.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nameservers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">addresses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">8.8.8.8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 8.8.4.4</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo netplan apply</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="all-in-one-설치-권장">All-in-One 설치 (권장)<a href="#all-in-one-설치-권장" class="hash-link" aria-label="Direct link to All-in-One 설치 (권장)" title="Direct link to All-in-One 설치 (권장)" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Wazuh 설치 스크립트 다운로드 및 실행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /wazuh &amp;&amp; cd /wazuh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sO https://packages.wazuh.com/4.9/wazuh-install.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bash wazuh-install.sh -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 설치 완료 후 출력되는 정보 저장</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Dashboard URL: https://&lt;server-ip&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Username: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - Password: &lt;generated-password&gt;</span><br></span></code></pre></div></div>
<blockquote>
<p><code>-s</code>: Silent Mode, <code>-o</code>: Output 파일명, <code>-a</code>: All-in-One 설치</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="개별-구성요소-설치">개별 구성요소 설치<a href="#개별-구성요소-설치" class="hash-link" aria-label="Direct link to 개별 구성요소 설치" title="Direct link to 개별 구성요소 설치" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. Wazuh Indexer 설치</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sO https://packages.wazuh.com/4.9/wazuh-install.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash wazuh-install.sh --wazuh-indexer &lt;indexer-node-name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. Wazuh Server 설치</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash wazuh-install.sh --wazuh-server &lt;server-node-name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. Wazuh Dashboard 설치</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash wazuh-install.sh --wazuh-dashboard &lt;dashboard-node-name&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-설치">Docker 설치<a href="#docker-설치" class="hash-link" aria-label="Direct link to Docker 설치" title="Direct link to Docker 설치" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Docker Compose 파일 다운로드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/wazuh/wazuh-docker.git -b v4.9.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd wazuh-docker/single-node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 인증서 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f generate-indexer-certs.yml run --rm generator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 컨테이너 시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="패스워드-확인변경">패스워드 확인/변경<a href="#패스워드-확인변경" class="hash-link" aria-label="Direct link to 패스워드 확인/변경" title="Direct link to 패스워드 확인/변경" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 초기 패스워드 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo tar -xvf wazuh-install-files.tar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 패스워드 변경 도구 다운로드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sO https://packages.wazuh.com/resources/4.2/open-distro/tools/wazuh-passwords-tool.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x wazuh-passwords-tool.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 패스워드 변경 (예: wazuh / 123456)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./wazuh-passwords-tool.sh -u wazuh -p 123456</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="서비스-확인-및-재시작">서비스 확인 및 재시작<a href="#서비스-확인-및-재시작" class="hash-link" aria-label="Direct link to 서비스 확인 및 재시작" title="Direct link to 서비스 확인 및 재시작" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 서비스 상태 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status kibana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status elasticsearch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status filebeat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status wazuh-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 서비스 재시작 (설정 변경 후 필수)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wazuh-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 부팅 시 자동 시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable kibana elasticsearch filebeat wazuh-manager</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="에이전트-설치">에이전트 설치<a href="#에이전트-설치" class="hash-link" aria-label="Direct link to 에이전트 설치" title="Direct link to 에이전트 설치" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-에이전트">Linux 에이전트<a href="#linux-에이전트" class="hash-link" aria-label="Direct link to Linux 에이전트" title="Direct link to Linux 에이전트" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Debian/Ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import &amp;&amp; chmod 644 /usr/share/keyrings/wazuh.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main&quot; | tee /etc/apt/sources.list.d/wazuh.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt update &amp;&amp; apt install wazuh-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># RHEL/CentOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rpm --import https://packages.wazuh.com/key/GPG-KEY-WAZUH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/yum.repos.d/wazuh.repo &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[wazuh]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgkey=https://packages.wazuh.com/key/GPG-KEY-WAZUH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name=Wazuh repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl=https://packages.wazuh.com/4.x/yum/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protect=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install wazuh-agent</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="에이전트-등록">에이전트 등록<a href="#에이전트-등록" class="hash-link" aria-label="Direct link to 에이전트 등록" title="Direct link to 에이전트 등록" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 매니저 주소 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &quot;s/MANAGER_IP/&lt;wazuh-server-ip&gt;/g&quot; /var/ossec/etc/ossec.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 등록 (API 사용)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent-auth -m &lt;wazuh-server-ip&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable wazuh-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start wazuh-agent</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="windows-에이전트">Windows 에이전트<a href="#windows-에이전트" class="hash-link" aria-label="Direct link to Windows 에이전트" title="Direct link to Windows 에이전트" translate="no">​</a></h3>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># MSI 다운로드 및 설치</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.9.0-1.msi -OutFile wazuh-agent.msi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msiexec.exe /i wazuh-agent.msi /q WAZUH_MANAGER=&quot;&lt;wazuh-server-ip&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 서비스 시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NET START WazuhSvc</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="macos-에이전트">macOS 에이전트<a href="#macos-에이전트" class="hash-link" aria-label="Direct link to macOS 에이전트" title="Direct link to macOS 에이전트" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># PKG 다운로드 및 설치</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -o wazuh-agent.pkg https://packages.wazuh.com/4.x/macos/wazuh-agent-4.9.0-1.pkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo installer -pkg wazuh-agent.pkg -target /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 매니저 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo /Library/Ossec/bin/wazuh-control set WAZUH_MANAGER &lt;wazuh-server-ip&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo /Library/Ossec/bin/wazuh-control start</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="agentless-설정">Agentless 설정<a href="#agentless-설정" class="hash-link" aria-label="Direct link to Agentless 설정" title="Direct link to Agentless 설정" translate="no">​</a></h2>
<p>클라이언트에 아무것도 설치하지 않고 <strong>SSH로 원격 모니터링</strong>하는 방식입니다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-설정-모니터링-대상-서버">SSH 설정 (모니터링 대상 서버)<a href="#ssh-설정-모니터링-대상-서버" class="hash-link" aria-label="Direct link to SSH 설정 (모니터링 대상 서버)" title="Direct link to SSH 설정 (모니터링 대상 서버)" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># SSH 서버 설치 (Ubuntu)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install -y openssh-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 모니터링용 사용자 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adduser wazuh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 비밀번호 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sudo 권한 부여</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;wazuh ALL=(ALL:ALL) ALL&quot; &gt;&gt; /etc/sudoers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH 설정 수정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nano /etc/ssh/sshd_config</span><br></span></code></pre></div></div>
<p><strong>sshd_config 수정</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Port 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ListenAddress 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PermitRootLogin yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PasswordAuthentication yes</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># SSH 재시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart sshd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable sshd</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-연결-테스트-wazuh-서버에서">SSH 연결 테스트 (Wazuh 서버에서)<a href="#ssh-연결-테스트-wazuh-서버에서" class="hash-link" aria-label="Direct link to SSH 연결 테스트 (Wazuh 서버에서)" title="Direct link to SSH 연결 테스트 (Wazuh 서버에서)" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 연결 테스트 - 성공 시 exit으로 빠져나옴</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh wazuh@&lt;agent-ip&gt;</span><br></span></code></pre></div></div>
<blockquote>
<p>SSH 연결이 되어야만 Agentless 등록 가능!</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agentless-호스트-등록">Agentless 호스트 등록<a href="#agentless-호스트-등록" class="hash-link" aria-label="Direct link to Agentless 호스트 등록" title="Direct link to Agentless 호스트 등록" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Wazuh 서버에서 실행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /var/ossec/agentless</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 호스트 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./register_host.sh add wazuh@&lt;agent-ip&gt; &lt;password&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 등록 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./register_host.sh list</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expect-패키지-설치-필수">expect 패키지 설치 (필수!)<a href="#expect-패키지-설치-필수" class="hash-link" aria-label="Direct link to expect 패키지 설치 (필수!)" title="Direct link to expect 패키지 설치 (필수!)" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 없으면 Agentless 동작 안 함</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install -y expect</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ossecconf-설정">ossec.conf 설정<a href="#ossecconf-설정" class="hash-link" aria-label="Direct link to ossec.conf 설정" title="Direct link to ossec.conf 설정" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nano /var/ossec/etc/ossec.conf</span><br></span></code></pre></div></div>
<p>맨 끝에 추가 (<code>&lt;/ossec_config&gt;</code> 바로 위):</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 루트 디렉토리 변화 감지 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ssh_generic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">wazuh@192.168.2.12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">periodic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ls -al /</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /etc/passwd 변화 감지 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ssh_generic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">wazuh@192.168.2.12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">periodic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">tail -n 1 /etc/passwd</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /etc/shadow 변화 감지 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ssh_generic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">type</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">wazuh@192.168.2.12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">host</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">periodic_diff</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">state</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">tail -n 1 /etc/shadow</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">arguments</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">agentless</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<table><thead><tr><th>태그</th><th>설명</th></tr></thead><tbody><tr><td><code>&lt;type&gt;ssh_generic_diff&lt;/type&gt;</code></td><td>SSH로 명령 실행 후 이전 결과와 비교</td></tr><tr><td><code>&lt;frequency&gt;10&lt;/frequency&gt;</code></td><td>10초마다 실행 (테스트용, 실제는 더 길게)</td></tr><tr><td><code>&lt;host&gt;</code></td><td>SSH 접속 정보 (user@ip)</td></tr><tr><td><code>&lt;state&gt;periodic_diff&lt;/state&gt;</code></td><td>변경분만 알림</td></tr><tr><td><code>&lt;arguments&gt;</code></td><td>원격에서 실행할 명령</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wazuh-재시작-및-확인">Wazuh 재시작 및 확인<a href="#wazuh-재시작-및-확인" class="hash-link" aria-label="Direct link to Wazuh 재시작 및 확인" title="Direct link to Wazuh 재시작 및 확인" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 재시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 로그 확인 (PASS 확인)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -f /var/ossec/logs/ossec.log</span><br></span></code></pre></div></div>
<p><strong>성공 시 출력</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ossec-agentlessd: Test passed for &#x27;ssh_generic_diff&#x27; on &#x27;wazuh@192.168.2.12&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agentless-테스트">Agentless 테스트<a href="#agentless-테스트" class="hash-link" aria-label="Direct link to Agentless 테스트" title="Direct link to Agentless 테스트" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 대상 서버에서 파일 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh wazuh@192.168.2.12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo touch /webshell.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Wazuh 서버에서 로그 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /var/ossec/logs/alerts/alerts.json | grep webshell</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="대시보드">대시보드<a href="#대시보드" class="hash-link" aria-label="Direct link to 대시보드" title="Direct link to 대시보드" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="웹-인터페이스-접속">웹 인터페이스 접속<a href="#웹-인터페이스-접속" class="hash-link" aria-label="Direct link to 웹 인터페이스 접속" title="Direct link to 웹 인터페이스 접속" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">URL: https://&lt;wazuh-server-ip&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">기본 계정: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">비밀번호: 설치 시 출력된 비밀번호</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="주요-메뉴">주요 메뉴<a href="#주요-메뉴" class="hash-link" aria-label="Direct link to 주요 메뉴" title="Direct link to 주요 메뉴" translate="no">​</a></h3>
<table><thead><tr><th>메뉴</th><th>기능</th></tr></thead><tbody><tr><td><strong>Overview</strong></td><td>전체 현황 요약</td></tr><tr><td><strong>Threat Intelligence</strong></td><td>MITRE ATT&amp;CK, Threat Hunting</td></tr><tr><td><strong>Security Events</strong></td><td>보안 이벤트 분석</td></tr><tr><td><strong>Integrity Monitoring</strong></td><td>파일 무결성 변경</td></tr><tr><td><strong>Vulnerability Detection</strong></td><td>취약점 탐지</td></tr><tr><td><strong>Regulatory Compliance</strong></td><td>PCI DSS, GDPR, HIPAA 등</td></tr><tr><td><strong>Configuration Assessment</strong></td><td>CIS 벤치마크</td></tr><tr><td><strong>Agents</strong></td><td>에이전트 관리</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-events">Security Events<a href="#security-events" class="hash-link" aria-label="Direct link to Security Events" title="Direct link to Security Events" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Modules → Security Events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 필터 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.level &gt;= 10           # 높은 심각도</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.groups: authentication  # 인증 관련</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agent.name: webserver       # 특정 에이전트</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="규칙-시스템">규칙 시스템<a href="#규칙-시스템" class="hash-link" aria-label="Direct link to 규칙 시스템" title="Direct link to 규칙 시스템" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="규칙-구조">규칙 구조<a href="#규칙-구조" class="hash-link" aria-label="Direct link to 규칙 구조" title="Direct link to 규칙 구조" translate="no">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/ruleset/rules/ --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">100001</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">level</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">10</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5710</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">match</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Failed password</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">match</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">SSH authentication failed</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">group</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">authentication_failed,</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">group</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="규칙-레벨">규칙 레벨<a href="#규칙-레벨" class="hash-link" aria-label="Direct link to 규칙 레벨" title="Direct link to 규칙 레벨" translate="no">​</a></h3>
<table><thead><tr><th>레벨</th><th>심각도</th><th>설명</th></tr></thead><tbody><tr><td>0-3</td><td>낮음</td><td>정보성 이벤트</td></tr><tr><td>4-7</td><td>중간</td><td>경고, 에러</td></tr><tr><td>8-11</td><td>높음</td><td>주의 필요</td></tr><tr><td>12-15</td><td>심각</td><td>즉시 조치 필요</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="커스텀-규칙-생성">커스텀 규칙 생성<a href="#커스텀-규칙-생성" class="hash-link" aria-label="Direct link to 커스텀 규칙 생성" title="Direct link to 커스텀 규칙 생성" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 커스텀 규칙 파일</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /var/ossec/etc/rules/local_rules.xml</span><br></span></code></pre></div></div>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">group</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">custom_rules,</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 브루트포스 탐지 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">100100</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">level</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">10</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">frequency</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">5</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">timeframe</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">60</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if_matched_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5710</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if_matched_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">same_source_ip</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">SSH brute force attack detected</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">mitre</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">T1110</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">mitre</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 의심스러운 명령 실행 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">100101</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">level</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">12</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">if_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5402</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">if_sid</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">match</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">wget|curl|nc|netcat</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">match</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Suspicious command execution</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">description</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rule</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">group</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 규칙 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-logtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 설정 적용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wazuh-manager</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="규칙-테스트-wazuh-logtest">규칙 테스트 (wazuh-logtest)<a href="#규칙-테스트-wazuh-logtest" class="hash-link" aria-label="Direct link to 규칙 테스트 (wazuh-logtest)" title="Direct link to 규칙 테스트 (wazuh-logtest)" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-logtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 테스트할 로그 입력</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jan 15 10:30:00 server sshd[1234]: Failed password for admin from 192.168.1.100 port 22 ssh2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 출력: 매칭된 규칙 정보</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="주요-기능-상세">주요 기능 상세<a href="#주요-기능-상세" class="hash-link" aria-label="Direct link to 주요 기능 상세" title="Direct link to 주요 기능 상세" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-파일-무결성-모니터링-fim">1. 파일 무결성 모니터링 (FIM)<a href="#1-파일-무결성-모니터링-fim" class="hash-link" aria-label="Direct link to 1. 파일 무결성 모니터링 (FIM)" title="Direct link to 1. 파일 무결성 모니터링 (FIM)" translate="no">​</a></h3>
<p>중요 파일/디렉토리 변경 감지:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">syscheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">no</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">43200</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 모니터링 디렉토리 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">check_all</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">realtime</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/etc</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">check_all</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">realtime</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/usr/bin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">check_all</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">realtime</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/usr/sbin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Windows --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">check_all</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">realtime</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yes</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">C:\Windows\System32</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">directories</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 제외 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ignore</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/etc/mtab</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ignore</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ignore</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">sregex</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">.log$</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ignore</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">syscheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-취약점-탐지">2. 취약점 탐지<a href="#2-취약점-탐지" class="hash-link" aria-label="Direct link to 2. 취약점 탐지" title="Direct link to 2. 취약점 탐지" translate="no">​</a></h3>
<p>에이전트에 설치된 패키지의 CVE 스캔:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">vulnerability-detection</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">enabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">enabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">index-status</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">index-status</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">feed-update-interval</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">60m</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">feed-update-interval</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">vulnerability-detection</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 대시보드에서 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Modules → Vulnerability Detection</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-cis-벤치마크-sca">3. CIS 벤치마크 (SCA)<a href="#3-cis-벤치마크-sca" class="hash-link" aria-label="Direct link to 3. CIS 벤치마크 (SCA)" title="Direct link to 3. CIS 벤치마크 (SCA)" translate="no">​</a></h3>
<p>보안 구성 평가:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">sca</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">enabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">enabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">scan_on_start</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">scan_on_start</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">interval</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">12h</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">interval</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 정책 파일 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">policies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">policy</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cis_ubuntu22-04.yml</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">policy</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">policy</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cis_win2022.yml</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">policy</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">policies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">sca</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-액티브-리스폰스">4. 액티브 리스폰스<a href="#4-액티브-리스폰스" class="hash-link" aria-label="Direct link to 4. 액티브 리스폰스" title="Direct link to 4. 액티브 리스폰스" translate="no">​</a></h3>
<p>자동 대응 설정:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">active-response</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">firewall-drop</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">local</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rules_id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5710</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rules_id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">timeout</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3600</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">timeout</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">active-response</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 커스텀 스크립트 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">custom-block</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">executable</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">custom-block.sh</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">executable</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">timeout_allowed</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">timeout_allowed</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">active-response</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">custom-block</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">command</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">local</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rules_id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">100100</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rules_id</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">timeout</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">600</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">timeout</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">active-response</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-로그-수집">5. 로그 수집<a href="#5-로그-수집" class="hash-link" aria-label="Direct link to 5. 로그 수집" title="Direct link to 5. 로그 수집" translate="no">​</a></h3>
<p>Syslog 및 커스텀 로그 수집:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 로컬 파일 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">syslog</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/var/log/auth.log</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- JSON 로그 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">json</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">/var/log/app/app.json</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Windows 이벤트 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">eventchannel</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Security</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="검색-및-쿼리">검색 및 쿼리<a href="#검색-및-쿼리" class="hash-link" aria-label="Direct link to 검색 및 쿼리" title="Direct link to 검색 및 쿼리" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wazuh-query-language">Wazuh Query Language<a href="#wazuh-query-language" class="hash-link" aria-label="Direct link to Wazuh Query Language" title="Direct link to Wazuh Query Language" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 기본 검색 (대시보드 검색창)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.level &gt;= 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 에이전트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agent.name: webserver01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 시간 범위</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@timestamp:[now-24h TO now]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 규칙</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.id: 5710</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 소스 IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.srcip: 192.168.1.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MITRE 기법</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.mitre.id: T1110</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 복합 검색</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.level &gt;= 10 AND agent.name: server* AND NOT rule.id: 5402</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="자주-사용하는-쿼리">자주 사용하는 쿼리<a href="#자주-사용하는-쿼리" class="hash-link" aria-label="Direct link to 자주 사용하는 쿼리" title="Direct link to 자주 사용하는 쿼리" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 인증 실패</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.groups: authentication_failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 파일 무결성 변경</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.groups: syscheck AND syscheck.event: modified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 높은 심각도 알림</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.level &gt;= 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 IP 관련 이벤트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.srcip: &quot;10.0.0.*&quot; OR data.dstip: &quot;10.0.0.*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 악성코드 탐지</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.groups: rootcheck OR rule.groups: malware</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 권한 상승</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.groups: priv_esc</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-사용">API 사용<a href="#api-사용" class="hash-link" aria-label="Direct link to API 사용" title="Direct link to API 사용" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-인증">API 인증<a href="#api-인증" class="hash-link" aria-label="Direct link to API 인증" title="Direct link to API 인증" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 토큰 획득</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOKEN=$(curl -u &lt;user&gt;:&lt;password&gt; -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/security/user/authenticate?raw=true&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 토큰 사용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="주요-api-엔드포인트">주요 API 엔드포인트<a href="#주요-api-엔드포인트" class="hash-link" aria-label="Direct link to 주요 API 엔드포인트" title="Direct link to 주요 API 엔드포인트" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 목록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/agents&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 에이전트 정보</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/agents?agents_list=001&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 규칙 목록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/rules&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 알림 조회</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/alerts&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 매니저 상태</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -k -X GET &quot;https://&lt;wazuh-server&gt;:55000/manager/status&quot; -H &quot;Authorization: Bearer $TOKEN&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="통합-integration">통합 (Integration)<a href="#통합-integration" class="hash-link" aria-label="Direct link to 통합 (Integration)" title="Direct link to 통합 (Integration)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="slack-알림">Slack 알림<a href="#slack-알림" class="hash-link" aria-label="Direct link to Slack 알림" title="Direct link to Slack 알림" translate="no">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">slack</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">https://hooks.slack.com/services/xxx/yyy/zzz</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">alert_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">json</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">alert_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="thehive-연동">TheHive 연동<a href="#thehive-연동" class="hash-link" aria-label="Direct link to TheHive 연동" title="Direct link to TheHive 연동" translate="no">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- /var/ossec/etc/ossec.conf --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">custom-thehive</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">http://thehive:9000/api/alert</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">api_key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">YOUR_THEHIVE_API_KEY</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">api_key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">10</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="shuffle-soar">Shuffle SOAR<a href="#shuffle-soar" class="hash-link" aria-label="Direct link to Shuffle SOAR" title="Direct link to Shuffle SOAR" translate="no">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shuffle</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">name</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">https://shuffler.io/api/v1/hooks/xxx</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">hook_url</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">alert_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">json</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">alert_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="관리-명령어">관리 명령어<a href="#관리-명령어" class="hash-link" aria-label="Direct link to 관리 명령어" title="Direct link to 관리 명령어" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="서비스-관리">서비스 관리<a href="#서비스-관리" class="hash-link" aria-label="Direct link to 서비스 관리" title="Direct link to 서비스 관리" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 상태 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status wazuh-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status wazuh-indexer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status wazuh-dashboard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 재시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wazuh-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wazuh-indexer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart wazuh-dashboard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 로그 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -f /var/ossec/logs/ossec.log</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="에이전트-관리">에이전트 관리<a href="#에이전트-관리" class="hash-link" aria-label="Direct link to 에이전트 관리" title="Direct link to 에이전트 관리" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 목록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 상태</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -i 001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 연결된 에이전트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -lc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 제거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/manage_agents -r 001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 재시작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -R 001</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="설정-검증">설정 검증<a href="#설정-검증" class="hash-link" aria-label="Direct link to 설정 검증" title="Direct link to 설정 검증" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 설정 파일 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control verify-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 규칙 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-logtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 디코더 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-logtest -v</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="클러스터-관리">클러스터 관리<a href="#클러스터-관리" class="hash-link" aria-label="Direct link to 클러스터 관리" title="Direct link to 클러스터 관리" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 클러스터 상태</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/cluster_control -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 노드 정보</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/cluster_control -i</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="설정-파일">설정 파일<a href="#설정-파일" class="hash-link" aria-label="Direct link to 설정 파일" title="Direct link to 설정 파일" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="주요-설정-파일-위치">주요 설정 파일 위치<a href="#주요-설정-파일-위치" class="hash-link" aria-label="Direct link to 주요 설정 파일 위치" title="Direct link to 주요 설정 파일 위치" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 메인 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/etc/ossec.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 그룹 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/etc/shared/&lt;group&gt;/agent.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 규칙</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/ruleset/rules/        # 기본 규칙</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/etc/rules/            # 커스텀 규칙</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 디코더</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/ruleset/decoders/     # 기본 디코더</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/etc/decoders/         # 커스텀 디코더</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SCA 정책</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/ruleset/sca/</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ossecconf-주요-섹션">ossec.conf 주요 섹션<a href="#ossecconf-주요-섹션" class="hash-link" aria-label="Direct link to ossec.conf 주요 섹션" title="Direct link to ossec.conf 주요 섹션" translate="no">​</a></h3>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ossec_config</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 글로벌 설정 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">global</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">logall</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">no</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">logall</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">logall_json</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">logall_json</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">email_notification</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">yes</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">email_notification</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">global</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 알림 설정 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">alerts</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log_alert_level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">3</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log_alert_level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">email_alert_level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">email_alert_level</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">alerts</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 원격 연결 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">remote</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">connection</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">secure</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">connection</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">port</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1514</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">port</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">remote</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 루트체크 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">rootcheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">no</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">36000</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">rootcheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- 파일 무결성 --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">syscheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">no</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">disabled</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">43200</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">frequency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">syscheck</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ossec_config</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="빠른-명령어-참조">빠른 명령어 참조<a href="#빠른-명령어-참조" class="hash-link" aria-label="Direct link to 빠른 명령어 참조" title="Direct link to 빠른 명령어 참조" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="일상-운영">일상 운영<a href="#일상-운영" class="hash-link" aria-label="Direct link to 일상 운영" title="Direct link to 일상 운영" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 서비스 상태</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status wazuh-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 연결된 에이전트 수</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -lc | wc -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 최근 알림 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -f /var/ossec/logs/alerts/alerts.json | jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 설정 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control verify-config</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="문제-해결">문제 해결<a href="#문제-해결" class="hash-link" aria-label="Direct link to 문제 해결" title="Direct link to 문제 해결" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 로그 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -100 /var/ossec/logs/ossec.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 에이전트 연결 문제</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/agent_control -i &lt;agent_id&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 규칙 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-logtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 설정 재로드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control reload</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="에이전트-cli">에이전트 CLI<a href="#에이전트-cli" class="hash-link" aria-label="Direct link to 에이전트 CLI" title="Direct link to 에이전트 CLI" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Linux/macOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/ossec/bin/wazuh-control restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NET STOP WazuhSvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NET START WazuhSvc</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-sysmon-연동">Windows Sysmon 연동<a href="#windows-sysmon-연동" class="hash-link" aria-label="Direct link to Windows Sysmon 연동" title="Direct link to Windows Sysmon 연동" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysmon이란">Sysmon이란?<a href="#sysmon이란" class="hash-link" aria-label="Direct link to Sysmon이란?" title="Direct link to Sysmon이란?" translate="no">​</a></h3>
<p>Microsoft 제공 무료 도구로 Windows 활동을 <strong>상세하게 로깅</strong>합니다. Wazuh와 연동 시 <strong>고급 위협 탐지</strong>가 가능합니다.</p>
<p><strong>Sysmon 주요 기능</strong>:</p>
<ul>
<li>프로세스 생성/종료 로깅</li>
<li>네트워크 연결 로깅</li>
<li>파일 생성 시간 변경 로깅</li>
<li>드라이버/이미지 로딩 로깅</li>
<li><strong>Hash값 로깅</strong> (악성파일 탐지)</li>
<li><strong>프로세스 부모-자식 관계</strong> 표시</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysmon-다운로드-및-설치">Sysmon 다운로드 및 설치<a href="#sysmon-다운로드-및-설치" class="hash-link" aria-label="Direct link to Sysmon 다운로드 및 설치" title="Direct link to Sysmon 다운로드 및 설치" translate="no">​</a></h3>
<ol>
<li><a href="https://learn.microsoft.com/ko-kr/sysinternals/downloads/sysmon" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/ko-kr/sysinternals/downloads/sysmon</a> 에서 다운로드</li>
<li>압축 해제</li>
</ol>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># CMD 관리자 권한으로 실행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd C:\Users\[사용자]\Downloads\Sysmon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 설치 (EULA 자동 동의)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sysmon64.exe -accepteula -i</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysmon-config-설정">Sysmon Config 설정<a href="#sysmon-config-설정" class="hash-link" aria-label="Direct link to Sysmon Config 설정" title="Direct link to Sysmon Config 설정" translate="no">​</a></h3>
<p>GitHub에서 설정 파일 다운로드:</p>
<ul>
<li><a href="https://github.com/sametsazak/sysmon" target="_blank" rel="noopener noreferrer">https://github.com/sametsazak/sysmon</a></li>
<li><code>sysmon.xml</code> (클라이언트 측 설정)</li>
<li><code>sysmon_rules.xml</code> (서버 측 룰)</li>
</ul>
<p><strong>sysmon.xml 수정</strong> (특정 명령어 로깅 추가):</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ProcessCreate</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">onmatch</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">include</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">CommandLine</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">condition</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">contains</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cmd.exe /c dir</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">CommandLine</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">CommandLine</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">condition</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">contains</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">cmd.exe /c ping</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">CommandLine</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ProcessCreate</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 수정한 config 적용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sysmon64.exe -c sysmon.xml</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="이벤트-뷰어-확인">이벤트 뷰어 확인<a href="#이벤트-뷰어-확인" class="hash-link" aria-label="Direct link to 이벤트 뷰어 확인" title="Direct link to 이벤트 뷰어 확인" translate="no">​</a></h3>
<ol>
<li>검색 → <strong>이벤트 뷰어</strong></li>
<li>응용 프로그램 및 서비스 로그 → Microsoft → Windows → <strong>Sysmon</strong> → Operational</li>
<li>로그 발생 확인</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wazuh-agent-설정-windows">Wazuh Agent 설정 (Windows)<a href="#wazuh-agent-설정-windows" class="hash-link" aria-label="Direct link to Wazuh Agent 설정 (Windows)" title="Direct link to Wazuh Agent 설정 (Windows)" translate="no">​</a></h3>
<p><code>C:\Program Files (x86)\ossec-agent\ossec.conf</code> 편집:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Microsoft-Windows-Sysmon/Operational</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">location</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">eventchannel</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">log_format</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">localfile</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<blockquote>
<p>Sysmon 로그를 Wazuh로 전송하도록 설정</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wazuh-agent-재시작">Wazuh Agent 재시작<a href="#wazuh-agent-재시작" class="hash-link" aria-label="Direct link to Wazuh Agent 재시작" title="Direct link to Wazuh Agent 재시작" translate="no">​</a></h3>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># CMD 관리자 권한</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;C:\Program Files (x86)\ossec-agent\win32ui.exe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Manage → Restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 또는 명령어로</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net stop WazuhSvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net start WazuhSvc</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitre-attck-매핑">MITRE ATT&amp;CK 매핑<a href="#mitre-attck-매핑" class="hash-link" aria-label="Direct link to MITRE ATT&amp;CK 매핑" title="Direct link to MITRE ATT&amp;CK 매핑" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="탐지-가능한-주요-기법">탐지 가능한 주요 기법<a href="#탐지-가능한-주요-기법" class="hash-link" aria-label="Direct link to 탐지 가능한 주요 기법" title="Direct link to 탐지 가능한 주요 기법" translate="no">​</a></h3>
<table><thead><tr><th>Tactic</th><th>Technique</th><th>Wazuh 규칙 그룹</th></tr></thead><tbody><tr><td>Initial Access</td><td>Phishing (T1566)</td><td>web, email</td></tr><tr><td>Execution</td><td>Command Line (T1059)</td><td>syslog, audit</td></tr><tr><td>Persistence</td><td>Registry Run Keys (T1547)</td><td>syscheck, windows</td></tr><tr><td>Privilege Escalation</td><td>Sudo (T1548)</td><td>authentication, priv_esc</td></tr><tr><td>Defense Evasion</td><td>Masquerading (T1036)</td><td>syscheck, rootcheck</td></tr><tr><td>Credential Access</td><td>Brute Force (T1110)</td><td>authentication_failed</td></tr><tr><td>Discovery</td><td>System Info (T1082)</td><td>audit, process</td></tr><tr><td>Lateral Movement</td><td>Remote Services (T1021)</td><td>authentication</td></tr><tr><td>Collection</td><td>Data from Local System (T1005)</td><td>syscheck</td></tr><tr><td>Exfiltration</td><td>Exfiltration Over C2 (T1041)</td><td>network</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="트러블슈팅-체크리스트">트러블슈팅 체크리스트<a href="#트러블슈팅-체크리스트" class="hash-link" aria-label="Direct link to 트러블슈팅 체크리스트" title="Direct link to 트러블슈팅 체크리스트" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="에이전트-연결-안됨">에이전트 연결 안됨<a href="#에이전트-연결-안됨" class="hash-link" aria-label="Direct link to 에이전트 연결 안됨" title="Direct link to 에이전트 연결 안됨" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->매니저 IP/포트 설정 확인 (<code>ossec.conf</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->방화벽 확인: <code>ufw status</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->포트 확인: <code>netstat -tlnp | grep 1514</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->에이전트 키 등록 확인 (<code>agent-auth</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->서비스 상태: <code>systemctl status wazuh-manager</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->에이전트 로그 확인: <code>/var/ossec/logs/ossec.log</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="agentless-동작-안-함">Agentless 동작 안 함<a href="#agentless-동작-안-함" class="hash-link" aria-label="Direct link to Agentless 동작 안 함" title="Direct link to Agentless 동작 안 함" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SSH 연결 테스트: <code>ssh wazuh@&lt;agent-ip&gt;</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->expect 설치 확인: <code>apt install -y expect</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->호스트 등록 확인: <code>/var/ossec/agentless/register_host.sh list</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->로그 확인: <code>tail -f /var/ossec/logs/ossec.log</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="알림이-생성되지-않음">알림이 생성되지 않음<a href="#알림이-생성되지-않음" class="hash-link" aria-label="Direct link to 알림이 생성되지 않음" title="Direct link to 알림이 생성되지 않음" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->규칙 레벨 확인 (<code>log_alert_level</code> 설정)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->규칙 구문 오류 확인 (<code>wazuh-control verify-config</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>wazuh-logtest</code>로 규칙 테스트</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->디코더가 로그를 파싱하는지 확인</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysmon-로그-안-올라올-때">Sysmon 로그 안 올라올 때<a href="#sysmon-로그-안-올라올-때" class="hash-link" aria-label="Direct link to Sysmon 로그 안 올라올 때" title="Direct link to Sysmon 로그 안 올라올 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->이벤트 뷰어에서 Sysmon 로그 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->ossec.conf에 localfile 설정 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Wazuh Agent 재시작: <code>net restart WazuhSvc</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="대시보드-접속-불가">대시보드 접속 불가<a href="#대시보드-접속-불가" class="hash-link" aria-label="Direct link to 대시보드 접속 불가" title="Direct link to 대시보드 접속 불가" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Wazuh Indexer 상태 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Wazuh Dashboard 서비스 상태 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->443 포트 방화벽 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SSL 인증서 문제 확인 (고급 → 안전하지 않음 진행)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="디스크-공간-부족">디스크 공간 부족<a href="#디스크-공간-부족" class="hash-link" aria-label="Direct link to 디스크 공간 부족" title="Direct link to 디스크 공간 부족" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->인덱스 보존 정책 설정</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->오래된 인덱스 삭제</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->로그 로테이션 설정 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->아카이브 비활성화 고려</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="성능-문제">성능 문제<a href="#성능-문제" class="hash-link" aria-label="Direct link to 성능 문제" title="Direct link to 성능 문제" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->불필요한 로그 수집 비활성화</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->FIM 모니터링 범위 최적화</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SCA 스캔 주기 조정</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->인덱서 힙 메모리 조정</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kibana-검색-쿼리">Kibana 검색 쿼리<a href="#kibana-검색-쿼리" class="hash-link" aria-label="Direct link to Kibana 검색 쿼리" title="Direct link to Kibana 검색 쿼리" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="자주-쓰는-검색">자주 쓰는 검색<a href="#자주-쓰는-검색" class="hash-link" aria-label="Direct link to 자주 쓰는 검색" title="Direct link to 자주 쓰는 검색" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 Agent 로그</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agent.name: &quot;wazuh-agent1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 룰 ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.id: 100001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 키워드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">full_log: *webshell*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 레벨 기준</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.level: &gt;= 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 파일 변경 탐지</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">syscheck.event: &quot;modified&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Agentless 변경 탐지</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule.description: *Change detected*</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시간-필터">시간 필터<a href="#시간-필터" class="hash-link" aria-label="Direct link to 시간 필터" title="Direct link to 시간 필터" translate="no">​</a></h3>
<p>Kibana에서 우측 상단 시간 범위 설정:</p>
<ul>
<li>Last 15 minutes</li>
<li>Last 1 hour</li>
<li>Today</li>
<li>Custom range</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="참고-자료">참고 자료<a href="#참고-자료" class="hash-link" aria-label="Direct link to 참고 자료" title="Direct link to 참고 자료" translate="no">​</a></h2>
<ul>
<li><strong>공식 문서</strong>: <a href="https://documentation.wazuh.com/" target="_blank" rel="noopener noreferrer">https://documentation.wazuh.com/</a></li>
<li><strong>GitHub</strong>: <a href="https://github.com/wazuh/wazuh" target="_blank" rel="noopener noreferrer">https://github.com/wazuh/wazuh</a></li>
<li><strong>Ruleset</strong>: <a href="https://github.com/wazuh/wazuh-ruleset" target="_blank" rel="noopener noreferrer">https://github.com/wazuh/wazuh-ruleset</a></li>
<li><strong>Slack Community</strong>: <a href="https://wazuh.com/community/join-us-on-slack/" target="_blank" rel="noopener noreferrer">https://wazuh.com/community/join-us-on-slack/</a></li>
<li><strong>Training</strong>: <a href="https://wazuh.com/training/" target="_blank" rel="noopener noreferrer">https://wazuh.com/training/</a></li>
<li><strong>Blog</strong>: <a href="https://wazuh.com/blog/" target="_blank" rel="noopener noreferrer">https://wazuh.com/blog/</a></li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/my-docusaurus-page/security_tools/splunk/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Splunk</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/my-docusaurus-page/category/sk-rookies/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SK Rookies</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#개요" class="table-of-contents__link toc-highlight">개요</a><ul><li><a href="#wazuh란" class="table-of-contents__link toc-highlight">Wazuh란?</a></li><li><a href="#핵심-기능" class="table-of-contents__link toc-highlight">핵심 기능</a></li><li><a href="#아키텍처" class="table-of-contents__link toc-highlight">아키텍처</a></li><li><a href="#구성-요소" class="table-of-contents__link toc-highlight">구성 요소</a></li><li><a href="#agent-vs-agentless" class="table-of-contents__link toc-highlight">Agent vs Agentless</a></li></ul></li><li><a href="#설치" class="table-of-contents__link toc-highlight">설치</a><ul><li><a href="#시스템-요구사항" class="table-of-contents__link toc-highlight">시스템 요구사항</a></li><li><a href="#사전-준비" class="table-of-contents__link toc-highlight">사전 준비</a></li><li><a href="#all-in-one-설치-권장" class="table-of-contents__link toc-highlight">All-in-One 설치 (권장)</a></li><li><a href="#개별-구성요소-설치" class="table-of-contents__link toc-highlight">개별 구성요소 설치</a></li><li><a href="#docker-설치" class="table-of-contents__link toc-highlight">Docker 설치</a></li><li><a href="#패스워드-확인변경" class="table-of-contents__link toc-highlight">패스워드 확인/변경</a></li><li><a href="#서비스-확인-및-재시작" class="table-of-contents__link toc-highlight">서비스 확인 및 재시작</a></li></ul></li><li><a href="#에이전트-설치" class="table-of-contents__link toc-highlight">에이전트 설치</a><ul><li><a href="#linux-에이전트" class="table-of-contents__link toc-highlight">Linux 에이전트</a></li><li><a href="#에이전트-등록" class="table-of-contents__link toc-highlight">에이전트 등록</a></li><li><a href="#windows-에이전트" class="table-of-contents__link toc-highlight">Windows 에이전트</a></li><li><a href="#macos-에이전트" class="table-of-contents__link toc-highlight">macOS 에이전트</a></li></ul></li><li><a href="#agentless-설정" class="table-of-contents__link toc-highlight">Agentless 설정</a><ul><li><a href="#ssh-설정-모니터링-대상-서버" class="table-of-contents__link toc-highlight">SSH 설정 (모니터링 대상 서버)</a></li><li><a href="#ssh-연결-테스트-wazuh-서버에서" class="table-of-contents__link toc-highlight">SSH 연결 테스트 (Wazuh 서버에서)</a></li><li><a href="#agentless-호스트-등록" class="table-of-contents__link toc-highlight">Agentless 호스트 등록</a></li><li><a href="#expect-패키지-설치-필수" class="table-of-contents__link toc-highlight">expect 패키지 설치 (필수!)</a></li><li><a href="#ossecconf-설정" class="table-of-contents__link toc-highlight">ossec.conf 설정</a></li><li><a href="#wazuh-재시작-및-확인" class="table-of-contents__link toc-highlight">Wazuh 재시작 및 확인</a></li><li><a href="#agentless-테스트" class="table-of-contents__link toc-highlight">Agentless 테스트</a></li></ul></li><li><a href="#대시보드" class="table-of-contents__link toc-highlight">대시보드</a><ul><li><a href="#웹-인터페이스-접속" class="table-of-contents__link toc-highlight">웹 인터페이스 접속</a></li><li><a href="#주요-메뉴" class="table-of-contents__link toc-highlight">주요 메뉴</a></li><li><a href="#security-events" class="table-of-contents__link toc-highlight">Security Events</a></li></ul></li><li><a href="#규칙-시스템" class="table-of-contents__link toc-highlight">규칙 시스템</a><ul><li><a href="#규칙-구조" class="table-of-contents__link toc-highlight">규칙 구조</a></li><li><a href="#규칙-레벨" class="table-of-contents__link toc-highlight">규칙 레벨</a></li><li><a href="#커스텀-규칙-생성" class="table-of-contents__link toc-highlight">커스텀 규칙 생성</a></li><li><a href="#규칙-테스트-wazuh-logtest" class="table-of-contents__link toc-highlight">규칙 테스트 (wazuh-logtest)</a></li></ul></li><li><a href="#주요-기능-상세" class="table-of-contents__link toc-highlight">주요 기능 상세</a><ul><li><a href="#1-파일-무결성-모니터링-fim" class="table-of-contents__link toc-highlight">1. 파일 무결성 모니터링 (FIM)</a></li><li><a href="#2-취약점-탐지" class="table-of-contents__link toc-highlight">2. 취약점 탐지</a></li><li><a href="#3-cis-벤치마크-sca" class="table-of-contents__link toc-highlight">3. CIS 벤치마크 (SCA)</a></li><li><a href="#4-액티브-리스폰스" class="table-of-contents__link toc-highlight">4. 액티브 리스폰스</a></li><li><a href="#5-로그-수집" class="table-of-contents__link toc-highlight">5. 로그 수집</a></li></ul></li><li><a href="#검색-및-쿼리" class="table-of-contents__link toc-highlight">검색 및 쿼리</a><ul><li><a href="#wazuh-query-language" class="table-of-contents__link toc-highlight">Wazuh Query Language</a></li><li><a href="#자주-사용하는-쿼리" class="table-of-contents__link toc-highlight">자주 사용하는 쿼리</a></li></ul></li><li><a href="#api-사용" class="table-of-contents__link toc-highlight">API 사용</a><ul><li><a href="#api-인증" class="table-of-contents__link toc-highlight">API 인증</a></li><li><a href="#주요-api-엔드포인트" class="table-of-contents__link toc-highlight">주요 API 엔드포인트</a></li></ul></li><li><a href="#통합-integration" class="table-of-contents__link toc-highlight">통합 (Integration)</a><ul><li><a href="#slack-알림" class="table-of-contents__link toc-highlight">Slack 알림</a></li><li><a href="#thehive-연동" class="table-of-contents__link toc-highlight">TheHive 연동</a></li><li><a href="#shuffle-soar" class="table-of-contents__link toc-highlight">Shuffle SOAR</a></li></ul></li><li><a href="#관리-명령어" class="table-of-contents__link toc-highlight">관리 명령어</a><ul><li><a href="#서비스-관리" class="table-of-contents__link toc-highlight">서비스 관리</a></li><li><a href="#에이전트-관리" class="table-of-contents__link toc-highlight">에이전트 관리</a></li><li><a href="#설정-검증" class="table-of-contents__link toc-highlight">설정 검증</a></li><li><a href="#클러스터-관리" class="table-of-contents__link toc-highlight">클러스터 관리</a></li></ul></li><li><a href="#설정-파일" class="table-of-contents__link toc-highlight">설정 파일</a><ul><li><a href="#주요-설정-파일-위치" class="table-of-contents__link toc-highlight">주요 설정 파일 위치</a></li><li><a href="#ossecconf-주요-섹션" class="table-of-contents__link toc-highlight">ossec.conf 주요 섹션</a></li></ul></li><li><a href="#빠른-명령어-참조" class="table-of-contents__link toc-highlight">빠른 명령어 참조</a><ul><li><a href="#일상-운영" class="table-of-contents__link toc-highlight">일상 운영</a></li><li><a href="#문제-해결" class="table-of-contents__link toc-highlight">문제 해결</a></li><li><a href="#에이전트-cli" class="table-of-contents__link toc-highlight">에이전트 CLI</a></li></ul></li><li><a href="#windows-sysmon-연동" class="table-of-contents__link toc-highlight">Windows Sysmon 연동</a><ul><li><a href="#sysmon이란" class="table-of-contents__link toc-highlight">Sysmon이란?</a></li><li><a href="#sysmon-다운로드-및-설치" class="table-of-contents__link toc-highlight">Sysmon 다운로드 및 설치</a></li><li><a href="#sysmon-config-설정" class="table-of-contents__link toc-highlight">Sysmon Config 설정</a></li><li><a href="#이벤트-뷰어-확인" class="table-of-contents__link toc-highlight">이벤트 뷰어 확인</a></li><li><a href="#wazuh-agent-설정-windows" class="table-of-contents__link toc-highlight">Wazuh Agent 설정 (Windows)</a></li><li><a href="#wazuh-agent-재시작" class="table-of-contents__link toc-highlight">Wazuh Agent 재시작</a></li></ul></li><li><a href="#mitre-attck-매핑" class="table-of-contents__link toc-highlight">MITRE ATT&amp;CK 매핑</a><ul><li><a href="#탐지-가능한-주요-기법" class="table-of-contents__link toc-highlight">탐지 가능한 주요 기법</a></li></ul></li><li><a href="#트러블슈팅-체크리스트" class="table-of-contents__link toc-highlight">트러블슈팅 체크리스트</a><ul><li><a href="#에이전트-연결-안됨" class="table-of-contents__link toc-highlight">에이전트 연결 안됨</a></li><li><a href="#agentless-동작-안-함" class="table-of-contents__link toc-highlight">Agentless 동작 안 함</a></li><li><a href="#알림이-생성되지-않음" class="table-of-contents__link toc-highlight">알림이 생성되지 않음</a></li><li><a href="#sysmon-로그-안-올라올-때" class="table-of-contents__link toc-highlight">Sysmon 로그 안 올라올 때</a></li><li><a href="#대시보드-접속-불가" class="table-of-contents__link toc-highlight">대시보드 접속 불가</a></li><li><a href="#디스크-공간-부족" class="table-of-contents__link toc-highlight">디스크 공간 부족</a></li><li><a href="#성능-문제" class="table-of-contents__link toc-highlight">성능 문제</a></li></ul></li><li><a href="#kibana-검색-쿼리" class="table-of-contents__link toc-highlight">Kibana 검색 쿼리</a><ul><li><a href="#자주-쓰는-검색" class="table-of-contents__link toc-highlight">자주 쓰는 검색</a></li><li><a href="#시간-필터" class="table-of-contents__link toc-highlight">시간 필터</a></li></ul></li><li><a href="#참고-자료" class="table-of-contents__link toc-highlight">참고 자료</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-docusaurus-page/">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>